# (PART) Теория вероятностей и математическая статистика {-}

# Математический ликбез {#maths}

<center>
<img src="https://sun1-89.userapi.com/ZHyQ9wd3-p3pzxICOjVMwnxKHaGLb9oHWwmE4w/iHEd5NYvhoA.jpg">
</center>

## Элементы алгебры логики {#alg_logic}

## Элементы теории множеств {#set_theory}

## Элементы математического анализа {#calculus}

## Элементы линейной алгебры {#matrix}

\newcommand{\A}{\boldsymbol{A}}
\newcommand{\B}{\boldsymbol{B}}
\newcommand{\C}{\boldsymbol{C}}
\newcommand{\E}{\boldsymbol{E}}
\newcommand{\I}{\boldsymbol{I}}
\newcommand{\O}{\boldsymbol{O}}
\newcommand{\x}{\boldsymbol{x}}
\newcommand{\a}{\boldsymbol{a}}
\newcommand{\b}{\boldsymbol{b}}
\newcommand{\c}{\boldsymbol{c}}
\newcommand{\T}{\mathrm{T}}


### Что такое матрица?

> «Увы, невозможно объяснить, что такое матрица. Ты должен увидеть это сам.» <br>
*Морфеус (Матрица, 1999)*

Матрица выглядит как таблица чисел, записанных в определенном порядке. Например, вот так:

$$
\A = 
\begin{pmatrix}
1 & 6 & 11 \\
2 & 7 & 13 \\
3 & 8 & 15 \\
4 & 9 & 18 \\
5 & 0 & 19
\end{pmatrix}
$$

В данном случае это прямоугольная матрица $\A$. Матрицы обозначаются заглавными буквами (иногда еще и полужирным написанием, чтобы отличать от обычных переменных). Количество строк и столбцов определяет размер матрицы. То есть данная матрица имеет размер 5×3 --- $\A_{5×3}$. При указании размера сначала указывается количество строк, затем --- число столбцов.

Ну, и, собственно, всё. Это и есть матрица.



### Откуда берутся матрицы?

Матрицы возникают при решении систем линейных уравнений. Рассмотрим систему.

$$
\begin{cases}a_{11}x_1 + a_{12}x_2 + \ldots + a_{1m}x_m = b_1
\\a_{21}x_1 + a_{22}x_2 + \ldots + a_{2m}x_m = b_2
\\ \dots \dots \dots \dots \dots \dots \dots \dots \dots \dots
\\a_{n1}x_1 + a_{n2}x_2 + \ldots + a_{nm}x_m = b_n
\end{cases}
$$

Система состоит из $n$ линейных уравнений относительно $m$ неизвестных. Её можно переписать в *матричном виде*:

$$
\A \x = \b,
$$

где 

$$
\A =
\begin{pmatrix}
a_{11} & a_{12} & \dots & a_{1m} \\
a_{21} & a_{22} & \dots & a_{2m} \\
\vdots & \vdots & \ddots & \vdots \\
a_{n1} & a_{n2} & \dots & a_{nm}
\end{pmatrix} ; \quad 
\x = \begin{pmatrix}
x_1 \\
x_2 \\
\vdots \\
x_m
\end{pmatrix} ; \quad
\b = \begin{pmatrix}
b_1 \\
b_2 \\
\vdots \\
b_n
\end{pmatrix}
$$

Здесь мы видим матрицу коэффициентов системы $\A$. Размер этой матрицы $n × m$. Также мы видим две особых матрицы $\x$ и $\b$. Количество столбов у них равно единице. Такие матрицы носят название **векторов**.

Но ведь мы можем написать вектор всего с одной строкой. Например, некоторый вектор $\c$:

$$
\c = \begin{pmatrix}
c_1 & c_2 & \dots & c_k
\end{pmatrix}
$$

Для большей точности принята следующая терминология: векторы вида $\x$ называют «вектор-столбец», а векторы вида $\c$ называют «вектор-строка». Векторы часто также обозначаются полужирным начертанием, чтобы отличать их от отдельных значений.

Так как отдельные столбцы матрица мы можем представить в виде векторов, то матрицу $\A$ можно написать еще одним способом:
$$
\A = \begin{pmatrix} \A_1 & \A_2 & \dots & \A_m \end{pmatrix},
$$

где

$$
\A_i = \begin{pmatrix} a_{1i} \\ a_{2i} \\ \vdots \\ a_{ni} \end{pmatrix}, \quad 0<i \leq m
$$

Ок, но остается вопрос: почему матричная запись равносильна причной нам записи системы?

***
**Деталь 1**

Есть две замечательные матрицы: единичная матрица $\E$ (иногда $\I$) и нулевая матрица $\O$:
$$
\E = \begin{pmatrix}
1 & 0 & \dots & 0 \\
0 & 1 & \dots & 0 \\
\vdots & \vdots & \ddots & \vdots \\
0 & 0 & \dots & 1
\end{pmatrix} ; \quad
\O = \begin{pmatrix}
0 & 0 & \dots & 0 \\
0 & 0 & \dots & 0 \\
\vdots & \vdots & \ddots & \vdots \\
0 & 0 & \dots & 0
\end{pmatrix}
$$

**Деталь 2**

Матрица размером $n × n$ называется *квадратной матрицей*.

Квадратная матрица, все элементы которой, кроме стоящих на главной диагонали, равны нулю, называется *диагональной матрицей*.

***


### Действия с матрицами

#### Сложение матриц

Сложение определено только для матриц *одинакового размера*.

$$
\A_{n×m} + \B_{n×m} = 
\begin{pmatrix}
a_{11} + b_{11} & a_{12} + b_{12} & \dots & a_{1m} + b_{1m} \\
a_{21} + b_{21} & a_{22} + b_{22} & \dots & a_{2m} + b_{2m} \\
\vdots & \vdots & \ddots & \vdots \\
a_{n1} + b_{n1} & a_{n2} + b_{n2} & \dots & a_{nm} + b_{nm}
\end{pmatrix}
$$

**Свойства сложения матриц:**

1) $\A + \B = \B + \A$ (коммутативность)
2) $(\A + \B) + \C = \A+ (\B + \C)$ (ассоциативность)
3) $\A + \O = \A$ (существование нулевого элемента)
4) $\A + (-\A) = \O$ (существование противоположного элемента)

Все, описанное выше, справедливо для векторов.


#### Умножение матрицы на число
Умножение на вещественное число определено для любой матрицы $n × m$.

$$
\lambda \A = \begin{pmatrix}
\lambda a_{11} & \lambda a_{12} & \dots & \lambda a_{1m} \\
\lambda a_{21} & \lambda a_{22} & \dots & \lambda a_{2m} \\
\vdots & \vdots & \ddots & \vdots \\
\lambda a_{n1} & \lambda a_{n2} & \dots & \lambda a_{nm}
\end{pmatrix}, \; \forall \lambda \in \mathbb{R}
$$

**Свойства умножения матрицы на число:**

1) $1 \cdot \A = \A$
2) $-1 \cdot \A = -\A$
3) $\lambda(\mu \A) = (\lambda \mu) \A$ (ассоциативность)
4) $(\lambda + \mu) \A = \lambda \A + \mu \A$ (дистрибутивность)
5) $\lambda (\A + \B) = \lambda \A + \lambda \B$ (дистрибутивность)

Все, описанное выше, справедливо для векторов.


### Скалярное произведение векторов
Скаларное произведение определено для векторов одинаковой размерности как сумма произведений их соответствующих координат.

$$
\a = \begin{pmatrix} a_1 & a_2 & \dots & a_n \end{pmatrix} \\
\b = \begin{pmatrix} b_1 & b_2 & \dots & b_n \end{pmatrix}\\
$$
$$
\a \cdot \b = a_1 b_1 + a_2 b_2 + \dots + a_n b_n
$$


### Векторное произведение векторов

> мы рассматривать не будем :)


### Произведение матриц (матричное умножение)

Ну, вот и начался треш.

Умножение определено для матриц $\A_{n × k}$ и $\B_{k × m}$, то количество столбцов матрицы, стоящей слева от знака умножения, должно быть равно количество строк матрицы, стоящей справа от знака умножения.

Произведением матрицы $\A_{n × k}$ на матрицу $\B_{k × m}$ называется матрица $\C_{n × m}$, элемент которой $c_{ij}$ равен скалярному произведению $i$-го вектора-строки матрицы $\A$ и $j$-го вектора-столбца матрицы $\B$.

<center>
<img src="https://upload.wikimedia.org/wikipedia/commons/thumb/e/eb/Matrix_multiplication_diagram_2.svg/1024px-Matrix_multiplication_diagram_2.svg.png" width=500>
</center>

Пусть 
$$
\A = 
\begin{pmatrix}
\a_1 \\
\a_2 \\
\vdots \\
\a_n
\end{pmatrix} = 
\begin{pmatrix}
a_{11} & a_{12} & \dots & a_{1k} \\
a_{21} & a_{22} & \dots & a_{2k} \\
\vdots & \vdots & \ddots & \vdots \\
a_{n1} & a_{n2} & \dots & a_{nk}
\end{pmatrix}, \\
\B = 
\begin{pmatrix}
\b_1 & \b_2 & \dots \b_m
\end{pmatrix} = 
\begin{pmatrix}
b_{11} & b_{12} & \dots & b_{1m} \\
b_{21} & b_{22} & \dots & b_{2m} \\
\vdots & \vdots & \ddots & \vdots \\
b_{k1} & b_{k2} & \dots & b_{km}
\end{pmatrix}
$$

Тогда,

$$
\A \times \B = 
\begin{pmatrix}
\a_1 \cdot \b_1 & \a_1 \cdot \b_2 & \dots & \a_1 \cdot \b_m \\
\a_2 \cdot \b_1 & \a_2 \cdot \b_2 & \dots & \a_2 \cdot \b_m \\
\vdots & \vdots & \ddots & \vdots \\
\a_n \cdot \b_1 & \a_n \cdot \b_2 & \dots & \a_n \cdot \b_m \\
\end{pmatrix} = \\ = 
\begin{pmatrix}
(a_{11} b_{11} + a_{12} b_{21} + \dots + a_{1k}b_{k1}) & (a_{11} b_{12} + a_{12} b_{22} + \dots + a_{1k}b_{k2}) & \dots & (a_{11} b_{1m} + a_{12} b_{2m} + \dots + a_{1k}b_{km}) \\
(a_{21} b_{11} + a_{22} b_{21} + \dots + a_{2k}b_{k1}) & (a_{21} b_{12} + a_{22} b_{22} + \dots + a_{2k}b_{k2}) & \dots & (a_{21} b_{1m} + a_{22} b_{2m} + \dots + a_{2k}b_{km}) \\
\vdots & \vdots & \ddots & \vdots \\
(a_{n1} b_{11} + a_{n2} b_{21} + \dots + a_{nk}b_{k1}) & (a_{n1} b_{12} + a_{n2} b_{22} + \dots + a_{nk}b_{k2}) & \dots & (a_{n1} b_{1m} + a_{n2} b_{2m} + \dots + a_{nk}b_{km})
\end{pmatrix} = \\ = 
\begin{pmatrix}
c_{11} & c_{12} & \dots & c_{1m} \\
c_{21} & c_{22} & \dots & c_{2m} \\
\vdots & \vdots & \ddots & \vdots \\
c_{n1} & c_{n2} & \dots & c_{nm}
\end{pmatrix} = \C
$$

$$
c_{ij} = \sum_{t=1}^k a_{it} b_{tj}
$$

Вот так вот.


**Cвойства произведения матриц:**

1) $\A (\B \C) = (\A \B) \C$ (ассоциативность)
2) $\lambda (\A \B) = (\lambda \A) \B = (\lambda \B) \A$ (ассоциативность)
3) $\A (\B + \C) = \A \B + \A \C$ (дистрибутивность)
4) $(\A + \B) \C = \A \C + \B \C$ (дистрибутивность)
5) $\A \B \neq \B \A$ (отсутствие коммутативности)
6) $\E \A = \A; \, \A \E = \A$ (умножение на единичный элемент)
7) $\O \A = \O; \, \A \O = \O$ (умножение на нулевой элемент)
8) $\A \A^{-1} = \A^{-1} \A = \E$ (умножение на обратную матрицу --- *только для некоторых квадратных матриц*)

Матричное умножение определено для векторов-столбцов (матриц-столбцов) и векторов-строк (матриц-строк) и выполняется по тем же правилам.



### Транспонирование матрицы
В матрице строки и столбцы можно поменять местами --- получится транспонированная матрица.

$$
\A = 
\begin{pmatrix}
\a_1 \\
\a_2 \\
\vdots \\
\a_n
\end{pmatrix} = 
\begin{pmatrix}
a_{11} & a_{12} & \dots & a_{1k} \\
a_{21} & a_{22} & \dots & a_{2k} \\
\vdots & \vdots & \ddots & \vdots \\
a_{n1} & a_{n2} & \dots & a_{nk}
\end{pmatrix}
$$
$$
\A^\T =
\begin{pmatrix}
\a_1 & \a_2 & \dots & \a_n
\end{pmatrix} = 
\begin{pmatrix}
a_{11} & a_{21} & \dots & a_{n1} \\
a_{12} & a_{22} & \dots & a_{n2} \\
\vdots & \vdots & \ddots & \vdots \\
a_{1k} & a_{2k} & \dots & a_{nk}
\end{pmatrix}
$$
Транспонированная матрица будет иметь размер $k × n$.


### Детерминант и обратная матрица

*Детерминант (определитель)* $\det \A, \; |\A|, \Delta \A$ --- величина, которая может быть вычислена и поставлена в однозначное соответствие квадратной матрице. Он «определяет» свойства матрицы, в том числе, её **обратимость**.

Детерминан матрицы из одного элемента равен этому элементу:

$$
\det \begin{pmatrix} a_{11} \end{pmatrix} = a_{11}
$$
Детерминант матрицы $2×2$ вычисляется следующим образом --- это разность произведений элементов главной[^1] и побочной[^2] диагоналей:

$$
\det \begin{pmatrix} a_{11} & a_{12} \\ a_{21} & a_{22} \end{pmatrix} = a_{11} a_{22} - a_{12} a_{21}
$$

Вычисление дереминанта матрицы произвольного размера $n × n$ требует введения ещё пары определений.

**Дополнительный минор** $M_{ij}$ матрицы $\A$ --- это дереминант матрицы, полученной из матрицы $\A$ путём вычеркивания $i$-ой строки и $j$-го столбца.

**Алгебраическое дополнение** элемента $a_{ij}$ матрицы $\A$ --- число, которое получается при умножении минора $M_{ij}$ на $(-1)^{i+j}$:

$$
A_{ij} = (-1)^{i+j} M_{ij}
$$

<center>
<img src="https://upload.wikimedia.org/wikipedia/commons/7/78/Matrix_alg_add%282%29.png">
</center>

Детерминант матрицы произвольного размера $n×n$ вычисляется так[^3]:

$$
\det \A_{n×n} = \sum_{j=1}^n (-1)^{1 + j} a_{1j} M_{1j} = \sum_{j=1}^n a_{1j}A_{1j},
$$
где $M_{1j}$ --- дополнительный минор к элементу $a_{1j}$. 

Но жизнь упрощается, когда есть R:

```{r}
A <- matrix(sample(20:30, 9), nrow = 3)
det(A) # так вычисляется детерминант матрицы
```


### След матрицы

**След матрицы** --- сумма элементов (квадратной) матрицы, стоящих на главной[^1] диагонали.

$$
\mathrm{tr}(\A) = \sum_i a_{ii}
$$

О нём мы чуть-чуть вспомним, когда будем обсуждать ковариационные матрицы.

<img class="taskimg" src="img/code.png">
<div class="task">
В R нет специальной функции, которая вычисляет след матрицы. Давайте её напишем!

Функция должна принимать на вход матрицу, проверять, является ли матрица квадратной, и, если да, то возвращать значение следа матрицы, если нет, то печатать в консоль «матрица не является квадратной».

*Подсказка:* `?diag`

```{r, include=FALSE}
tr <- function(A) {
  ifelse(dim(A)[1] == dim(A)[2],
         sum(diag(A)),
         "матрица не является квадратной")
}
```
```{r}
B <- matrix(sample(1:100, 25), nrow = 5)
C <- matrix(sample(1:100, 12), nrow = 4)
tr(B)
tr(C)
```
</div>



<img class="taskimg" src="img/maths.png">
<div class="task">
Дано:
$$
\A = 
\begin{pmatrix}
1 & 3 \\
2 & 4
\end{pmatrix} ; \quad
\B = 
\begin{pmatrix}
5 & 6 & 7 \\
8 & 9 & 0
\end{pmatrix} ; \\
\a = 
\begin{pmatrix}
11 & 22 & 33
\end{pmatrix}; \quad
\b = 
\begin{pmatrix}
101 \\
102 \\
103
\end{pmatrix};
$$


Вычислить:

1) $\A \times \B$;
2) $\B \times \A$;
3) $\a \times \b$;
4) $\b \times \a$;
5) $\a \times \a^\T$

*Чтобы проверить ответ, введите в соответствующее поле значения элементов матрицы построчно. Элементы одной строки разделяйте пробелами, строки разделяйте [только] запятыми.*


<ol style="list-style-type: decimal">

<li style="margin-top: 10px;margin-bottom:10px">
<input type="text" id="first">
<input type="button" value="Проверить" style="margin-left:30px" onclick="check1()">
<div class="feedback" id="ffirst" hidden></div>
</li>

<li style="margin-top:10px;margin-bottom:10px">
<input type="text" id="second">
<input type="button" value="Проверить" style="margin-left:30px" onclick="check2()">
<div class="feedback" id="fsecond" hidden></div>
</li>

<li style="margin-top:10px;margin-bottom:10px">
<input type="text" id="third">
<input type="button" value="Проверить" style="margin-left:30px" onclick="check3()">
<div class="feedback" id="fthird" hidden></div>
</li>

<li style="margin-top:10px;margin-bottom:10px">
<input type="text" id="fourth">
<input type="button" value="Проверить" style="margin-left:30px" onclick="check4()">
<div class="feedback" id="ffourth" hidden></div>
</li>

<li style="margin-top:10px;margin-bottom:10px">
<input type="text" id="fifth">
<input type="button" value="Проверить" style="margin-left:30px" onclick="check5()">
<div class="feedback" id="ffifth" hidden></div>
</li>

</ol>


<script>

  var v1 = document.getElementById('first');
  var v2 = document.getElementById('second');
  var v3 = document.getElementById('third');
  var v4 = document.getElementById('fourth');
  var v5 = document.getElementById('fifth');
  
  var f1 = document.getElementById('ffirst');
  var f2 = document.getElementById('fsecond');
  var f3 = document.getElementById('fthird');
  var f4 = document.getElementById('ffourth');
  var f5 = document.getElementById('ffifth');

  function check1()
  {
    if (v1.value == "29 33 7,42 48 14")
    {
      f1.hidden = false;
      f1.innerHTML = "Всё супер!";
      f1.style = "color:  #00aa4a";
    } else {
      f1.hidden = false;
      f1.innerHTML = "Надо проверить вычисления…";
      f1.style = "color:  #b73239";
    }
  }

  function check2()
  {
    if (v2.value.toLowerCase() == "матрицы нельзя перемножить")
    {
      f2.hidden = false;
      f2.innerHTML = "Всё супер!";
      f2.style = "color:  #00aa4a";
    } else {
      f2.hidden = false;
      f2.innerHTML = "Надо проверить вычисления…";
      f2.style = "color:  #b73239";
    }
  }

  function check3()
  {
    if (v3.value == "6754")
    {
      f3.hidden = false;
      f3.innerHTML = "Всё супер!";
      f3.style = "color:  #00aa4a";
    } else {
      f3.hidden = false;
      f3.innerHTML = "Надо проверить вычисления…";
      f3.style = "color:  #b73239";
    }
  }

  function check4()
  {
    if (v4.value == "1111 2222 3333,1122 2244 3366,1133 2266 3399")
    {
      f4.hidden = false;
      f4.innerHTML = "Всё супер!";
      f4.style = "color:  #00aa4a";
    } else {
      f4.hidden = false;
      f4.innerHTML = "Надо проверить вычисления…";
      f4.style = "color:  #b73239";
    }
  }

  function check5()
  {
    if (v5.value == "1694")
    {
      f5.hidden = false;
      f5.innerHTML = "Всё супер!";
      f5.style = "color:  #00aa4a";
    } else {
      f5.hidden = false;
      f5.innerHTML = "Надо проверить вычисления…";
      f5.style = "color:  #b73239";
    }
  }
</script>

</div>


[^1]: Та, которая идёт слева сверху вправо вниз.
[^2]: Та, которая идёт справа сверху влево вниз.
[^3]: Эта формула называется разложением по строке. Есть и [другие](https://ru.wikipedia.org/wiki/Определитель)

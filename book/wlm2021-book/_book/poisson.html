<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>22 Пуассоновская регрессия | HSE UX LAB | Анализ данных + R: мир линейных моделей | Book</title>
  <meta name="description" content="Книга написана для слушателей курса по анализу данных от HSE UX LAB" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="22 Пуассоновская регрессия | HSE UX LAB | Анализ данных + R: мир линейных моделей | Book" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Книга написана для слушателей курса по анализу данных от HSE UX LAB" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="22 Пуассоновская регрессия | HSE UX LAB | Анализ данных + R: мир линейных моделей | Book" />
  
  <meta name="twitter:description" content="Книга написана для слушателей курса по анализу данных от HSE UX LAB" />
  

<meta name="author" content="А. Ангельгардт" />


<meta name="date" content="2021-01-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="logistic.html"/>
<link rel="next" href="regularization.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="">HSE UX LAB | WLM 2021</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#благодарности"><i class="fa fa-check"></i>Благодарности</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#условные-обозначения"><i class="fa fa-check"></i>Условные обозначения</a></li>
</ul></li>
<li class="part"><span><b>I R programming</b></span></li>
<li class="chapter" data-level="1" data-path="Rintro.html"><a href="Rintro.html"><i class="fa fa-check"></i><b>1</b> Знакомство с R и RStudio</a><ul>
<li class="chapter" data-level="1.1" data-path="Rintro.html"><a href="Rintro.html#что-это-и-откуда"><i class="fa fa-check"></i><b>1.1</b> Что это и откуда?</a></li>
<li class="chapter" data-level="1.2" data-path="Rintro.html"><a href="Rintro.html#whyr"><i class="fa fa-check"></i><b>1.2</b> Почему R?</a><ul>
<li class="chapter" data-level="1.2.1" data-path="Rintro.html"><a href="Rintro.html#а-он-лучше-питона"><i class="fa fa-check"></i><b>1.2.1</b> А он лучше Питона?</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="Rintro.html"><a href="Rintro.html#установка-r-и-rstudio"><i class="fa fa-check"></i><b>1.3</b> Установка R и RStudio</a><ul>
<li class="chapter" data-level="1.3.1" data-path="Rintro.html"><a href="Rintro.html#а-зачем-обе-штуки-ставить"><i class="fa fa-check"></i><b>1.3.1</b> А зачем обе штуки ставить?</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="Rintro.html"><a href="Rintro.html#где-спросить-вопрос-или-искать-ответ"><i class="fa fa-check"></i><b>1.4</b> Где спросить вопрос или искать ответ?</a></li>
<li class="chapter" data-level="1.5" data-path="Rintro.html"><a href="Rintro.html#интерфейс-r"><i class="fa fa-check"></i><b>1.5</b> Интерфейс R</a></li>
<li class="chapter" data-level="1.6" data-path="Rintro.html"><a href="Rintro.html#интерфейс-rstudio"><i class="fa fa-check"></i><b>1.6</b> Интерфейс RStudio</a><ul>
<li class="chapter" data-level="1.6.1" data-path="Rintro.html"><a href="Rintro.html#console"><i class="fa fa-check"></i><b>1.6.1</b> Console</a></li>
<li class="chapter" data-level="1.6.2" data-path="Rintro.html"><a href="Rintro.html#code-editor"><i class="fa fa-check"></i><b>1.6.2</b> Code Editor</a></li>
<li class="chapter" data-level="1.6.3" data-path="Rintro.html"><a href="Rintro.html#environment-workspace-и-history"><i class="fa fa-check"></i><b>1.6.3</b> Environment (Workspace) и History</a></li>
<li class="chapter" data-level="1.6.4" data-path="Rintro.html"><a href="Rintro.html#plots-files-packages-help-viewer"><i class="fa fa-check"></i><b>1.6.4</b> Plots, Files, Packages, Help, Viewer</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="Rintro.html"><a href="Rintro.html#r-как-калькулятор"><i class="fa fa-check"></i><b>1.7</b> R как калькулятор</a><ul>
<li class="chapter" data-level="1.7.1" data-path="Rintro.html"><a href="Rintro.html#арифметические-операции"><i class="fa fa-check"></i><b>1.7.1</b> Арифметические операции</a></li>
<li class="chapter" data-level="1.7.2" data-path="Rintro.html"><a href="Rintro.html#funcs"><i class="fa fa-check"></i><b>1.7.2</b> Функции</a></li>
<li class="chapter" data-level="1.7.3" data-path="Rintro.html"><a href="Rintro.html#сравнение-и-логические-операции"><i class="fa fa-check"></i><b>1.7.3</b> Сравнение и логические операции</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="Rintro.html"><a href="Rintro.html#assignment-и-переменные"><i class="fa fa-check"></i><b>1.8</b> Assignment и переменные</a></li>
<li class="chapter" data-level="1.9" data-path="Rintro.html"><a href="Rintro.html#wd"><i class="fa fa-check"></i><b>1.9</b> Рабочая директория. Projects</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="datatypes.html"><a href="datatypes.html"><i class="fa fa-check"></i><b>2</b> Типы данных</a><ul>
<li class="chapter" data-level="2.1" data-path="datatypes.html"><a href="datatypes.html#numeric"><i class="fa fa-check"></i><b>2.1</b> <code>numeric</code></a></li>
<li class="chapter" data-level="2.2" data-path="datatypes.html"><a href="datatypes.html#logical"><i class="fa fa-check"></i><b>2.2</b> <code>logical</code></a></li>
<li class="chapter" data-level="2.3" data-path="datatypes.html"><a href="datatypes.html#character"><i class="fa fa-check"></i><b>2.3</b> <code>character</code></a></li>
<li class="chapter" data-level="2.4" data-path="datatypes.html"><a href="datatypes.html#factors"><i class="fa fa-check"></i><b>2.4</b> <code>factor</code></a></li>
<li class="chapter" data-level="2.5" data-path="datatypes.html"><a href="datatypes.html#coercion-part-one"><i class="fa fa-check"></i><b>2.5</b> Coercion [part one]</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="datastructures.html"><a href="datastructures.html"><i class="fa fa-check"></i><b>3</b> Структуры данных</a><ul>
<li class="chapter" data-level="3.1" data-path="datastructures.html"><a href="datastructures.html#векторы"><i class="fa fa-check"></i><b>3.1</b> Векторы</a><ul>
<li class="chapter" data-level="3.1.1" data-path="datastructures.html"><a href="datastructures.html#coercion-part-two"><i class="fa fa-check"></i><b>3.1.1</b> Coercion [part two]</a></li>
<li class="chapter" data-level="3.1.2" data-path="datastructures.html"><a href="datastructures.html#генерация-числовых-последовательностей"><i class="fa fa-check"></i><b>3.1.2</b> Генерация числовых последовательностей</a></li>
<li class="chapter" data-level="3.1.3" data-path="datastructures.html"><a href="datastructures.html#операции-с-векторами"><i class="fa fa-check"></i><b>3.1.3</b> Операции с векторами</a></li>
<li class="chapter" data-level="3.1.4" data-path="datastructures.html"><a href="datastructures.html#recycling"><i class="fa fa-check"></i><b>3.1.4</b> Recycling</a></li>
<li class="chapter" data-level="3.1.5" data-path="datastructures.html"><a href="datastructures.html#индексация-векторов"><i class="fa fa-check"></i><b>3.1.5</b> Индексация векторов</a></li>
<li class="chapter" data-level="3.1.6" data-path="datastructures.html"><a href="datastructures.html#na-nan-null"><i class="fa fa-check"></i><b>3.1.6</b> NA, NaN, NULL</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="datastructures.html"><a href="datastructures.html#матрицы"><i class="fa fa-check"></i><b>3.2</b> Матрицы</a><ul>
<li class="chapter" data-level="3.2.1" data-path="datastructures.html"><a href="datastructures.html#индексация-матриц"><i class="fa fa-check"></i><b>3.2.1</b> Индексация матриц</a></li>
<li class="chapter" data-level="3.2.2" data-path="datastructures.html"><a href="datastructures.html#операции-в-матрицами"><i class="fa fa-check"></i><b>3.2.2</b> Операции в матрицами</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="datastructures.html"><a href="datastructures.html#списки"><i class="fa fa-check"></i><b>3.3</b> Списки</a><ul>
<li class="chapter" data-level="3.3.1" data-path="datastructures.html"><a href="datastructures.html#индексация-списков"><i class="fa fa-check"></i><b>3.3.1</b> Индексация списков</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="datastructures.html"><a href="datastructures.html#датафреймы"><i class="fa fa-check"></i><b>3.4</b> Датафреймы</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>4</b> Функции</a><ul>
<li class="chapter" data-level="4.1" data-path="functions.html"><a href="functions.html#открытый-исходный-код"><i class="fa fa-check"></i><b>4.1</b> Открытый исходный код</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="strings.html"><a href="strings.html"><i class="fa fa-check"></i><b>5</b> Строки</a><ul>
<li class="chapter" data-level="5.1" data-path="strings.html"><a href="strings.html#установка-дополнительных-пакетов"><i class="fa fa-check"></i><b>5.1</b> Установка дополнительных пакетов</a></li>
<li class="chapter" data-level="5.2" data-path="strings.html"><a href="strings.html#создание-строк"><i class="fa fa-check"></i><b>5.2</b> Создание строк</a></li>
<li class="chapter" data-level="5.3" data-path="strings.html"><a href="strings.html#конкатенация-строк"><i class="fa fa-check"></i><b>5.3</b> Конкатенация строк</a></li>
<li class="chapter" data-level="5.4" data-path="strings.html"><a href="strings.html#разделение-строк"><i class="fa fa-check"></i><b>5.4</b> Разделение строк</a></li>
<li class="chapter" data-level="5.5" data-path="strings.html"><a href="strings.html#сортировка-строк"><i class="fa fa-check"></i><b>5.5</b> Сортировка строк</a></li>
<li class="chapter" data-level="5.6" data-path="strings.html"><a href="strings.html#изменение-регистра"><i class="fa fa-check"></i><b>5.6</b> Изменение регистра</a></li>
<li class="chapter" data-level="5.7" data-path="strings.html"><a href="strings.html#поиск-подстроки"><i class="fa fa-check"></i><b>5.7</b> Поиск подстроки</a></li>
<li class="chapter" data-level="5.8" data-path="strings.html"><a href="strings.html#изменение-строк"><i class="fa fa-check"></i><b>5.8</b> Изменение строк</a><ul>
<li class="chapter" data-level="5.8.1" data-path="strings.html"><a href="strings.html#выделение-подстроки"><i class="fa fa-check"></i><b>5.8.1</b> Выделение подстроки</a></li>
<li class="chapter" data-level="5.8.2" data-path="strings.html"><a href="strings.html#замена-подстроки"><i class="fa fa-check"></i><b>5.8.2</b> Замена подстроки</a></li>
<li class="chapter" data-level="5.8.3" data-path="strings.html"><a href="strings.html#удаление-подстроки"><i class="fa fa-check"></i><b>5.8.3</b> Удаление подстроки</a></li>
<li class="chapter" data-level="5.8.4" data-path="strings.html"><a href="strings.html#транслитерация-строк"><i class="fa fa-check"></i><b>5.8.4</b> Транслитерация строк</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="strings.html"><a href="strings.html#регулярные-выражения"><i class="fa fa-check"></i><b>5.9</b> Регулярные выражения</a><ul>
<li class="chapter" data-level="5.9.1" data-path="strings.html"><a href="strings.html#метасимволы"><i class="fa fa-check"></i><b>5.9.1</b> Метасимволы</a></li>
<li class="chapter" data-level="5.9.2" data-path="strings.html"><a href="strings.html#классы-знаков"><i class="fa fa-check"></i><b>5.9.2</b> Классы знаков</a></li>
<li class="chapter" data-level="5.9.3" data-path="strings.html"><a href="strings.html#quant"><i class="fa fa-check"></i><b>5.9.3</b> Квантификация</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="realdata.html"><a href="realdata.html"><i class="fa fa-check"></i><b>6</b> Работа с реальными данными</a><ul>
<li class="chapter" data-level="6.1" data-path="realdata.html"><a href="realdata.html#рабочая-директория"><i class="fa fa-check"></i><b>6.1</b> Рабочая директория</a></li>
<li class="chapter" data-level="6.2" data-path="realdata.html"><a href="realdata.html#импорт-данных"><i class="fa fa-check"></i><b>6.2</b> Импорт данных</a><ul>
<li class="chapter" data-level="6.2.1" data-path="realdata.html"><a href="realdata.html#форматы-данных"><i class="fa fa-check"></i><b>6.2.1</b> Форматы данных</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="realdata.html"><a href="realdata.html#исследование-данных"><i class="fa fa-check"></i><b>6.3</b> Исследование данных</a></li>
<li class="chapter" data-level="6.4" data-path="realdata.html"><a href="realdata.html#файл-.rdata"><i class="fa fa-check"></i><b>6.4</b> Файл <code>.RData</code></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="tidy.html"><a href="tidy.html"><i class="fa fa-check"></i><b>7</b> Предобработка данных. Концепция tidy data</a><ul>
<li class="chapter" data-level="7.1" data-path="tidy.html"><a href="tidy.html#tidyverse"><i class="fa fa-check"></i><b>7.1</b> <code>tidyverse</code></a></li>
<li class="chapter" data-level="7.2" data-path="tidy.html"><a href="tidy.html#импорт-данных-1"><i class="fa fa-check"></i><b>7.2</b> Импорт данных</a></li>
<li class="chapter" data-level="7.3" data-path="tidy.html"><a href="tidy.html#tibble"><i class="fa fa-check"></i><b>7.3</b> <code>tibble</code></a></li>
<li class="chapter" data-level="7.4" data-path="tidy.html"><a href="tidy.html#грузим-много-данных"><i class="fa fa-check"></i><b>7.4</b> Грузим много данных</a></li>
<li class="chapter" data-level="7.5" data-path="tidy.html"><a href="tidy.html#сабсет-данных"><i class="fa fa-check"></i><b>7.5</b> Сабсет данных</a><ul>
<li class="chapter" data-level="7.5.1" data-path="tidy.html"><a href="tidy.html#pipe"><i class="fa fa-check"></i><b>7.5.1</b> <code>%&gt;%</code></a></li>
<li class="chapter" data-level="7.5.2" data-path="tidy.html"><a href="tidy.html#select"><i class="fa fa-check"></i><b>7.5.2</b> <code>select()</code></a></li>
<li class="chapter" data-level="7.5.3" data-path="tidy.html"><a href="tidy.html#rename"><i class="fa fa-check"></i><b>7.5.3</b> <code>rename()</code></a></li>
<li class="chapter" data-level="7.5.4" data-path="tidy.html"><a href="tidy.html#slice"><i class="fa fa-check"></i><b>7.5.4</b> <code>slice()</code></a></li>
<li class="chapter" data-level="7.5.5" data-path="tidy.html"><a href="tidy.html#filter"><i class="fa fa-check"></i><b>7.5.5</b> <code>filter()</code></a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="tidy.html"><a href="tidy.html#mutate"><i class="fa fa-check"></i><b>7.6</b> <code>mutate()</code></a></li>
<li class="chapter" data-level="7.7" data-path="tidy.html"><a href="tidy.html#догрузим-остальные-данные"><i class="fa fa-check"></i><b>7.7</b> Догрузим остальные данные</a><ul>
<li class="chapter" data-level="7.7.1" data-path="tidy.html"><a href="tidy.html#соединение-датафреймов-i"><i class="fa fa-check"></i><b>7.7.1</b> Соединение датафреймов I</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="tidy.html"><a href="tidy.html#сортировка"><i class="fa fa-check"></i><b>7.8</b> Сортировка</a><ul>
<li class="chapter" data-level="7.8.1" data-path="tidy.html"><a href="tidy.html#sort"><i class="fa fa-check"></i><b>7.8.1</b> <code>sort()</code></a></li>
<li class="chapter" data-level="7.8.2" data-path="tidy.html"><a href="tidy.html#arrange"><i class="fa fa-check"></i><b>7.8.2</b> <code>arrange()</code></a></li>
<li class="chapter" data-level="7.8.3" data-path="tidy.html"><a href="tidy.html#distinct"><i class="fa fa-check"></i><b>7.8.3</b> <code>distinct()</code></a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="tidy.html"><a href="tidy.html#соединение-датафреймов-ii"><i class="fa fa-check"></i><b>7.9</b> Соединение датафреймов II</a><ul>
<li class="chapter" data-level="7.9.1" data-path="tidy.html"><a href="tidy.html#join"><i class="fa fa-check"></i><b>7.9.1</b> <code>..._join()</code></a></li>
</ul></li>
<li class="chapter" data-level="7.10" data-path="tidy.html"><a href="tidy.html#группировка-и-аггрегация-данных"><i class="fa fa-check"></i><b>7.10</b> Группировка и аггрегация данных</a><ul>
<li class="chapter" data-level="7.10.1" data-path="tidy.html"><a href="tidy.html#group_by-ungroup"><i class="fa fa-check"></i><b>7.10.1</b> <code>group_by()</code> &amp; <code>ungroup()</code></a></li>
<li class="chapter" data-level="7.10.2" data-path="tidy.html"><a href="tidy.html#summarize"><i class="fa fa-check"></i><b>7.10.2</b> <code>summarize()</code></a></li>
</ul></li>
<li class="chapter" data-level="7.11" data-path="tidy.html"><a href="tidy.html#широкий-и-длинный-формат"><i class="fa fa-check"></i><b>7.11</b> Широкий и длинный формат</a><ul>
<li class="chapter" data-level="7.11.1" data-path="tidy.html"><a href="tidy.html#pivot_longer-pivot_wider"><i class="fa fa-check"></i><b>7.11.1</b> <code>pivot_longer()</code> &amp; <code>pivot_wider()</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="visualization.html"><a href="visualization.html"><i class="fa fa-check"></i><b>8</b> Визуализация данных</a><ul>
<li class="chapter" data-level="8.1" data-path="visualization.html"><a href="visualization.html#философия-ggplot2-a-layered-grammar-of-graphics"><i class="fa fa-check"></i><b>8.1</b> Философия ggplot2 (A Layered Grammar of Graphics)</a><ul>
<li class="chapter" data-level="8.1.1" data-path="visualization.html"><a href="visualization.html#собственно-к-философии-построения-графиков"><i class="fa fa-check"></i><b>8.1.1</b> Собственно к философии построения графиков</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="visualization.html"><a href="visualization.html#данные"><i class="fa fa-check"></i><b>8.2</b> Данные</a></li>
<li class="chapter" data-level="8.3" data-path="visualization.html"><a href="visualization.html#строим-базовый-график"><i class="fa fa-check"></i><b>8.3</b> Строим базовый график</a><ul>
<li class="chapter" data-level="8.3.1" data-path="visualization.html"><a href="visualization.html#базовый-слой"><i class="fa fa-check"></i><b>8.3.1</b> Базовый слой</a></li>
<li class="chapter" data-level="8.3.2" data-path="visualization.html"><a href="visualization.html#разметка-осей-и-переменные"><i class="fa fa-check"></i><b>8.3.2</b> Разметка осей и переменные</a></li>
<li class="chapter" data-level="8.3.3" data-path="visualization.html"><a href="visualization.html#геомы"><i class="fa fa-check"></i><b>8.3.3</b> Геомы</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="visualization.html"><a href="visualization.html#группировка-по-переменной"><i class="fa fa-check"></i><b>8.4</b> Группировка по переменной</a></li>
<li class="chapter" data-level="8.5" data-path="visualization.html"><a href="visualization.html#графики-со-встроенной-статистической-обработкой"><i class="fa fa-check"></i><b>8.5</b> Графики со встроенной статистической обработкой</a><ul>
<li class="chapter" data-level="8.5.1" data-path="visualization.html"><a href="visualization.html#статы-stat_"><i class="fa fa-check"></i><b>8.5.1</b> Статы (stat_)</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="visualization.html"><a href="visualization.html#ищем-более-сложные-закономерности"><i class="fa fa-check"></i><b>8.6</b> Ищем более сложные закономерности</a></li>
<li class="chapter" data-level="8.7" data-path="visualization.html"><a href="visualization.html#настраиваем-график"><i class="fa fa-check"></i><b>8.7</b> Настраиваем график</a><ul>
<li class="chapter" data-level="8.7.1" data-path="visualization.html"><a href="visualization.html#темы"><i class="fa fa-check"></i><b>8.7.1</b> Темы</a></li>
<li class="chapter" data-level="8.7.2" data-path="visualization.html"><a href="visualization.html#кастомизация-шкал-scale_"><i class="fa fa-check"></i><b>8.7.2</b> Кастомизация шкал (scale_)</a></li>
<li class="chapter" data-level="8.7.3" data-path="visualization.html"><a href="visualization.html#последние-штрихи"><i class="fa fa-check"></i><b>8.7.3</b> Последние штрихи</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="visualization.html"><a href="visualization.html#больше-переменных"><i class="fa fa-check"></i><b>8.8</b> Больше переменных</a><ul>
<li class="chapter" data-level="8.8.1" data-path="visualization.html"><a href="visualization.html#фасетизация"><i class="fa fa-check"></i><b>8.8.1</b> Фасетизация</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="visualization.html"><a href="visualization.html#сохранение-графиков"><i class="fa fa-check"></i><b>8.9</b> Сохранение графиков</a></li>
<li class="chapter" data-level="8.10" data-path="visualization.html"><a href="visualization.html#другие-геомы"><i class="fa fa-check"></i><b>8.10</b> Другие геомы</a></li>
</ul></li>
<li class="part"><span><b>II Теория вероятностей и математическая статистика</b></span></li>
<li class="chapter" data-level="9" data-path="maths.html"><a href="maths.html"><i class="fa fa-check"></i><b>9</b> Математический ликбез</a><ul>
<li class="chapter" data-level="9.1" data-path="maths.html"><a href="maths.html#alg_logic"><i class="fa fa-check"></i><b>9.1</b> Элементы алгебры логики</a><ul>
<li class="chapter" data-level="9.1.1" data-path="maths.html"><a href="maths.html#высказывания"><i class="fa fa-check"></i><b>9.1.1</b> Высказывания</a></li>
<li class="chapter" data-level="9.1.2" data-path="maths.html"><a href="maths.html#logic_operations"><i class="fa fa-check"></i><b>9.1.2</b> Логические операции</a></li>
<li class="chapter" data-level="9.1.3" data-path="maths.html"><a href="maths.html#сложные-высказвания"><i class="fa fa-check"></i><b>9.1.3</b> Сложные высказвания</a></li>
<li class="chapter" data-level="9.1.4" data-path="maths.html"><a href="maths.html#условные-высказывания"><i class="fa fa-check"></i><b>9.1.4</b> Условные высказывания</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="maths.html"><a href="maths.html#set_theory"><i class="fa fa-check"></i><b>9.2</b> Элементы теории множеств</a><ul>
<li class="chapter" data-level="9.2.1" data-path="maths.html"><a href="maths.html#set"><i class="fa fa-check"></i><b>9.2.1</b> Множество</a></li>
<li class="chapter" data-level="9.2.2" data-path="maths.html"><a href="maths.html#sets_operations"><i class="fa fa-check"></i><b>9.2.2</b> Операции над множествами</a></li>
<li class="chapter" data-level="9.2.3" data-path="maths.html"><a href="maths.html#отображения"><i class="fa fa-check"></i><b>9.2.3</b> Отображения</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="maths.html"><a href="maths.html#combinatorics"><i class="fa fa-check"></i><b>9.3</b> Немного комбинаторики</a><ul>
<li class="chapter" data-level="9.3.1" data-path="maths.html"><a href="maths.html#permutations"><i class="fa fa-check"></i><b>9.3.1</b> Перестановки</a></li>
<li class="chapter" data-level="9.3.2" data-path="maths.html"><a href="maths.html#accomodations"><i class="fa fa-check"></i><b>9.3.2</b> Размещения</a></li>
<li class="chapter" data-level="9.3.3" data-path="maths.html"><a href="maths.html#combinations"><i class="fa fa-check"></i><b>9.3.3</b> Сочетания</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="maths.html"><a href="maths.html#calculus"><i class="fa fa-check"></i><b>9.4</b> Элементы математического анализа</a><ul>
<li class="chapter" data-level="9.4.1" data-path="maths.html"><a href="maths.html#последовательность"><i class="fa fa-check"></i><b>9.4.1</b> Последовательность</a></li>
<li class="chapter" data-level="9.4.2" data-path="maths.html"><a href="maths.html#предел-последовательности"><i class="fa fa-check"></i><b>9.4.2</b> Предел последовательности</a></li>
<li class="chapter" data-level="9.4.3" data-path="maths.html"><a href="maths.html#функции"><i class="fa fa-check"></i><b>9.4.3</b> Функции</a></li>
<li class="chapter" data-level="9.4.4" data-path="maths.html"><a href="maths.html#дифференцируемость-функции.-производная"><i class="fa fa-check"></i><b>9.4.4</b> Дифференцируемость функции. Производная</a></li>
<li class="chapter" data-level="9.4.5" data-path="maths.html"><a href="maths.html#функции-нескольких-переменных"><i class="fa fa-check"></i><b>9.4.5</b> Функции нескольких переменных</a></li>
<li class="chapter" data-level="9.4.6" data-path="maths.html"><a href="maths.html#partial"><i class="fa fa-check"></i><b>9.4.6</b> Частные производные</a></li>
<li class="chapter" data-level="9.4.7" data-path="maths.html"><a href="maths.html#интеграл"><i class="fa fa-check"></i><b>9.4.7</b> Интеграл</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="maths.html"><a href="maths.html#matrix"><i class="fa fa-check"></i><b>9.5</b> Элементы линейной алгебры</a><ul>
<li class="chapter" data-level="9.5.1" data-path="maths.html"><a href="maths.html#что-такое-матрица"><i class="fa fa-check"></i><b>9.5.1</b> Что такое матрица?</a></li>
<li class="chapter" data-level="9.5.2" data-path="maths.html"><a href="maths.html#откуда-берутся-матрицы"><i class="fa fa-check"></i><b>9.5.2</b> Откуда берутся матрицы?</a></li>
<li class="chapter" data-level="9.5.3" data-path="maths.html"><a href="maths.html#действия-с-матрицами"><i class="fa fa-check"></i><b>9.5.3</b> Действия с матрицами</a></li>
<li class="chapter" data-level="9.5.4" data-path="maths.html"><a href="maths.html#скалярное-произведение-векторов"><i class="fa fa-check"></i><b>9.5.4</b> Скалярное произведение векторов</a></li>
<li class="chapter" data-level="9.5.5" data-path="maths.html"><a href="maths.html#векторное-произведение-векторов"><i class="fa fa-check"></i><b>9.5.5</b> Векторное произведение векторов</a></li>
<li class="chapter" data-level="9.5.6" data-path="maths.html"><a href="maths.html#произведение-матриц-матричное-умножение"><i class="fa fa-check"></i><b>9.5.6</b> Произведение матриц (матричное умножение)</a></li>
<li class="chapter" data-level="9.5.7" data-path="maths.html"><a href="maths.html#транспонирование-матрицы"><i class="fa fa-check"></i><b>9.5.7</b> Транспонирование матрицы</a></li>
<li class="chapter" data-level="9.5.8" data-path="maths.html"><a href="maths.html#inv"><i class="fa fa-check"></i><b>9.5.8</b> Детерминант и обратная матрица</a></li>
<li class="chapter" data-level="9.5.9" data-path="maths.html"><a href="maths.html#след-матрицы"><i class="fa fa-check"></i><b>9.5.9</b> След матрицы</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="stats-intro.html"><a href="stats-intro.html"><i class="fa fa-check"></i><b>10</b> Введение в статистику</a><ul>
<li class="chapter" data-level="10.1" data-path="stats-intro.html"><a href="stats-intro.html#исходные-понятия-статистики"><i class="fa fa-check"></i><b>10.1</b> Исходные понятия статистики</a></li>
<li class="chapter" data-level="10.2" data-path="stats-intro.html"><a href="stats-intro.html#виды-статистических-данных"><i class="fa fa-check"></i><b>10.2</b> Виды статистических данных</a></li>
<li class="chapter" data-level="10.3" data-path="stats-intro.html"><a href="stats-intro.html#шкалы"><i class="fa fa-check"></i><b>10.3</b> Шкалы</a></li>
<li class="chapter" data-level="10.4" data-path="stats-intro.html"><a href="stats-intro.html#задачи-статистики"><i class="fa fa-check"></i><b>10.4</b> Задачи статистики</a><ul>
<li class="chapter" data-level="10.4.1" data-path="stats-intro.html"><a href="stats-intro.html#этапы-статистического-моделирования"><i class="fa fa-check"></i><b>10.4.1</b> Этапы статистического моделирования</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="randexp.html"><a href="randexp.html"><i class="fa fa-check"></i><b>11</b> Случайный эксперимент</a><ul>
<li class="chapter" data-level="11.1" data-path="randexp.html"><a href="randexp.html#ход-исследования"><i class="fa fa-check"></i><b>11.1</b> Ход исследования</a></li>
<li class="chapter" data-level="11.2" data-path="randexp.html"><a href="randexp.html#событие.-пространство-элементарных-событий."><i class="fa fa-check"></i><b>11.2</b> Событие. Пространство элементарных событий.</a><ul>
<li class="chapter" data-level="11.2.1" data-path="randexp.html"><a href="randexp.html#игральный-кубик"><i class="fa fa-check"></i><b>11.2.1</b> Игральный кубик</a></li>
<li class="chapter" data-level="11.2.2" data-path="randexp.html"><a href="randexp.html#events_operations"><i class="fa fa-check"></i><b>11.2.2</b> Действия над событиями</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="randexp.html"><a href="randexp.html#классическое-определение-вероятности"><i class="fa fa-check"></i><b>11.3</b> Классическое определение вероятности</a></li>
<li class="chapter" data-level="11.4" data-path="randexp.html"><a href="randexp.html#статистическое-определение-вероятности"><i class="fa fa-check"></i><b>11.4</b> Статистическое определение вероятности</a></li>
<li class="chapter" data-level="11.5" data-path="randexp.html"><a href="randexp.html#кроме-кубика"><i class="fa fa-check"></i><b>11.5</b> Кроме кубика</a></li>
<li class="chapter" data-level="11.6" data-path="randexp.html"><a href="randexp.html#вероятности-сложных-событий"><i class="fa fa-check"></i><b>11.6</b> Вероятности сложных событий</a><ul>
<li class="chapter" data-level="11.6.1" data-path="randexp.html"><a href="randexp.html#условная-вероятность"><i class="fa fa-check"></i><b>11.6.1</b> Условная вероятность</a></li>
<li class="chapter" data-level="11.6.2" data-path="randexp.html"><a href="randexp.html#теорема-байеса"><i class="fa fa-check"></i><b>11.6.2</b> Теорема Байеса</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="prob.html"><a href="prob.html"><i class="fa fa-check"></i><b>12</b> Вероятность и случайные величины</a><ul>
<li class="chapter" data-level="12.1" data-path="prob.html"><a href="prob.html#дискретные-случайные-величины"><i class="fa fa-check"></i><b>12.1</b> Дискретные случайные величины</a></li>
<li class="chapter" data-level="12.2" data-path="prob.html"><a href="prob.html#непрерывные-случайные-величины"><i class="fa fa-check"></i><b>12.2</b> Непрерывные случайные величины</a></li>
<li class="chapter" data-level="12.3" data-path="prob.html"><a href="prob.html#moments_distributions"><i class="fa fa-check"></i><b>12.3</b> Характеристики распределения случайных величин</a></li>
<li class="chapter" data-level="12.4" data-path="prob.html"><a href="prob.html#normal_distribution"><i class="fa fa-check"></i><b>12.4</b> Нормальное распределение</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="statestim.html"><a href="statestim.html"><i class="fa fa-check"></i><b>13</b> Оценивание параметров в практике статистического анализа</a><ul>
<li class="chapter" data-level="13.1" data-path="statestim.html"><a href="statestim.html#точечные-оценки"><i class="fa fa-check"></i><b>13.1</b> Точечные оценки</a><ul>
<li class="chapter" data-level="13.1.1" data-path="statestim.html"><a href="statestim.html#метод-моментов"><i class="fa fa-check"></i><b>13.1.1</b> Метод моментов</a></li>
<li class="chapter" data-level="13.1.2" data-path="statestim.html"><a href="statestim.html#свойства-точечных-оценок"><i class="fa fa-check"></i><b>13.1.2</b> Свойства точечных оценок</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="statestim.html"><a href="statestim.html#интервальные-оценки"><i class="fa fa-check"></i><b>13.2</b> Интервальные оценки</a><ul>
<li class="chapter" data-level="13.2.1" data-path="statestim.html"><a href="statestim.html#confinterval"><i class="fa fa-check"></i><b>13.2.1</b> Доверительный интервал</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="hypotheses.html"><a href="hypotheses.html"><i class="fa fa-check"></i><b>14</b> Тестирование статистических гипотез</a><ul>
<li class="chapter" data-level="14.1" data-path="hypotheses.html"><a href="hypotheses.html#базовые-понятия"><i class="fa fa-check"></i><b>14.1</b> Базовые понятия</a></li>
<li class="chapter" data-level="14.2" data-path="hypotheses.html"><a href="hypotheses.html#асимметрия-статистического-вывода"><i class="fa fa-check"></i><b>14.2</b> Асимметрия статистического вывода</a></li>
<li class="chapter" data-level="14.3" data-path="hypotheses.html"><a href="hypotheses.html#возможные-результаты-проверки-гипотез"><i class="fa fa-check"></i><b>14.3</b> Возможные результаты проверки гипотез</a></li>
<li class="chapter" data-level="14.4" data-path="hypotheses.html"><a href="hypotheses.html#алгоритм-тестирования-статистических-гипотез"><i class="fa fa-check"></i><b>14.4</b> Алгоритм тестирования статистических гипотез</a></li>
<li class="chapter" data-level="14.5" data-path="hypotheses.html"><a href="hypotheses.html#multiple_comp_problem"><i class="fa fa-check"></i><b>14.5</b> Проблема множественных сравнений</a></li>
</ul></li>
<li class="part"><span><b>III Анализ данных</b></span></li>
<li class="chapter" data-level="15" data-path="descriptives.html"><a href="descriptives.html"><i class="fa fa-check"></i><b>15</b> Описательные статистики</a><ul>
<li class="chapter" data-level="15.1" data-path="descriptives.html"><a href="descriptives.html#меры-центральной-тенденции"><i class="fa fa-check"></i><b>15.1</b> Меры центральной тенденции</a><ul>
<li class="chapter" data-level="15.1.1" data-path="descriptives.html"><a href="descriptives.html#мода"><i class="fa fa-check"></i><b>15.1.1</b> Мода</a></li>
<li class="chapter" data-level="15.1.2" data-path="descriptives.html"><a href="descriptives.html#медиана"><i class="fa fa-check"></i><b>15.1.2</b> Медиана</a></li>
<li class="chapter" data-level="15.1.3" data-path="descriptives.html"><a href="descriptives.html#среднее"><i class="fa fa-check"></i><b>15.1.3</b> Среднее</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="descriptives.html"><a href="descriptives.html#меры-разброса"><i class="fa fa-check"></i><b>15.2</b> Меры разброса</a><ul>
<li class="chapter" data-level="15.2.1" data-path="descriptives.html"><a href="descriptives.html#минимум-и-максимум"><i class="fa fa-check"></i><b>15.2.1</b> Минимум и максимум</a></li>
<li class="chapter" data-level="15.2.2" data-path="descriptives.html"><a href="descriptives.html#размах"><i class="fa fa-check"></i><b>15.2.2</b> Размах</a></li>
<li class="chapter" data-level="15.2.3" data-path="descriptives.html"><a href="descriptives.html#дисперсия"><i class="fa fa-check"></i><b>15.2.3</b> Дисперсия</a></li>
<li class="chapter" data-level="15.2.4" data-path="descriptives.html"><a href="descriptives.html#стандартное-отклонение"><i class="fa fa-check"></i><b>15.2.4</b> Стандартное отклонение</a></li>
<li class="chapter" data-level="15.2.5" data-path="descriptives.html"><a href="descriptives.html#стандартная-ошибка-среднего"><i class="fa fa-check"></i><b>15.2.5</b> Стандартная ошибка среднего</a></li>
<li class="chapter" data-level="15.2.6" data-path="descriptives.html"><a href="descriptives.html#квантили"><i class="fa fa-check"></i><b>15.2.6</b> Квантили</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="descriptives.html"><a href="descriptives.html#асимметрия"><i class="fa fa-check"></i><b>15.3</b> Асимметрия</a></li>
<li class="chapter" data-level="15.4" data-path="descriptives.html"><a href="descriptives.html#эксцесс"><i class="fa fa-check"></i><b>15.4</b> Эксцесс</a></li>
<li class="chapter" data-level="15.5" data-path="descriptives.html"><a href="descriptives.html#описательные-статистики-в-r"><i class="fa fa-check"></i><b>15.5</b> Описательные статистики в R</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="correlation.html"><a href="correlation.html"><i class="fa fa-check"></i><b>16</b> Корреляционный анализ</a><ul>
<li class="chapter" data-level="16.1" data-path="correlation.html"><a href="correlation.html#ковариация"><i class="fa fa-check"></i><b>16.1</b> Ковариация</a></li>
<li class="chapter" data-level="16.2" data-path="correlation.html"><a href="correlation.html#корреляция"><i class="fa fa-check"></i><b>16.2</b> Корреляция</a><ul>
<li class="chapter" data-level="16.2.1" data-path="correlation.html"><a href="correlation.html#тестирование-статистической-значимости-коэффициента-корреляции"><i class="fa fa-check"></i><b>16.2.1</b> Тестирование статистической значимости коэффициента корреляции</a></li>
<li class="chapter" data-level="16.2.2" data-path="correlation.html"><a href="correlation.html#доверительный-интервал-для-коэффициента-корреляции"><i class="fa fa-check"></i><b>16.2.2</b> Доверительный интервал для коэффициента корреляции</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="correlation.html"><a href="correlation.html#ковариация-и-корреляция-в-r"><i class="fa fa-check"></i><b>16.3</b> Ковариация и корреляция в R</a><ul>
<li class="chapter" data-level="16.3.1" data-path="correlation.html"><a href="correlation.html#коэффициенты-корреляции-для-разных-шкал"><i class="fa fa-check"></i><b>16.3.1</b> Коэффициенты корреляции для разных шкал</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="correlation.html"><a href="correlation.html#частный-и-множественный-коэффициент-корреляции"><i class="fa fa-check"></i><b>16.4</b> Частный и множественный коэффициент корреляции</a></li>
<li class="chapter" data-level="16.5" data-path="correlation.html"><a href="correlation.html#другие-корреляции"><i class="fa fa-check"></i><b>16.5</b> Другие корреляции</a><ul>
<li class="chapter" data-level="16.5.1" data-path="correlation.html"><a href="correlation.html#phi-коэффициент"><i class="fa fa-check"></i><b>16.5.1</b> <span class="math inline">\(\phi\)</span>-коэффициент</a></li>
<li class="chapter" data-level="16.5.2" data-path="correlation.html"><a href="correlation.html#бисериальный-коэффициент-корреляции"><i class="fa fa-check"></i><b>16.5.2</b> Бисериальный коэффициент корреляции</a></li>
<li class="chapter" data-level="16.5.3" data-path="correlation.html"><a href="correlation.html#рангово-бисериальный-коэффициент-корреляции"><i class="fa fa-check"></i><b>16.5.3</b> Рангово-бисериальный коэффициент корреляции</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="simple-linear.html"><a href="simple-linear.html"><i class="fa fa-check"></i><b>17</b> Общие линейные модели. Простая линейная регрессия</a><ul>
<li class="chapter" data-level="17.1" data-path="simple-linear.html"><a href="simple-linear.html#формализация-модели"><i class="fa fa-check"></i><b>17.1</b> Формализация модели</a></li>
<li class="chapter" data-level="17.2" data-path="simple-linear.html"><a href="simple-linear.html#идентификация-модели"><i class="fa fa-check"></i><b>17.2</b> Идентификация модели</a><ul>
<li class="chapter" data-level="17.2.1" data-path="simple-linear.html"><a href="simple-linear.html#метод-наименьших-квадратов"><i class="fa fa-check"></i><b>17.2.1</b> Метод наименьших квадратов</a></li>
<li class="chapter" data-level="17.2.2" data-path="simple-linear.html"><a href="simple-linear.html#матричное-вычисление-коэффициентов"><i class="fa fa-check"></i><b>17.2.2</b> Матричное вычисление коэффициентов</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="simple-linear.html"><a href="simple-linear.html#тестирование-качества-модели"><i class="fa fa-check"></i><b>17.3</b> Тестирование качества модели</a><ul>
<li class="chapter" data-level="17.3.1" data-path="simple-linear.html"><a href="simple-linear.html#коэффициент-детерминации"><i class="fa fa-check"></i><b>17.3.1</b> Коэффициент детерминации</a></li>
<li class="chapter" data-level="17.3.2" data-path="simple-linear.html"><a href="simple-linear.html#статистическая-значимость-модели"><i class="fa fa-check"></i><b>17.3.2</b> Статистическая значимость модели</a></li>
<li class="chapter" data-level="17.3.3" data-path="simple-linear.html"><a href="simple-linear.html#статистическая-значимость-отдельных-предикторов"><i class="fa fa-check"></i><b>17.3.3</b> Статистическая значимость отдельных предикторов</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="simple-linear.html"><a href="simple-linear.html#простая-линейная-регрессия-в-r"><i class="fa fa-check"></i><b>17.4</b> Простая линейная регрессия в R</a></li>
<li class="chapter" data-level="17.5" data-path="simple-linear.html"><a href="simple-linear.html#диагностика-модели"><i class="fa fa-check"></i><b>17.5</b> Диагностика модели</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="multiple-linear.html"><a href="multiple-linear.html"><i class="fa fa-check"></i><b>18</b> Множественная линейная регрессия</a><ul>
<li class="chapter" data-level="18.1" data-path="multiple-linear.html"><a href="multiple-linear.html#множественная-линейная-регрессия-с-количественными-предикторами"><i class="fa fa-check"></i><b>18.1</b> Множественная линейная регрессия с количественными предикторами</a><ul>
<li class="chapter" data-level="18.1.1" data-path="multiple-linear.html"><a href="multiple-linear.html#математическая-модель"><i class="fa fa-check"></i><b>18.1.1</b> Математическая модель</a></li>
<li class="chapter" data-level="18.1.2" data-path="multiple-linear.html"><a href="multiple-linear.html#подбор-модели"><i class="fa fa-check"></i><b>18.1.2</b> Подбор модели</a></li>
<li class="chapter" data-level="18.1.3" data-path="multiple-linear.html"><a href="multiple-linear.html#оценка-качества-модели"><i class="fa fa-check"></i><b>18.1.3</b> Оценка качества модели</a></li>
<li class="chapter" data-level="18.1.4" data-path="multiple-linear.html"><a href="multiple-linear.html#диагностика-модели-1"><i class="fa fa-check"></i><b>18.1.4</b> Диагностика модели</a></li>
<li class="chapter" data-level="18.1.5" data-path="multiple-linear.html"><a href="multiple-linear.html#staff_reg"><i class="fa fa-check"></i><b>18.1.5</b> Доработка модели</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="multiple-linear.html"><a href="multiple-linear.html#множественная-линейная-регрессия-с-количественными-и-категориальными-предикторами"><i class="fa fa-check"></i><b>18.2</b> Множественная линейная регрессия с количественными и категориальными предикторами</a><ul>
<li class="chapter" data-level="18.2.1" data-path="multiple-linear.html"><a href="multiple-linear.html#математическая-модель-1"><i class="fa fa-check"></i><b>18.2.1</b> Математическая модель</a></li>
<li class="chapter" data-level="18.2.2" data-path="multiple-linear.html"><a href="multiple-linear.html#подбор-модели-1"><i class="fa fa-check"></i><b>18.2.2</b> Подбор модели</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="multiple-linear.html"><a href="multiple-linear.html#модели-со-взаимодействием-предикторов"><i class="fa fa-check"></i><b>18.3</b> Модели со взаимодействием предикторов</a><ul>
<li class="chapter" data-level="18.3.1" data-path="multiple-linear.html"><a href="multiple-linear.html#математическая-модель-2"><i class="fa fa-check"></i><b>18.3.1</b> Математическая модель</a></li>
<li class="chapter" data-level="18.3.2" data-path="multiple-linear.html"><a href="multiple-linear.html#подбор-модели-2"><i class="fa fa-check"></i><b>18.3.2</b> Подбор модели</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="multiple-linear.html"><a href="multiple-linear.html#сравнение-моделей"><i class="fa fa-check"></i><b>18.4</b> Сравнение моделей</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="anova.html"><a href="anova.html"><i class="fa fa-check"></i><b>19</b> Дисперсионный анализ</a><ul>
<li class="chapter" data-level="19.1" data-path="anova.html"><a href="anova.html#параметризация-индикаторов-и-параметризация-эффектов"><i class="fa fa-check"></i><b>19.1</b> Параметризация индикаторов и параметризация эффектов</a></li>
<li class="chapter" data-level="19.2" data-path="anova.html"><a href="anova.html#однофакторный-дисперсионный-анализ"><i class="fa fa-check"></i><b>19.2</b> Однофакторный дисперсионный анализ</a><ul>
<li class="chapter" data-level="19.2.1" data-path="anova.html"><a href="anova.html#зачем-вообще-дисперсионный-анализ"><i class="fa fa-check"></i><b>19.2.1</b> Зачем вообще дисперсионный анализ?</a></li>
<li class="chapter" data-level="19.2.2" data-path="anova.html"><a href="anova.html#структура-изменчивости"><i class="fa fa-check"></i><b>19.2.2</b> Структура изменчивости</a></li>
<li class="chapter" data-level="19.2.3" data-path="anova.html"><a href="anova.html#тестирование-значимости-фактора"><i class="fa fa-check"></i><b>19.2.3</b> Тестирование значимости фактора</a></li>
<li class="chapter" data-level="19.2.4" data-path="anova.html"><a href="anova.html#дисперсионный-анализ-в-r"><i class="fa fa-check"></i><b>19.2.4</b> Дисперсионный анализ в R</a></li>
<li class="chapter" data-level="19.2.5" data-path="anova.html"><a href="anova.html#post-hoc-тесты"><i class="fa fa-check"></i><b>19.2.5</b> Post hoc тесты</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="anova.html"><a href="anova.html#многофакторный-дисперсионный-анализ"><i class="fa fa-check"></i><b>19.3</b> Многофакторный дисперсионный анализ</a><ul>
<li class="chapter" data-level="19.3.1" data-path="anova.html"><a href="anova.html#типы-сумм-квадратов"><i class="fa fa-check"></i><b>19.3.1</b> Типы сумм квадратов</a></li>
<li class="chapter" data-level="19.3.2" data-path="anova.html"><a href="anova.html#post-hoc-тесты-1"><i class="fa fa-check"></i><b>19.3.2</b> Post hoc тесты</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="anova.html"><a href="anova.html#дисперсионный-анализ-с-повторными-измерениями"><i class="fa fa-check"></i><b>19.4</b> Дисперсионный анализ с повторными измерениями</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="ancova.html"><a href="ancova.html"><i class="fa fa-check"></i><b>20</b> Ковариационный анализ</a><ul>
<li class="chapter" data-level="20.1" data-path="ancova.html"><a href="ancova.html#модель-ковариационного-анализа"><i class="fa fa-check"></i><b>20.1</b> Модель ковариационного анализа</a></li>
<li class="chapter" data-level="20.2" data-path="ancova.html"><a href="ancova.html#влияние-ковариаты"><i class="fa fa-check"></i><b>20.2</b> Влияние ковариаты</a></li>
<li class="chapter" data-level="20.3" data-path="ancova.html"><a href="ancova.html#более-сложные-модели"><i class="fa fa-check"></i><b>20.3</b> Более сложные модели</a></li>
<li class="chapter" data-level="20.4" data-path="ancova.html"><a href="ancova.html#тестирование-значимости-предикторов-и-диагностика-модели"><i class="fa fa-check"></i><b>20.4</b> Тестирование значимости предикторов и диагностика модели</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="logistic.html"><a href="logistic.html"><i class="fa fa-check"></i><b>21</b> Обобщенные линейные модели. Логистическая регрессия</a><ul>
<li class="chapter" data-level="21.1" data-path="logistic.html"><a href="logistic.html#ограничения-общих-линейных-моделей"><i class="fa fa-check"></i><b>21.1</b> Ограничения общих линейных моделей</a></li>
<li class="chapter" data-level="21.2" data-path="logistic.html"><a href="logistic.html#биномиальное-распределение"><i class="fa fa-check"></i><b>21.2</b> Биномиальное распределение</a></li>
<li class="chapter" data-level="21.3" data-path="logistic.html"><a href="logistic.html#бинарные-переменные"><i class="fa fa-check"></i><b>21.3</b> Бинарные переменные</a></li>
<li class="chapter" data-level="21.4" data-path="logistic.html"><a href="logistic.html#hr-данные"><i class="fa fa-check"></i><b>21.4</b> HR-данные</a></li>
<li class="chapter" data-level="21.5" data-path="logistic.html"><a href="logistic.html#задача-построения-линейной-модели"><i class="fa fa-check"></i><b>21.5</b> Задача построения линейной модели</a></li>
<li class="chapter" data-level="21.6" data-path="logistic.html"><a href="logistic.html#переход-от-дискретной-величины-к-непрерывной"><i class="fa fa-check"></i><b>21.6</b> Переход от дискретной величины к непрерывной</a><ul>
<li class="chapter" data-level="21.6.1" data-path="logistic.html"><a href="logistic.html#логистическая-кривая"><i class="fa fa-check"></i><b>21.6.1</b> Логистическая кривая</a></li>
<li class="chapter" data-level="21.6.2" data-path="logistic.html"><a href="logistic.html#шансы-и-логиты"><i class="fa fa-check"></i><b>21.6.2</b> Шансы и логиты</a></li>
</ul></li>
<li class="chapter" data-level="21.7" data-path="logistic.html"><a href="logistic.html#формулирование-модели-в-математическом-виде"><i class="fa fa-check"></i><b>21.7</b> Формулирование модели в математическом виде</a></li>
<li class="chapter" data-level="21.8" data-path="logistic.html"><a href="logistic.html#подбор-линейной-модели"><i class="fa fa-check"></i><b>21.8</b> Подбор линейной модели</a><ul>
<li class="chapter" data-level="21.8.1" data-path="logistic.html"><a href="logistic.html#метод-максимального-правдоподобия"><i class="fa fa-check"></i><b>21.8.1</b> Метод максимального правдоподобия</a></li>
</ul></li>
<li class="chapter" data-level="21.9" data-path="logistic.html"><a href="logistic.html#анализ-модели"><i class="fa fa-check"></i><b>21.9</b> Анализ модели</a></li>
<li class="chapter" data-level="21.10" data-path="logistic.html"><a href="logistic.html#анализ-девиансы-и-упрощение-модели"><i class="fa fa-check"></i><b>21.10</b> Анализ девиансы и упрощение модели</a></li>
<li class="chapter" data-level="21.11" data-path="logistic.html"><a href="logistic.html#интерпретация-коэффициентов-модели"><i class="fa fa-check"></i><b>21.11</b> Интерпретация коэффициентов модели</a><ul>
<li class="chapter" data-level="21.11.1" data-path="logistic.html"><a href="logistic.html#немного-алгебры-для-понимания-сути-коэффициентов"><i class="fa fa-check"></i><b>21.11.1</b> Немного алгебры для понимания сути коэффициентов</a></li>
</ul></li>
<li class="chapter" data-level="21.12" data-path="logistic.html"><a href="logistic.html#предсказательная-сила-модели"><i class="fa fa-check"></i><b>21.12</b> Предсказательная сила модели</a><ul>
<li class="chapter" data-level="21.12.1" data-path="logistic.html"><a href="logistic.html#перевод-непрерывных-предсказаний-в-дискретные"><i class="fa fa-check"></i><b>21.12.1</b> Перевод непрерывных предсказаний в дискретные</a></li>
<li class="chapter" data-level="21.12.2" data-path="logistic.html"><a href="logistic.html#confusion-matrix"><i class="fa fa-check"></i><b>21.12.2</b> Confusion matrix</a></li>
<li class="chapter" data-level="21.12.3" data-path="logistic.html"><a href="logistic.html#accuracy"><i class="fa fa-check"></i><b>21.12.3</b> Accuracy</a></li>
<li class="chapter" data-level="21.12.4" data-path="logistic.html"><a href="logistic.html#precision-and-recall"><i class="fa fa-check"></i><b>21.12.4</b> Precision and Recall</a></li>
<li class="chapter" data-level="21.12.5" data-path="logistic.html"><a href="logistic.html#f1-мера"><i class="fa fa-check"></i><b>21.12.5</b> F1-мера</a></li>
<li class="chapter" data-level="21.12.6" data-path="logistic.html"><a href="logistic.html#roc-auc"><i class="fa fa-check"></i><b>21.12.6</b> ROC-AUC</a></li>
</ul></li>
<li class="chapter" data-level="21.13" data-path="logistic.html"><a href="logistic.html#предсказания-на-новых-данных"><i class="fa fa-check"></i><b>21.13</b> Предсказания на новых данных</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="poisson.html"><a href="poisson.html"><i class="fa fa-check"></i><b>22</b> Пуассоновская регрессия</a><ul>
<li class="chapter" data-level="22.1" data-path="poisson.html"><a href="poisson.html#распределение-пуассона"><i class="fa fa-check"></i><b>22.1</b> Распределение Пуассона</a></li>
<li class="chapter" data-level="22.2" data-path="poisson.html"><a href="poisson.html#почему-обычные-регрессионные-модели-плохо-работают-на-счётных-данных"><i class="fa fa-check"></i><b>22.2</b> Почему обычные регрессионные модели плохо работают на счётных данных</a></li>
<li class="chapter" data-level="22.3" data-path="poisson.html"><a href="poisson.html#данные-1"><i class="fa fa-check"></i><b>22.3</b> Данные</a></li>
<li class="chapter" data-level="22.4" data-path="poisson.html"><a href="poisson.html#glm-с-пуассоновским-распределением-целевой-переменной"><i class="fa fa-check"></i><b>22.4</b> GLM с пуассоновским распределением целевой переменной</a><ul>
<li class="chapter" data-level="22.4.1" data-path="poisson.html"><a href="poisson.html#подбор-модели-в-r"><i class="fa fa-check"></i><b>22.4.1</b> Подбор модели в R</a></li>
</ul></li>
<li class="chapter" data-level="22.5" data-path="poisson.html"><a href="poisson.html#интерпретация-коэффициентов-модели-1"><i class="fa fa-check"></i><b>22.5</b> Интерпретация коэффициентов модели</a></li>
<li class="chapter" data-level="22.6" data-path="poisson.html"><a href="poisson.html#анализ-девиансы"><i class="fa fa-check"></i><b>22.6</b> Анализ девиансы</a></li>
<li class="chapter" data-level="22.7" data-path="poisson.html"><a href="poisson.html#проверка-на-сверхдисперсию-overdispersion"><i class="fa fa-check"></i><b>22.7</b> Проверка на сверхдисперсию (overdispersion)</a></li>
<li class="chapter" data-level="22.8" data-path="poisson.html"><a href="poisson.html#квазипуассоновские-модели"><i class="fa fa-check"></i><b>22.8</b> Квазипуассоновские модели</a><ul>
<li class="chapter" data-level="22.8.1" data-path="poisson.html"><a href="poisson.html#квазипуассоновские-модели-в-r"><i class="fa fa-check"></i><b>22.8.1</b> Квазипуассоновские модели в R</a></li>
</ul></li>
<li class="chapter" data-level="22.9" data-path="poisson.html"><a href="poisson.html#особенности-работы-с-квазипуассоновскими-моделями"><i class="fa fa-check"></i><b>22.9</b> Особенности работы с квазипуассоновскими моделями</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="regularization.html"><a href="regularization.html"><i class="fa fa-check"></i><b>23</b> Регуляризация регрессии</a><ul>
<li class="chapter" data-level="23.1" data-path="regularization.html"><a href="regularization.html#варианты-штрафа"><i class="fa fa-check"></i><b>23.1</b> Варианты штрафа</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="glmm.html"><a href="glmm.html"><i class="fa fa-check"></i><b>24</b> Смешанные линейные модели</a></li>
<li class="chapter" data-level="25" data-path="cluster.html"><a href="cluster.html"><i class="fa fa-check"></i><b>25</b> Кластерный анализ</a></li>
<li class="chapter" data-level="26" data-path="pca.html"><a href="pca.html"><i class="fa fa-check"></i><b>26</b> Анализ главных компонент</a></li>
<li class="chapter" data-level="27" data-path="efa.html"><a href="efa.html"><i class="fa fa-check"></i><b>27</b> Эксплораторный факторный анализ</a></li>
<li class="chapter" data-level="28" data-path="cfa.html"><a href="cfa.html"><i class="fa fa-check"></i><b>28</b> Конфирматорный факторный анализ</a></li>
<li class="chapter" data-level="29" data-path="further.html"><a href="further.html"><i class="fa fa-check"></i><b>29</b> Что дальше?</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>Литература</a><ul>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#касаемо-математики"><i class="fa fa-check"></i>Касаемо математики</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#относительно-статистики"><i class="fa fa-check"></i>Относительно статистики</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#about-r"><i class="fa fa-check"></i>About R</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#во-славу-андана"><i class="fa fa-check"></i>Во славу андана</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">HSE UX LAB | Анализ данных + R: мир линейных моделей | Book</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="poisson" class="section level1">
<h1><span class="header-section-number">22</span> Пуассоновская регрессия</h1>
<p>В жизни и практике мы часто сталкиваемся с так называемыми <em>счётными величинами</em>. Например, число комнат в квартире, количество детей в семье, число книг на полке, число людей, прошедших через турникет и т.д. Глобально — любые количества. Также как счётные величины можно рассмотреть шкалу Лайкерта или оценки по десятибалльной шкале — по сути, это количество набранных баллов.</p>
<p>Какими свойствами обладают такие величины?</p>
<ul>
<li>Они могут принимать <em>только целочисленные значения</em> (<span class="math inline">\(x \in \mathbb Z\)</span>)</li>
<li>Также возможны <em>нулевые значения</em> (<span class="math inline">\(0 \leq x \leq +\infty\)</span>)</li>
<li>Разброс значений <em>зависит от среднего значения</em> (<span class="math inline">\(\mathrm{var}(X) \propto \mathbb{E}(X)\)</span>)</li>
</ul>
<p>До сих пор мы обсуждали модели, применимые только к мерным, или непрерывным, величинам<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>. Иногда свойства данных позволяют использовать такие методы для моделирования счётных величин, однако так бывает далеко не всегда.</p>
<p>В этой главе мы обсудим самый простой подход к моделированию счетных величин, а также одну его модификацию, которая может быть полезна.</p>
<p>Модели для счётных данных базируются н <strong>распределении Пуассона</strong>.</p>
<div id="распределение-пуассона" class="section level2">
<h2><span class="header-section-number">22.1</span> Распределение Пуассона</h2>
<p>Распределение Пуассона опредляется следующим образом:</p>
<p><span class="math display">\[
Y \thicksim \mathrm{Poisson}(\mu) \\
f(y) = \frac{\mu^y e - \mu}{y!}
\]</span></p>
<p><span class="math inline">\(\mu\)</span> — единственный параметр данного распределения<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>. Он задаёт и математическое ожидание, и дисперсию, т. е.</p>
<p><span class="math display">\[
\mathbb{E}(Y) = \mu \\
\mathrm{var}(Y) = \mu \\
y \in \mathbb{N}_0
\]</span></p>
<p>Как <span class="math inline">\(\mathbb{N}_0\)</span> здесь обозначено множество натуральных чисел с нулем.</p>
<p>В зависимости от того, какие значения принимает этот параметр, распределение принимает достаточно сильно различающиеся формы. При низких значения (<span class="math inline">\(\mu = 1, \mu = 2\)</span>) в распределение присутствует сильная левосторонняя асимметрия, при высоких (<span class="math inline">\(\mu = 10\)</span>) — распределение становится симметричным и очень похожим на нормальное распределение.</p>
<center>
<img src="img/poisson.png">
</center>
<p>Необходимо отметить, что пуассоновское распределение предполагает, что дисперсия связана с математическим ожидание через <em>функцию идентичности</em><a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>, то есть с увеличением математического ожидания дисперсия возрастает ровно так же, как и само математичекое ожидание. Это факт нам будет важен далее.</p>
</div>
<div id="почему-обычные-регрессионные-модели-плохо-работают-на-счётных-данных" class="section level2">
<h2><span class="header-section-number">22.2</span> Почему обычные регрессионные модели плохо работают на счётных данных</h2>
<p>Ещё раз отметил два ключевых свойства пуассоновского распределения:</p>
<ul>
<li>множество значений целевой переменной — натуральные числа с нулём: <span class="math inline">\(y \in \mathbb{N}_0\)</span></li>
<li>дисперсия целевой переменной зависит от матиматического ожидания: <span class="math inline">\(\mathrm{var}(Y) \propto \mathbb E(Y)\)</span></li>
</ul>
<p>Первое свойство нам говорит о том, что количество не может быть отрицательным, и это логично. Обчная линейнная регрессия не имеет подобных ограничений, поэтому в предсказаниях <em>будут появляться отрицательные значения</em>. Что с ними делать не очень понятно.</p>
<p>Второе свойство говорит нам о том, что изначально <em>не будет выполнено допущение гомоскедастичности остатков</em>, так как чем выше математичекое ожидание, тем выше дисперсия. В итоге мы будем наблюдать воронкообразный паттер в распределении остатков:</p>
<center>
<img src="img/poisson_residuals.png">
</center>
<p>Таким образом, оценки коэффициентов модели будут неточны, ошибки завышены, а следовательно, и результатам тестирования статистической значимости параметров модели доверять нельзя.</p>
<p>Что делать?</p>
<p>Можно пойти простым путём — <strong>логарифмировать целевую переменную</strong> и построить модель для получившейся величины.</p>
<p>Но более корректным вариантом будет построить модель, основанную на распределении, подходящем для счётных данных. В частности, пуассоновском распределении.</p>
</div>
<div id="данные-1" class="section level2">
<h2><span class="header-section-number">22.3</span> Данные</h2>
<p>Сегодня мы будем работать с данными эксперимента, в котором изучалась роль интерфейсных влияний на формирование положительного пользовательского опыта. Данные <a href="https://raw.githubusercontent.com/angelgardt/hseuxlab-wlm2021/master/book/wlm2021-book/data/trust_data.csv">тут</a>.</p>
<p>Грузим:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(tidyverse)</a></code></pre></div>
<pre><code>## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.0 ──</code></pre>
<pre><code>## ✓ ggplot2 3.3.3     ✓ purrr   0.3.4
## ✓ tibble  3.1.0     ✓ dplyr   1.0.5
## ✓ tidyr   1.1.3     ✓ stringr 1.4.0
## ✓ readr   1.4.0     ✓ forcats 0.5.1</code></pre>
<pre><code>## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">satis &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&#39;https://raw.githubusercontent.com/angelgardt/hseuxlab-wlm2021/master/book/wlm2021-book/data/trust_data.csv&#39;</span>)</a></code></pre></div>
<pre><code>## 
## ── Column specification ────────────────────────────────────────────────────────
## cols(
##   .default = col_double(),
##   id = col_character(),
##   sex = col_character(),
##   specialisation = col_character(),
##   sus_mark = col_character(),
##   explanation = col_character(),
##   feedback = col_character()
## )
## ℹ Use `spec()` for the full column specifications.</code></pre>
<p>Смотрим:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw">str</span>(satis)</a></code></pre></div>
<pre><code>## spec_tbl_df [120 × 31] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
##  $ id            : chr [1:120] &quot;T1-WNBEQD&quot; &quot;T1-MVCbgv&quot; &quot;T1-zgPIDz&quot; &quot;T1-bQwnJq&quot; ...
##  $ age           : num [1:120] 20 21 22 19 19 20 20 20 22 20 ...
##  $ sex           : chr [1:120] &quot;f&quot; &quot;f&quot; &quot;m&quot; &quot;f&quot; ...
##  $ specialisation: chr [1:120] &quot;\u041f\u0441\u0438\u0445\u043e\u043b\u043e\u0433\u0438\u044f&quot; &quot;\u0441\u043e\u0446\u0438\u0430\u043b\u044c\u043d\u044b\u0439 \u043f\u0441\u0438\u0445\u043e\u043b\u043e\u0433&quot; &quot;\u044d\u043a\u043e\u043d\u043e\u043c\u0438\u043a\u0430&quot; &quot;\u041f\u0441\u0438\u0445\u043e\u043b\u043e\u0433\u0438\u044f&quot; ...
##  $ freq_facebook : num [1:120] 0 1 2 0 0 1 1 0 1 0 ...
##  $ like_facebook : num [1:120] NA 1 3 NA NA 3 2 NA 2 NA ...
##  $ sort_facebook : num [1:120] NA 0 2 NA NA 2 0 NA 0 NA ...
##  $ freq_twitter  : num [1:120] 1 3 0 1 2 0 3 0 1 0 ...
##  $ like_twitter  : num [1:120] NA NA NA 4 NA 4 5 NA 4 NA ...
##  $ sort_twitter  : num [1:120] NA NA NA 1 NA 2 2 NA 1 NA ...
##  $ freq_youtube  : num [1:120] 3 1 3 0 1 3 3 3 2 3 ...
##  $ rec_youtube   : num [1:120] 1 1 1 NA 0 1 1 1 1 0 ...
##  $ why_youtube   : num [1:120] NA NA NA NA 1 NA NA NA NA 1 ...
##  $ sort_youtube  : num [1:120] 2 1 0 NA NA 1 1 2 2 NA ...
##  $ finalbtn      : num [1:120] 0 0 0 0 1 1 1 0 0 0 ...
##  $ t1            : num [1:120] 5 5 2 4 4 5 5 4 5 4 ...
##  $ t2            : num [1:120] 4 5 3 3 3 4 5 5 4 4 ...
##  $ b1            : num [1:120] 5 5 4 5 4 2 5 4 4 3 ...
##  $ sus_sum       : num [1:120] 90 77.5 87.5 82.5 75 85 90 82.5 87.5 75 ...
##  $ sus_mark      : chr [1:120] &quot;A&quot; &quot;C&quot; &quot;B&quot; &quot;B&quot; ...
##  $ time1         : num [1:120] 21245 56439 58917 58919 40417 ...
##  $ time2         : num [1:120] 83549 64750 29596 70678 84523 ...
##  $ time3         : num [1:120] 21473 3265 13161 17145 31042 ...
##  $ time4         : num [1:120] 19560 32546 28796 34088 13535 ...
##  $ errors1       : num [1:120] 1 2 1 1 0 1 1 1 0 0 ...
##  $ errors2       : num [1:120] 3 1 1 0 3 0 0 2 0 1 ...
##  $ errors_total  : num [1:120] 4 3 2 1 3 1 1 3 0 1 ...
##  $ courses       : num [1:120] 3 7 3 3 0 5 2 3 6 5 ...
##  $ group         : num [1:120] 1 1 1 1 1 1 1 1 1 1 ...
##  $ explanation   : chr [1:120] &quot;yes&quot; &quot;yes&quot; &quot;yes&quot; &quot;yes&quot; ...
##  $ feedback      : chr [1:120] &quot;good&quot; &quot;good&quot; &quot;good&quot; &quot;good&quot; ...
##  - attr(*, &quot;spec&quot;)=
##   .. cols(
##   ..   id = col_character(),
##   ..   age = col_double(),
##   ..   sex = col_character(),
##   ..   specialisation = col_character(),
##   ..   freq_facebook = col_double(),
##   ..   like_facebook = col_double(),
##   ..   sort_facebook = col_double(),
##   ..   freq_twitter = col_double(),
##   ..   like_twitter = col_double(),
##   ..   sort_twitter = col_double(),
##   ..   freq_youtube = col_double(),
##   ..   rec_youtube = col_double(),
##   ..   why_youtube = col_double(),
##   ..   sort_youtube = col_double(),
##   ..   finalbtn = col_double(),
##   ..   t1 = col_double(),
##   ..   t2 = col_double(),
##   ..   b1 = col_double(),
##   ..   sus_sum = col_double(),
##   ..   sus_mark = col_character(),
##   ..   time1 = col_double(),
##   ..   time2 = col_double(),
##   ..   time3 = col_double(),
##   ..   time4 = col_double(),
##   ..   errors1 = col_double(),
##   ..   errors2 = col_double(),
##   ..   errors_total = col_double(),
##   ..   courses = col_double(),
##   ..   group = col_double(),
##   ..   explanation = col_character(),
##   ..   feedback = col_character()
##   .. )</code></pre>
<p>Исследовании проводилось на материале рекомендательной системы, варьировались два компонента интерфейса:</p>
<ul>
<li><code>feedback</code> — тип фидбека:
<ul>
<li><code>good</code> — «хороший», предъявляемый в нужном месте и нужное время</li>
<li><code>bad</code> — «плохой», предъявляемый не там, где надо, и не тогда, когда надо</li>
</ul></li>
<li><code>explanation</code> — объяснение работы рекомендательного алгоритма, которое могло быть представлено (<code>yes</code>) или скрыто от пользователя (<code>no</code>).</li>
</ul>
<p>Именно эти две переменные нас будут интересовать в качестве предикторов.</p>
<p>В качестве зависимой переменной мы возьмем грейд по шкале SUS (System Usability Scale). Сейчас это переменная <code>sus_mark</code>. Однако сейчас она текстовая, нам необходимо её перекодировать в счётную числовую. Можно это сделать через <code>ifelse()</code>. Создадим новую переменную <code>sus_grade</code>:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">satis<span class="op">$</span>sus_grade &lt;-<span class="st"> </span><span class="kw">recode</span>(satis<span class="op">$</span>sus_mark,</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">                          <span class="st">&#39;A&#39;</span> =<span class="st"> </span><span class="dv">5</span>, <span class="st">&#39;B&#39;</span> =<span class="st"> </span><span class="dv">4</span>, <span class="st">&#39;C&#39;</span> =<span class="st"> </span><span class="dv">3</span>, <span class="st">&#39;D&#39;</span> =<span class="st"> </span><span class="dv">2</span>, <span class="st">&#39;E&#39;</span> =<span class="st"> </span><span class="dv">1</span>, <span class="st">&#39;F&#39;</span> =<span class="st"> </span><span class="dv">0</span>)</a></code></pre></div>
<p>Вот теперь хорошо. Можно строить модель!</p>
</div>
<div id="glm-с-пуассоновским-распределением-целевой-переменной" class="section level2">
<h2><span class="header-section-number">22.4</span> GLM с пуассоновским распределением целевой переменной</h2>
<p>Мы с вами всё ещё во фреймфорке GLM, поэтому формулировка модели в общем виде будет выглядеть аналогично биномиальной регрессии:</p>
<p><span class="math display">\[
\mathrm{sus\_grade}_i \thicksim \mathrm{Poisson}(\mu_i) \\
\mathbb{E} (\mathrm{sus\_grade}_i) = \mu_i, \quad \mathrm{var}(\mathrm{sus\_grade}_i) = \mu_i \\
\ln(\mu_i) = \eta_i
\]</span></p>
<p>Если в случае биномальной регрессии <em>функция связи</em>, использовавшаяся для линеаризации зависимости между целевой переменной и предикторами была <span class="math inline">\(\mathrm{logit}()\)</span> и требовала много предварительных преобразований, то в данном случае всё проще: функция связи — это [натуральный] логарифм <span class="math inline">\(\ln()\)</span>. Применяя её к нашей переменной, мы получаем величину <span class="math inline">\(\eta_i\)</span>, которую можем моделировать линейной моделью.</p>
<p>Возьмем в качестве предикторов тип фидбека (<code>feedback</code>), наличие/отсутствие объяснения работы алгоритма (<code>explanation</code>) и их взаимодействие (<code>feedback:explanation</code>). Получим такую модель:</p>
<p><span class="math display">\[
\eta_i = b_0 + b_1 I_{\mathrm{feedback}_\mathrm{good}} + b_2 I_{\mathrm{explanation}_\mathrm{yes}} + b_3 I_{\mathrm{feedback}_\mathrm{good}} \cdot I_{\mathrm{explanation}_\mathrm{yes}}
\]</span></p>
<div id="подбор-модели-в-r" class="section level3">
<h3><span class="header-section-number">22.4.1</span> Подбор модели в R</h3>
<p>Зафитим модель в R:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">model1 &lt;-<span class="st"> </span><span class="kw">glm</span>(sus_grade <span class="op">~</span><span class="st"> </span>feedback <span class="op">*</span><span class="st"> </span>explanation, <span class="dt">data =</span> satis,</a>
<a class="sourceLine" id="cb10-2" data-line-number="2">              <span class="dt">family =</span> poisson)</a></code></pre></div>
<p>Как видите, мы используем ту же функцию <code>glm()</code>, что и в случае биномиальной регрессии. Меняется только семество моделей — теперь у нас <code>poisson</code>.</p>
<p>Посмотрим <code>summary()</code> по модели:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw">summary</span>(model1)</a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = sus_grade ~ feedback * explanation, family = poisson, 
##     data = satis)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.5820  -0.6481   0.1610   0.3539   1.7505  
## 
## Coefficients:
##                             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)                   0.8893     0.1170   7.598 3.01e-14 ***
## feedbackgood                  0.3147     0.1539   2.044   0.0409 *  
## explanationyes               -0.1796     0.1735  -1.035   0.3006    
## feedbackgood:explanationyes   0.4264     0.2189   1.948   0.0514 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 183.23  on 119  degrees of freedom
## Residual deviance: 154.02  on 116  degrees of freedom
## AIC: 468.51
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>Можно заметить, что аутпут выглядит совершенно аналогично аутпуту биномиальной регрессии:</p>
<ul>
<li>Отсутствует <span class="math inline">\(R^2\)</span></li>
<li>Отсутствует <span class="math inline">\(F\)</span>-статистика, а значит и p-value для неё</li>
<li>Значимость коэффициентов при предикторах тестируется при помощи z-тестов Вальда</li>
</ul>
<p>В данному случае у нас получился один значимый предиктор — <code>feedbackgood</code>. Это значит, что уровень удовлетворённость пользователей, которые взаиможействовали с интерфейсом, в котором реализован хороший фидбек, отличается от уровня удовлетворенности пользователей, которые взаимодействовали с интерфейсов и плохим фидбеком. То есть данные интерфейсы формируют различный пользовательский опыт. Но насколько различный?</p>
</div>
</div>
<div id="интерпретация-коэффициентов-модели-1" class="section level2">
<h2><span class="header-section-number">22.5</span> Интерпретация коэффициентов модели</h2>
<p>Вспомним, что линейная модель описывает переменную <span class="math inline">\(\eta_i\)</span>, поэтому уравнение модели мы можем записать следующим образом:</p>
<p><span class="math display">\[
\eta_i = 0.89 + 0.31 I_{\mathrm{feedback}_\mathrm{good}}
\]</span></p>
<p>Незначимые предикторы мы в модель включать не будем.</p>
<p>Так как <span class="math inline">\(\eta_i = \ln(\mu_i)\)</span>, то</p>
<ul>
<li>угловой коэффициент <em>при непрерывном предикторе</em> показывает, <em>на сколько единиц изменится значение логарифма зависимой переменной при увеличении значения предиктора на единицу</em></li>
<li>угловой коэффициент <em>при категориальном предикторе</em> показывает, <em>на сколько единиц отличается среднее значение логарифма зависимой переменной для данной категории наблюдений по сравнению в базовым уровнем</em> (его, как обычно, содержит intercept модели)</li>
</ul>
<p>Само же значение зависимой переменной изменяется в <span class="math inline">\(e^{b_j}\)</span> раз.</p>
<p>Таким образом, в нашем случае мы можем сказать, что <code>sus_grade</code> для интерфейса с хорошим фидбеков в среднем в <span class="math inline">\(e^{0.31} = 1.36\)</span> раза выше, чем для интерфейса с плохим фидбеком. Звучит очень логично.</p>
<p>Однако перед интерпретацией предикторов обычно мы проверяли, значима ли модель в целом. Давайте это сделаем, а то как-то не по порядку пошли…</p>
</div>
<div id="анализ-девиансы" class="section level2">
<h2><span class="header-section-number">22.6</span> Анализ девиансы</h2>
<p>В случае пуассоновской модели анализ девиансы не отличается от случая биномиальной регрессии. Нам так же нужна нулевая модель, в которой будет только интерсепт:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">model_null &lt;-<span class="st"> </span><span class="kw">glm</span>(sus_grade <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">data =</span> satis, <span class="dt">family =</span> poisson)</a></code></pre></div>
<p>И функция <code>anova()</code>, которая будет сравнивать нашу модель с нулевой. Используем <code>test = 'Chi'</code>:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw">anova</span>(model1, model_null, <span class="dt">test =</span> <span class="st">&#39;Chi&#39;</span>)</a></code></pre></div>
<pre><code>## Analysis of Deviance Table
## 
## Model 1: sus_grade ~ feedback * explanation
## Model 2: sus_grade ~ 1
##   Resid. Df Resid. Dev Df Deviance  Pr(&gt;Chi)    
## 1       116     154.02                          
## 2       119     183.23 -3  -29.214 2.019e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Наблюдаем, что модель статистически значима. Это очень хорошо.</p>
</div>
<div id="проверка-на-сверхдисперсию-overdispersion" class="section level2">
<h2><span class="header-section-number">22.7</span> Проверка на сверхдисперсию (overdispersion)</h2>
<p>Но не совсем… Пока что мы не можем однозначно доверять данным результатам, так как не проверили одного важного прежположения, которое положили в основу пуассоновской регрессии. А именно — допущение о том, что <span class="math inline">\(\mathbb E(X) = \mathrm{var}(X)\)</span>. В общем случае ведь связь дисперсии и математического ожидания не обязательно описывается функцией идентичности.</p>
<p>Если дисперсия не равна среднему значению, то мы не можем доверять результатам подбора модели.</p>
<p>Чтобы провести проверку на сверхдисперсию, можно воспользоваться <a href="http://bbolker.github.io/mixedmodels-misc/glmmFAQ.html#testing-for-overdispersioncomputing-overdispersion-factor">функцией, которую предложил Ben Bolker</a>:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">overdisp_fun &lt;-<span class="st"> </span><span class="cf">function</span>(model) {</a>
<a class="sourceLine" id="cb16-2" data-line-number="2">  rdf &lt;-<span class="st"> </span><span class="kw">df.residual</span>(model)</a>
<a class="sourceLine" id="cb16-3" data-line-number="3">  <span class="cf">if</span> (<span class="kw">inherits</span>(model, <span class="st">&#39;negbin&#39;</span>))</a>
<a class="sourceLine" id="cb16-4" data-line-number="4">    rdf &lt;-<span class="st"> </span>rdf <span class="op">-</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb16-5" data-line-number="5">  rp &lt;-<span class="st"> </span><span class="kw">residuals</span>(model, <span class="dt">type =</span> <span class="st">&#39;pearson&#39;</span>)</a>
<a class="sourceLine" id="cb16-6" data-line-number="6">  Pearson.chisq &lt;-<span class="st"> </span><span class="kw">sum</span>(rp <span class="op">^</span><span class="st"> </span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb16-7" data-line-number="7">  prat &lt;-<span class="st"> </span>Pearson.chisq <span class="op">/</span><span class="st"> </span>rdf</a>
<a class="sourceLine" id="cb16-8" data-line-number="8">  pval &lt;-</a>
<a class="sourceLine" id="cb16-9" data-line-number="9"><span class="st">    </span><span class="kw">pchisq</span>(Pearson.chisq, <span class="dt">df =</span> rdf, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb16-10" data-line-number="10">  <span class="kw">c</span>(</a>
<a class="sourceLine" id="cb16-11" data-line-number="11">      <span class="dt">chisq =</span> Pearson.chisq,</a>
<a class="sourceLine" id="cb16-12" data-line-number="12">      <span class="dt">ratio =</span> prat,</a>
<a class="sourceLine" id="cb16-13" data-line-number="13">      <span class="dt">rdf =</span> rdf,</a>
<a class="sourceLine" id="cb16-14" data-line-number="14">      <span class="dt">p =</span> pval</a>
<a class="sourceLine" id="cb16-15" data-line-number="15">    )</a>
<a class="sourceLine" id="cb16-16" data-line-number="16">}</a></code></pre></div>
<p>Проверим модель на сверхдисперсию:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="kw">overdisp_fun</span>(model1)</a></code></pre></div>
<pre><code>##       chisq       ratio         rdf           p 
## 109.6350957   0.9451301 116.0000000   0.6486891</code></pre>
<p>Данная функция рассчитывает статистику <span class="math inline">\(\chi^2\)</span> (<code>chisq</code>), по которой определяет отношение дисперсии к среднему значению (<code>ratio</code>), и рассчитывает p-value. Так как пуассоновская модель исходит из предположения равенства дисперсии и математического ожидания, то значение <code>ratio</code> должно быть близко к единице. В данном случае мы это и имеем: дисперсия в 0.94 раза превышает математическое ожидание, то есть на самом деле, даже немного ниже математического ожидания. P-value говорит нам о том, что сверхдисперсии нет — мы можем доверять результатам нашей модели.</p>
<p>А если бы сверхдисперсия всё же была? Чем это плохо?</p>
<p>Для распределения Пуассона у нас есть следующие уравнения:</p>
<p><span class="math display">\[
\mathrm{var}(y_i) = \mu_i \\
\mathrm{var}(\mathbb E(y_i)) = \frac{\mu_i}{n} \\
\mathrm{SE}_{\mathbb E(y_i)} = \sqrt{\mathrm{var}(\mathbb E(y_i))}
\]</span></p>
<p>Если обнаружена сверхдисперсия, то данные не подчиняются распределению Пуассона, и дисперсия в <span class="math inline">\(\varphi\)</span> раз больше среднего (<span class="math inline">\(\varphi &gt; 1\)</span>). Тогда,</p>
<p><span class="math display">\[
\mathrm{var}(y_i) = \varphi \mu_i \\
\mathrm{var}(\mathbb E(y_i)) = \frac{\varphi \mu_i}{n} \\
\mathrm{SE}_{\mathbb E(y_i)} = \sqrt{\varphi \mathrm{var}(\mathbb E(y_i))}
\]</span></p>
<p>А так как пуассоновская модель не знает, что там есть какое-то <span class="math inline">\(\varphi\)</span>, то:</p>
<ul>
<li>доверительная зона предсказаний модели будет заужена из-за того, что оценки стандартных ошибок занижены;</li>
<li>тесты Вальда для коэффициентов модели дадут неправильные результаты из-за того, что оценки стандартных ошибок занижены. Уровень значимости будет занижен;</li>
<li>тесты, основанные на сравнении правдоподобий, дадут смещенные результаты, т.к. соотношение девианс уже не будет подчиняться <span class="math inline">\(\chi^2\)</span>-распределению.</li>
</ul>
<p>Каковы могут быть причины сверхдисперсии? Перечислим основные:</p>
<ul>
<li>в данных есть выбросы</li>
<li>в модель не включен важный предиктор или взаимодействие предикторов</li>
<li>нарушена независимость выборок (есть внутригрупповые корреляции)</li>
<li>выбрана неподходящая функция связи</li>
<li>выбрана неподходящая функция распределения для целевой переменной</li>
</ul>
<p>А что же делать? Пусти есть разные. Мы рассмотрим наболее простой.</p>
</div>
<div id="квазипуассоновские-модели" class="section level2">
<h2><span class="header-section-number">22.8</span> Квазипуассоновские модели</h2>
<p>Первое, что надо запомнить — <strong>«квази-пуассоновсного» распределения не бывает!</strong> Эти модели также основываются на распределении Пуассона, но учитывают тот самый коэффициент <span class="math inline">\(\varphi\)</span>, описывающий сверхдисперсию — поправка на избыточность дисперсии.</p>
<p>Записать квазипуассоновскую модель можно следующим образом:</p>
<p><span class="math display">\[
y_i \thicksim \mathrm{QuasiPoisson}(\mu_i) \\
\mathbb{E}(y_i) = \mu_i \\
\mathrm{var}(y_i) = \varphi \mu_i \\
\ln(\mu_i) = \eta_i
\]</span></p>
<p><span class="math inline">\(\varphi\)</span> оценивается по имеющимся данным. Само же уравнение модели совершенно не изменится:</p>
<p><span class="math display">\[
\eta_i = b_0 + b_1 I_{\mathrm{feedback}_\mathrm{good}} + b_2 I_{\mathrm{explanation}_\mathrm{yes}} + b_3 I_{\mathrm{feedback}_\mathrm{good}} \cdot I_{\mathrm{explanation}_\mathrm{yes}}
\]</span></p>
<div id="квазипуассоновские-модели-в-r" class="section level3">
<h3><span class="header-section-number">22.8.1</span> Квазипуассоновские модели в R</h3>
<p>Хотя мы не обнаружили избыточность дисперсии при диагностике модели, давайте построим квазипуассоновскую модель и посмотрим на её отличия от пуассоновской регрессии.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">model2 &lt;-<span class="st"> </span><span class="kw">glm</span>(sus_grade <span class="op">~</span><span class="st"> </span>feedback <span class="op">*</span><span class="st"> </span>explanation, <span class="dt">data =</span> satis,</a>
<a class="sourceLine" id="cb19-2" data-line-number="2">              <span class="dt">family =</span> <span class="st">&quot;quasipoisson&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="kw">summary</span>(model2)</a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = sus_grade ~ feedback * explanation, family = &quot;quasipoisson&quot;, 
##     data = satis)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.5820  -0.6481   0.1610   0.3539   1.7505  
## 
## Coefficients:
##                             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                   0.8893     0.1138   7.815 2.74e-12 ***
## feedbackgood                  0.3147     0.1497   2.103   0.0376 *  
## explanationyes               -0.1796     0.1686  -1.065   0.2891    
## feedbackgood:explanationyes   0.4264     0.2128   2.004   0.0474 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for quasipoisson family taken to be 0.9451325)
## 
##     Null deviance: 183.23  on 119  degrees of freedom
## Residual deviance: 154.02  on 116  degrees of freedom
## AIC: NA
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>Взглянем на аутпут. У нас, ожидаемо, изменились результаты тестирования статистической значимости коэффициентов, хотя сами коэффициенты остались теми же самыми. Почему?</p>
<p>Да, <em>оценки параметром модели</em> в квазипуассоновских и пуассоновских моделях <em>получаются одинаковыми</em>, однако</p>
<ul>
<li>стандартные ошибки коэффициентов домножатся на <span class="math inline">\(\sqrt{\varphi}\)</span>;</li>
<li>доверительные интервалы коэффициентов домножаются на <span class="math inline">\(\sqrt{\varphi}\)</span>;</li>
<li>логарифмы правдоподобий, используемые для тестирования статистической значимости моделей, уменьшаются в <span class="math inline">\(\varphi\)</span> раз.</li>
</ul>
<p>А так как тестирование статистической значимости работает со стандартными ошибками, то и статистическая значимость также изменяется.</p>
</div>
</div>
<div id="особенности-работы-с-квазипуассоновскими-моделями" class="section level2">
<h2><span class="header-section-number">22.9</span> Особенности работы с квазипуассоновскими моделями</h2>
<p>Кроме того, если ряд других отличий. Одно из них можно обнаружить в аутпуте функции <code>summary()</code>: <em>в тестах параметров используются t-тесты и, соответственно, t-распределение</em> в отличие от других GLM, где используются z-тесты Вальда и стандарнтное нормальное распределение.</p>
<p><em>Для анализа девиансы используются F-тесты</em>, а не <span class="math inline">\(\chi^2\)</span>:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">model_null2 &lt;-<span class="st"> </span><span class="kw">glm</span>(sus_grade <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">data =</span> satis, <span class="dt">family =</span> <span class="st">&quot;quasipoisson&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="kw">anova</span>(model2, model_null2, <span class="dt">test =</span> <span class="st">&#39;F&#39;</span>)</a></code></pre></div>
<pre><code>## Analysis of Deviance Table
## 
## Model 1: sus_grade ~ feedback * explanation
## Model 2: sus_grade ~ 1
##   Resid. Df Resid. Dev Df Deviance      F    Pr(&gt;F)    
## 1       116     154.02                                 
## 2       119     183.23 -3  -29.214 10.303 4.584e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>А также для квазипуассоновских моделей не определена функция максимального правдоподобия, поэтому <em>нельзя вычислить AIC</em>.</p>
<blockquote>
<p>В завершении стоит отметить, что пуассоновские модели — это история, скорее, для исследователей. В индустрии даже на счетных данных чаще всего используют обычные линейные модели, хотя это и не то чтобы суперкорректно.</p>
</blockquote>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>Не считая, конечно, биномиальную регрессию.<a href="poisson.html#fnref1" class="footnote-back">↩</a></p></li>
<li id="fn2"><p>В отличие от нормального распределения, которое задается двумя параметрами <span class="math inline">\(X \thicksim \mathcal{N}(\mu, \sigma^2)\)</span><a href="poisson.html#fnref2" class="footnote-back">↩</a></p></li>
<li id="fn3"><p>С этой функцией вы хорошо знакомы — это самая простая линейная функция вида <span class="math inline">\(y = x\)</span>.<a href="poisson.html#fnref3" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="logistic.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="regularization.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["wlm2021-book.pdf", "wlm2021-book.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>

<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>16 Корреляционный анализ | HSE UX LAB | Анализ данных + R: мир линейных моделей | Book</title>
  <meta name="description" content="Книга написана для слушателей курса по анализу данных от HSE UX LAB" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="16 Корреляционный анализ | HSE UX LAB | Анализ данных + R: мир линейных моделей | Book" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Книга написана для слушателей курса по анализу данных от HSE UX LAB" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="16 Корреляционный анализ | HSE UX LAB | Анализ данных + R: мир линейных моделей | Book" />
  
  <meta name="twitter:description" content="Книга написана для слушателей курса по анализу данных от HSE UX LAB" />
  

<meta name="author" content="А. Ангельгардт" />


<meta name="date" content="2021-01-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="descriptives.html"/>
<link rel="next" href="simple-linear.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="">HSE UX LAB | WLM 2021</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#благодарности"><i class="fa fa-check"></i>Благодарности</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#условные-обозначения"><i class="fa fa-check"></i>Условные обозначения</a></li>
</ul></li>
<li class="part"><span><b>I R programming</b></span></li>
<li class="chapter" data-level="1" data-path="Rintro.html"><a href="Rintro.html"><i class="fa fa-check"></i><b>1</b> Знакомство с R и RStudio</a><ul>
<li class="chapter" data-level="1.1" data-path="Rintro.html"><a href="Rintro.html#что-это-и-откуда"><i class="fa fa-check"></i><b>1.1</b> Что это и откуда?</a></li>
<li class="chapter" data-level="1.2" data-path="Rintro.html"><a href="Rintro.html#whyr"><i class="fa fa-check"></i><b>1.2</b> Почему R?</a><ul>
<li class="chapter" data-level="1.2.1" data-path="Rintro.html"><a href="Rintro.html#а-он-лучше-питона"><i class="fa fa-check"></i><b>1.2.1</b> А он лучше Питона?</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="Rintro.html"><a href="Rintro.html#установка-r-и-rstudio"><i class="fa fa-check"></i><b>1.3</b> Установка R и RStudio</a><ul>
<li class="chapter" data-level="1.3.1" data-path="Rintro.html"><a href="Rintro.html#а-зачем-обе-штуки-ставить"><i class="fa fa-check"></i><b>1.3.1</b> А зачем обе штуки ставить?</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="Rintro.html"><a href="Rintro.html#где-спросить-вопрос-или-искать-ответ"><i class="fa fa-check"></i><b>1.4</b> Где спросить вопрос или искать ответ?</a></li>
<li class="chapter" data-level="1.5" data-path="Rintro.html"><a href="Rintro.html#интерфейс-r"><i class="fa fa-check"></i><b>1.5</b> Интерфейс R</a></li>
<li class="chapter" data-level="1.6" data-path="Rintro.html"><a href="Rintro.html#интерфейс-rstudio"><i class="fa fa-check"></i><b>1.6</b> Интерфейс RStudio</a><ul>
<li class="chapter" data-level="1.6.1" data-path="Rintro.html"><a href="Rintro.html#console"><i class="fa fa-check"></i><b>1.6.1</b> Console</a></li>
<li class="chapter" data-level="1.6.2" data-path="Rintro.html"><a href="Rintro.html#code-editor"><i class="fa fa-check"></i><b>1.6.2</b> Code Editor</a></li>
<li class="chapter" data-level="1.6.3" data-path="Rintro.html"><a href="Rintro.html#environment-workspace-и-history"><i class="fa fa-check"></i><b>1.6.3</b> Environment (Workspace) и History</a></li>
<li class="chapter" data-level="1.6.4" data-path="Rintro.html"><a href="Rintro.html#plots-files-packages-help-viewer"><i class="fa fa-check"></i><b>1.6.4</b> Plots, Files, Packages, Help, Viewer</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="Rintro.html"><a href="Rintro.html#r-как-калькулятор"><i class="fa fa-check"></i><b>1.7</b> R как калькулятор</a><ul>
<li class="chapter" data-level="1.7.1" data-path="Rintro.html"><a href="Rintro.html#арифметические-операции"><i class="fa fa-check"></i><b>1.7.1</b> Арифметические операции</a></li>
<li class="chapter" data-level="1.7.2" data-path="Rintro.html"><a href="Rintro.html#funcs"><i class="fa fa-check"></i><b>1.7.2</b> Функции</a></li>
<li class="chapter" data-level="1.7.3" data-path="Rintro.html"><a href="Rintro.html#сравнение-и-логические-операции"><i class="fa fa-check"></i><b>1.7.3</b> Сравнение и логические операции</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="Rintro.html"><a href="Rintro.html#assignment-и-переменные"><i class="fa fa-check"></i><b>1.8</b> Assignment и переменные</a></li>
<li class="chapter" data-level="1.9" data-path="Rintro.html"><a href="Rintro.html#wd"><i class="fa fa-check"></i><b>1.9</b> Рабочая директория. Projects</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="datatypes.html"><a href="datatypes.html"><i class="fa fa-check"></i><b>2</b> Типы данных</a><ul>
<li class="chapter" data-level="2.1" data-path="datatypes.html"><a href="datatypes.html#numeric"><i class="fa fa-check"></i><b>2.1</b> <code>numeric</code></a></li>
<li class="chapter" data-level="2.2" data-path="datatypes.html"><a href="datatypes.html#logical"><i class="fa fa-check"></i><b>2.2</b> <code>logical</code></a></li>
<li class="chapter" data-level="2.3" data-path="datatypes.html"><a href="datatypes.html#character"><i class="fa fa-check"></i><b>2.3</b> <code>character</code></a></li>
<li class="chapter" data-level="2.4" data-path="datatypes.html"><a href="datatypes.html#factors"><i class="fa fa-check"></i><b>2.4</b> <code>factor</code></a></li>
<li class="chapter" data-level="2.5" data-path="datatypes.html"><a href="datatypes.html#coercion-part-one"><i class="fa fa-check"></i><b>2.5</b> Coercion [part one]</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="datastructures.html"><a href="datastructures.html"><i class="fa fa-check"></i><b>3</b> Структуры данных</a><ul>
<li class="chapter" data-level="3.1" data-path="datastructures.html"><a href="datastructures.html#векторы"><i class="fa fa-check"></i><b>3.1</b> Векторы</a><ul>
<li class="chapter" data-level="3.1.1" data-path="datastructures.html"><a href="datastructures.html#coercion-part-two"><i class="fa fa-check"></i><b>3.1.1</b> Coercion [part two]</a></li>
<li class="chapter" data-level="3.1.2" data-path="datastructures.html"><a href="datastructures.html#генерация-числовых-последовательностей"><i class="fa fa-check"></i><b>3.1.2</b> Генерация числовых последовательностей</a></li>
<li class="chapter" data-level="3.1.3" data-path="datastructures.html"><a href="datastructures.html#операции-с-векторами"><i class="fa fa-check"></i><b>3.1.3</b> Операции с векторами</a></li>
<li class="chapter" data-level="3.1.4" data-path="datastructures.html"><a href="datastructures.html#recycling"><i class="fa fa-check"></i><b>3.1.4</b> Recycling</a></li>
<li class="chapter" data-level="3.1.5" data-path="datastructures.html"><a href="datastructures.html#индексация-векторов"><i class="fa fa-check"></i><b>3.1.5</b> Индексация векторов</a></li>
<li class="chapter" data-level="3.1.6" data-path="datastructures.html"><a href="datastructures.html#na-nan-null"><i class="fa fa-check"></i><b>3.1.6</b> NA, NaN, NULL</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="datastructures.html"><a href="datastructures.html#матрицы"><i class="fa fa-check"></i><b>3.2</b> Матрицы</a><ul>
<li class="chapter" data-level="3.2.1" data-path="datastructures.html"><a href="datastructures.html#индексация-матриц"><i class="fa fa-check"></i><b>3.2.1</b> Индексация матриц</a></li>
<li class="chapter" data-level="3.2.2" data-path="datastructures.html"><a href="datastructures.html#операции-в-матрицами"><i class="fa fa-check"></i><b>3.2.2</b> Операции в матрицами</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="datastructures.html"><a href="datastructures.html#списки"><i class="fa fa-check"></i><b>3.3</b> Списки</a><ul>
<li class="chapter" data-level="3.3.1" data-path="datastructures.html"><a href="datastructures.html#индексация-списков"><i class="fa fa-check"></i><b>3.3.1</b> Индексация списков</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="datastructures.html"><a href="datastructures.html#датафреймы"><i class="fa fa-check"></i><b>3.4</b> Датафреймы</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>4</b> Функции</a><ul>
<li class="chapter" data-level="4.1" data-path="functions.html"><a href="functions.html#открытый-исходный-код"><i class="fa fa-check"></i><b>4.1</b> Открытый исходный код</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="strings.html"><a href="strings.html"><i class="fa fa-check"></i><b>5</b> Строки</a><ul>
<li class="chapter" data-level="5.1" data-path="strings.html"><a href="strings.html#установка-дополнительных-пакетов"><i class="fa fa-check"></i><b>5.1</b> Установка дополнительных пакетов</a></li>
<li class="chapter" data-level="5.2" data-path="strings.html"><a href="strings.html#создание-строк"><i class="fa fa-check"></i><b>5.2</b> Создание строк</a></li>
<li class="chapter" data-level="5.3" data-path="strings.html"><a href="strings.html#конкатенация-строк"><i class="fa fa-check"></i><b>5.3</b> Конкатенация строк</a></li>
<li class="chapter" data-level="5.4" data-path="strings.html"><a href="strings.html#разделение-строк"><i class="fa fa-check"></i><b>5.4</b> Разделение строк</a></li>
<li class="chapter" data-level="5.5" data-path="strings.html"><a href="strings.html#сортировка-строк"><i class="fa fa-check"></i><b>5.5</b> Сортировка строк</a></li>
<li class="chapter" data-level="5.6" data-path="strings.html"><a href="strings.html#изменение-регистра"><i class="fa fa-check"></i><b>5.6</b> Изменение регистра</a></li>
<li class="chapter" data-level="5.7" data-path="strings.html"><a href="strings.html#поиск-подстроки"><i class="fa fa-check"></i><b>5.7</b> Поиск подстроки</a></li>
<li class="chapter" data-level="5.8" data-path="strings.html"><a href="strings.html#изменение-строк"><i class="fa fa-check"></i><b>5.8</b> Изменение строк</a><ul>
<li class="chapter" data-level="5.8.1" data-path="strings.html"><a href="strings.html#выделение-подстроки"><i class="fa fa-check"></i><b>5.8.1</b> Выделение подстроки</a></li>
<li class="chapter" data-level="5.8.2" data-path="strings.html"><a href="strings.html#замена-подстроки"><i class="fa fa-check"></i><b>5.8.2</b> Замена подстроки</a></li>
<li class="chapter" data-level="5.8.3" data-path="strings.html"><a href="strings.html#удаление-подстроки"><i class="fa fa-check"></i><b>5.8.3</b> Удаление подстроки</a></li>
<li class="chapter" data-level="5.8.4" data-path="strings.html"><a href="strings.html#транслитерация-строк"><i class="fa fa-check"></i><b>5.8.4</b> Транслитерация строк</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="strings.html"><a href="strings.html#регулярные-выражения"><i class="fa fa-check"></i><b>5.9</b> Регулярные выражения</a><ul>
<li class="chapter" data-level="5.9.1" data-path="strings.html"><a href="strings.html#метасимволы"><i class="fa fa-check"></i><b>5.9.1</b> Метасимволы</a></li>
<li class="chapter" data-level="5.9.2" data-path="strings.html"><a href="strings.html#классы-знаков"><i class="fa fa-check"></i><b>5.9.2</b> Классы знаков</a></li>
<li class="chapter" data-level="5.9.3" data-path="strings.html"><a href="strings.html#quant"><i class="fa fa-check"></i><b>5.9.3</b> Квантификация</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="realdata.html"><a href="realdata.html"><i class="fa fa-check"></i><b>6</b> Работа с реальными данными</a><ul>
<li class="chapter" data-level="6.1" data-path="realdata.html"><a href="realdata.html#рабочая-директория"><i class="fa fa-check"></i><b>6.1</b> Рабочая директория</a></li>
<li class="chapter" data-level="6.2" data-path="realdata.html"><a href="realdata.html#импорт-данных"><i class="fa fa-check"></i><b>6.2</b> Импорт данных</a><ul>
<li class="chapter" data-level="6.2.1" data-path="realdata.html"><a href="realdata.html#форматы-данных"><i class="fa fa-check"></i><b>6.2.1</b> Форматы данных</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="realdata.html"><a href="realdata.html#исследование-данных"><i class="fa fa-check"></i><b>6.3</b> Исследование данных</a></li>
<li class="chapter" data-level="6.4" data-path="realdata.html"><a href="realdata.html#файл-.rdata"><i class="fa fa-check"></i><b>6.4</b> Файл <code>.RData</code></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="tidy.html"><a href="tidy.html"><i class="fa fa-check"></i><b>7</b> Предобработка данных. Концепция tidy data</a><ul>
<li class="chapter" data-level="7.1" data-path="tidy.html"><a href="tidy.html#tidyverse"><i class="fa fa-check"></i><b>7.1</b> <code>tidyverse</code></a></li>
<li class="chapter" data-level="7.2" data-path="tidy.html"><a href="tidy.html#импорт-данных-1"><i class="fa fa-check"></i><b>7.2</b> Импорт данных</a></li>
<li class="chapter" data-level="7.3" data-path="tidy.html"><a href="tidy.html#tibble"><i class="fa fa-check"></i><b>7.3</b> <code>tibble</code></a></li>
<li class="chapter" data-level="7.4" data-path="tidy.html"><a href="tidy.html#грузим-много-данных"><i class="fa fa-check"></i><b>7.4</b> Грузим много данных</a></li>
<li class="chapter" data-level="7.5" data-path="tidy.html"><a href="tidy.html#сабсет-данных"><i class="fa fa-check"></i><b>7.5</b> Сабсет данных</a><ul>
<li class="chapter" data-level="7.5.1" data-path="tidy.html"><a href="tidy.html#pipe"><i class="fa fa-check"></i><b>7.5.1</b> <code>%&gt;%</code></a></li>
<li class="chapter" data-level="7.5.2" data-path="tidy.html"><a href="tidy.html#select"><i class="fa fa-check"></i><b>7.5.2</b> <code>select()</code></a></li>
<li class="chapter" data-level="7.5.3" data-path="tidy.html"><a href="tidy.html#rename"><i class="fa fa-check"></i><b>7.5.3</b> <code>rename()</code></a></li>
<li class="chapter" data-level="7.5.4" data-path="tidy.html"><a href="tidy.html#slice"><i class="fa fa-check"></i><b>7.5.4</b> <code>slice()</code></a></li>
<li class="chapter" data-level="7.5.5" data-path="tidy.html"><a href="tidy.html#filter"><i class="fa fa-check"></i><b>7.5.5</b> <code>filter()</code></a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="tidy.html"><a href="tidy.html#mutate"><i class="fa fa-check"></i><b>7.6</b> <code>mutate()</code></a></li>
<li class="chapter" data-level="7.7" data-path="tidy.html"><a href="tidy.html#догрузим-остальные-данные"><i class="fa fa-check"></i><b>7.7</b> Догрузим остальные данные</a><ul>
<li class="chapter" data-level="7.7.1" data-path="tidy.html"><a href="tidy.html#соединение-датафреймов-i"><i class="fa fa-check"></i><b>7.7.1</b> Соединение датафреймов I</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="tidy.html"><a href="tidy.html#сортировка"><i class="fa fa-check"></i><b>7.8</b> Сортировка</a><ul>
<li class="chapter" data-level="7.8.1" data-path="tidy.html"><a href="tidy.html#sort"><i class="fa fa-check"></i><b>7.8.1</b> <code>sort()</code></a></li>
<li class="chapter" data-level="7.8.2" data-path="tidy.html"><a href="tidy.html#arrange"><i class="fa fa-check"></i><b>7.8.2</b> <code>arrange()</code></a></li>
<li class="chapter" data-level="7.8.3" data-path="tidy.html"><a href="tidy.html#distinct"><i class="fa fa-check"></i><b>7.8.3</b> <code>distinct()</code></a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="tidy.html"><a href="tidy.html#соединение-датафреймов-ii"><i class="fa fa-check"></i><b>7.9</b> Соединение датафреймов II</a><ul>
<li class="chapter" data-level="7.9.1" data-path="tidy.html"><a href="tidy.html#join"><i class="fa fa-check"></i><b>7.9.1</b> <code>..._join()</code></a></li>
</ul></li>
<li class="chapter" data-level="7.10" data-path="tidy.html"><a href="tidy.html#группировка-и-аггрегация-данных"><i class="fa fa-check"></i><b>7.10</b> Группировка и аггрегация данных</a><ul>
<li class="chapter" data-level="7.10.1" data-path="tidy.html"><a href="tidy.html#group_by-ungroup"><i class="fa fa-check"></i><b>7.10.1</b> <code>group_by()</code> &amp; <code>ungroup()</code></a></li>
<li class="chapter" data-level="7.10.2" data-path="tidy.html"><a href="tidy.html#summarize"><i class="fa fa-check"></i><b>7.10.2</b> <code>summarize()</code></a></li>
</ul></li>
<li class="chapter" data-level="7.11" data-path="tidy.html"><a href="tidy.html#широкий-и-длинный-формат"><i class="fa fa-check"></i><b>7.11</b> Широкий и длинный формат</a><ul>
<li class="chapter" data-level="7.11.1" data-path="tidy.html"><a href="tidy.html#pivot_longer-pivot_wider"><i class="fa fa-check"></i><b>7.11.1</b> <code>pivot_longer()</code> &amp; <code>pivot_wider()</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="visualization.html"><a href="visualization.html"><i class="fa fa-check"></i><b>8</b> Визуализация данных</a><ul>
<li class="chapter" data-level="8.1" data-path="visualization.html"><a href="visualization.html#философия-ggplot2-a-layered-grammar-of-graphics"><i class="fa fa-check"></i><b>8.1</b> Философия ggplot2 (A Layered Grammar of Graphics)</a><ul>
<li class="chapter" data-level="8.1.1" data-path="visualization.html"><a href="visualization.html#собственно-к-философии-построения-графиков"><i class="fa fa-check"></i><b>8.1.1</b> Собственно к философии построения графиков</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="visualization.html"><a href="visualization.html#данные"><i class="fa fa-check"></i><b>8.2</b> Данные</a></li>
<li class="chapter" data-level="8.3" data-path="visualization.html"><a href="visualization.html#строим-базовый-график"><i class="fa fa-check"></i><b>8.3</b> Строим базовый график</a><ul>
<li class="chapter" data-level="8.3.1" data-path="visualization.html"><a href="visualization.html#базовый-слой"><i class="fa fa-check"></i><b>8.3.1</b> Базовый слой</a></li>
<li class="chapter" data-level="8.3.2" data-path="visualization.html"><a href="visualization.html#разметка-осей-и-переменные"><i class="fa fa-check"></i><b>8.3.2</b> Разметка осей и переменные</a></li>
<li class="chapter" data-level="8.3.3" data-path="visualization.html"><a href="visualization.html#геомы"><i class="fa fa-check"></i><b>8.3.3</b> Геомы</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="visualization.html"><a href="visualization.html#группировка-по-переменной"><i class="fa fa-check"></i><b>8.4</b> Группировка по переменной</a></li>
<li class="chapter" data-level="8.5" data-path="visualization.html"><a href="visualization.html#графики-со-встроенной-статистической-обработкой"><i class="fa fa-check"></i><b>8.5</b> Графики со встроенной статистической обработкой</a><ul>
<li class="chapter" data-level="8.5.1" data-path="visualization.html"><a href="visualization.html#статы-stat_"><i class="fa fa-check"></i><b>8.5.1</b> Статы (stat_)</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="visualization.html"><a href="visualization.html#ищем-более-сложные-закономерности"><i class="fa fa-check"></i><b>8.6</b> Ищем более сложные закономерности</a></li>
<li class="chapter" data-level="8.7" data-path="visualization.html"><a href="visualization.html#настраиваем-график"><i class="fa fa-check"></i><b>8.7</b> Настраиваем график</a><ul>
<li class="chapter" data-level="8.7.1" data-path="visualization.html"><a href="visualization.html#темы"><i class="fa fa-check"></i><b>8.7.1</b> Темы</a></li>
<li class="chapter" data-level="8.7.2" data-path="visualization.html"><a href="visualization.html#кастомизация-шкал-scale_"><i class="fa fa-check"></i><b>8.7.2</b> Кастомизация шкал (scale_)</a></li>
<li class="chapter" data-level="8.7.3" data-path="visualization.html"><a href="visualization.html#последние-штрихи"><i class="fa fa-check"></i><b>8.7.3</b> Последние штрихи</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="visualization.html"><a href="visualization.html#больше-переменных"><i class="fa fa-check"></i><b>8.8</b> Больше переменных</a><ul>
<li class="chapter" data-level="8.8.1" data-path="visualization.html"><a href="visualization.html#фасетизация"><i class="fa fa-check"></i><b>8.8.1</b> Фасетизация</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="visualization.html"><a href="visualization.html#сохранение-графиков"><i class="fa fa-check"></i><b>8.9</b> Сохранение графиков</a></li>
<li class="chapter" data-level="8.10" data-path="visualization.html"><a href="visualization.html#другие-геомы"><i class="fa fa-check"></i><b>8.10</b> Другие геомы</a></li>
</ul></li>
<li class="part"><span><b>II Теория вероятностей и математическая статистика</b></span></li>
<li class="chapter" data-level="9" data-path="maths.html"><a href="maths.html"><i class="fa fa-check"></i><b>9</b> Математический ликбез</a><ul>
<li class="chapter" data-level="9.1" data-path="maths.html"><a href="maths.html#alg_logic"><i class="fa fa-check"></i><b>9.1</b> Элементы алгебры логики</a><ul>
<li class="chapter" data-level="9.1.1" data-path="maths.html"><a href="maths.html#высказывания"><i class="fa fa-check"></i><b>9.1.1</b> Высказывания</a></li>
<li class="chapter" data-level="9.1.2" data-path="maths.html"><a href="maths.html#logic_operations"><i class="fa fa-check"></i><b>9.1.2</b> Логические операции</a></li>
<li class="chapter" data-level="9.1.3" data-path="maths.html"><a href="maths.html#сложные-высказвания"><i class="fa fa-check"></i><b>9.1.3</b> Сложные высказвания</a></li>
<li class="chapter" data-level="9.1.4" data-path="maths.html"><a href="maths.html#условные-высказывания"><i class="fa fa-check"></i><b>9.1.4</b> Условные высказывания</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="maths.html"><a href="maths.html#set_theory"><i class="fa fa-check"></i><b>9.2</b> Элементы теории множеств</a><ul>
<li class="chapter" data-level="9.2.1" data-path="maths.html"><a href="maths.html#set"><i class="fa fa-check"></i><b>9.2.1</b> Множество</a></li>
<li class="chapter" data-level="9.2.2" data-path="maths.html"><a href="maths.html#sets_operations"><i class="fa fa-check"></i><b>9.2.2</b> Операции над множествами</a></li>
<li class="chapter" data-level="9.2.3" data-path="maths.html"><a href="maths.html#отображения"><i class="fa fa-check"></i><b>9.2.3</b> Отображения</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="maths.html"><a href="maths.html#combinatorics"><i class="fa fa-check"></i><b>9.3</b> Немного комбинаторики</a><ul>
<li class="chapter" data-level="9.3.1" data-path="maths.html"><a href="maths.html#permutations"><i class="fa fa-check"></i><b>9.3.1</b> Перестановки</a></li>
<li class="chapter" data-level="9.3.2" data-path="maths.html"><a href="maths.html#accomodations"><i class="fa fa-check"></i><b>9.3.2</b> Размещения</a></li>
<li class="chapter" data-level="9.3.3" data-path="maths.html"><a href="maths.html#combinations"><i class="fa fa-check"></i><b>9.3.3</b> Сочетания</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="maths.html"><a href="maths.html#calculus"><i class="fa fa-check"></i><b>9.4</b> Элементы математического анализа</a><ul>
<li class="chapter" data-level="9.4.1" data-path="maths.html"><a href="maths.html#последовательность"><i class="fa fa-check"></i><b>9.4.1</b> Последовательность</a></li>
<li class="chapter" data-level="9.4.2" data-path="maths.html"><a href="maths.html#предел-последовательности"><i class="fa fa-check"></i><b>9.4.2</b> Предел последовательности</a></li>
<li class="chapter" data-level="9.4.3" data-path="maths.html"><a href="maths.html#функции"><i class="fa fa-check"></i><b>9.4.3</b> Функции</a></li>
<li class="chapter" data-level="9.4.4" data-path="maths.html"><a href="maths.html#дифференцируемость-функции.-производная"><i class="fa fa-check"></i><b>9.4.4</b> Дифференцируемость функции. Производная</a></li>
<li class="chapter" data-level="9.4.5" data-path="maths.html"><a href="maths.html#функции-нескольких-переменных"><i class="fa fa-check"></i><b>9.4.5</b> Функции нескольких переменных</a></li>
<li class="chapter" data-level="9.4.6" data-path="maths.html"><a href="maths.html#частные-производные"><i class="fa fa-check"></i><b>9.4.6</b> Частные производные</a></li>
<li class="chapter" data-level="9.4.7" data-path="maths.html"><a href="maths.html#интеграл"><i class="fa fa-check"></i><b>9.4.7</b> Интеграл</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="maths.html"><a href="maths.html#matrix"><i class="fa fa-check"></i><b>9.5</b> Элементы линейной алгебры</a><ul>
<li class="chapter" data-level="9.5.1" data-path="maths.html"><a href="maths.html#что-такое-матрица"><i class="fa fa-check"></i><b>9.5.1</b> Что такое матрица?</a></li>
<li class="chapter" data-level="9.5.2" data-path="maths.html"><a href="maths.html#откуда-берутся-матрицы"><i class="fa fa-check"></i><b>9.5.2</b> Откуда берутся матрицы?</a></li>
<li class="chapter" data-level="9.5.3" data-path="maths.html"><a href="maths.html#действия-с-матрицами"><i class="fa fa-check"></i><b>9.5.3</b> Действия с матрицами</a></li>
<li class="chapter" data-level="9.5.4" data-path="maths.html"><a href="maths.html#скалярное-произведение-векторов"><i class="fa fa-check"></i><b>9.5.4</b> Скалярное произведение векторов</a></li>
<li class="chapter" data-level="9.5.5" data-path="maths.html"><a href="maths.html#векторное-произведение-векторов"><i class="fa fa-check"></i><b>9.5.5</b> Векторное произведение векторов</a></li>
<li class="chapter" data-level="9.5.6" data-path="maths.html"><a href="maths.html#произведение-матриц-матричное-умножение"><i class="fa fa-check"></i><b>9.5.6</b> Произведение матриц (матричное умножение)</a></li>
<li class="chapter" data-level="9.5.7" data-path="maths.html"><a href="maths.html#транспонирование-матрицы"><i class="fa fa-check"></i><b>9.5.7</b> Транспонирование матрицы</a></li>
<li class="chapter" data-level="9.5.8" data-path="maths.html"><a href="maths.html#детерминант-и-обратная-матрица"><i class="fa fa-check"></i><b>9.5.8</b> Детерминант и обратная матрица</a></li>
<li class="chapter" data-level="9.5.9" data-path="maths.html"><a href="maths.html#след-матрицы"><i class="fa fa-check"></i><b>9.5.9</b> След матрицы</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="stats-intro.html"><a href="stats-intro.html"><i class="fa fa-check"></i><b>10</b> Введение в статистику</a><ul>
<li class="chapter" data-level="10.1" data-path="stats-intro.html"><a href="stats-intro.html#исходные-понятия-статистики"><i class="fa fa-check"></i><b>10.1</b> Исходные понятия статистики</a></li>
<li class="chapter" data-level="10.2" data-path="stats-intro.html"><a href="stats-intro.html#виды-статистических-данных"><i class="fa fa-check"></i><b>10.2</b> Виды статистических данных</a></li>
<li class="chapter" data-level="10.3" data-path="stats-intro.html"><a href="stats-intro.html#шкалы"><i class="fa fa-check"></i><b>10.3</b> Шкалы</a></li>
<li class="chapter" data-level="10.4" data-path="stats-intro.html"><a href="stats-intro.html#задачи-статистики"><i class="fa fa-check"></i><b>10.4</b> Задачи статистики</a><ul>
<li class="chapter" data-level="10.4.1" data-path="stats-intro.html"><a href="stats-intro.html#этапы-статистического-моделирования"><i class="fa fa-check"></i><b>10.4.1</b> Этапы статистического моделирования</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="randexp.html"><a href="randexp.html"><i class="fa fa-check"></i><b>11</b> Случайный эксперимент</a><ul>
<li class="chapter" data-level="11.1" data-path="randexp.html"><a href="randexp.html#ход-исследования"><i class="fa fa-check"></i><b>11.1</b> Ход исследования</a></li>
<li class="chapter" data-level="11.2" data-path="randexp.html"><a href="randexp.html#событие.-пространство-элементарных-событий."><i class="fa fa-check"></i><b>11.2</b> Событие. Пространство элементарных событий.</a><ul>
<li class="chapter" data-level="11.2.1" data-path="randexp.html"><a href="randexp.html#игральный-кубик"><i class="fa fa-check"></i><b>11.2.1</b> Игральный кубик</a></li>
<li class="chapter" data-level="11.2.2" data-path="randexp.html"><a href="randexp.html#events_operations"><i class="fa fa-check"></i><b>11.2.2</b> Действия над событиями</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="randexp.html"><a href="randexp.html#классическое-определение-вероятности"><i class="fa fa-check"></i><b>11.3</b> Классическое определение вероятности</a></li>
<li class="chapter" data-level="11.4" data-path="randexp.html"><a href="randexp.html#статистическое-определение-вероятности"><i class="fa fa-check"></i><b>11.4</b> Статистическое определение вероятности</a></li>
<li class="chapter" data-level="11.5" data-path="randexp.html"><a href="randexp.html#кроме-кубика"><i class="fa fa-check"></i><b>11.5</b> Кроме кубика</a></li>
<li class="chapter" data-level="11.6" data-path="randexp.html"><a href="randexp.html#вероятности-сложных-событий"><i class="fa fa-check"></i><b>11.6</b> Вероятности сложных событий</a><ul>
<li class="chapter" data-level="11.6.1" data-path="randexp.html"><a href="randexp.html#условная-вероятность"><i class="fa fa-check"></i><b>11.6.1</b> Условная вероятность</a></li>
<li class="chapter" data-level="11.6.2" data-path="randexp.html"><a href="randexp.html#теорема-байеса"><i class="fa fa-check"></i><b>11.6.2</b> Теорема Байеса</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="prob.html"><a href="prob.html"><i class="fa fa-check"></i><b>12</b> Вероятность и случайные величины</a><ul>
<li class="chapter" data-level="12.1" data-path="prob.html"><a href="prob.html#дискретные-случайные-величины"><i class="fa fa-check"></i><b>12.1</b> Дискретные случайные величины</a></li>
<li class="chapter" data-level="12.2" data-path="prob.html"><a href="prob.html#непрерывные-случайные-величины"><i class="fa fa-check"></i><b>12.2</b> Непрерывные случайные величины</a></li>
<li class="chapter" data-level="12.3" data-path="prob.html"><a href="prob.html#moments_distributions"><i class="fa fa-check"></i><b>12.3</b> Характеристики распределения случайных величин</a></li>
<li class="chapter" data-level="12.4" data-path="prob.html"><a href="prob.html#normal_distribution"><i class="fa fa-check"></i><b>12.4</b> Нормальное распределение</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="statestim.html"><a href="statestim.html"><i class="fa fa-check"></i><b>13</b> Оценивание параметров в практике статистического анализа</a><ul>
<li class="chapter" data-level="13.1" data-path="statestim.html"><a href="statestim.html#точечные-оценки"><i class="fa fa-check"></i><b>13.1</b> Точечные оценки</a><ul>
<li class="chapter" data-level="13.1.1" data-path="statestim.html"><a href="statestim.html#метод-моментов"><i class="fa fa-check"></i><b>13.1.1</b> Метод моментов</a></li>
<li class="chapter" data-level="13.1.2" data-path="statestim.html"><a href="statestim.html#свойства-точечных-оценок"><i class="fa fa-check"></i><b>13.1.2</b> Свойства точечных оценок</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="statestim.html"><a href="statestim.html#интервальные-оценки"><i class="fa fa-check"></i><b>13.2</b> Интервальные оценки</a><ul>
<li class="chapter" data-level="13.2.1" data-path="statestim.html"><a href="statestim.html#confinterval"><i class="fa fa-check"></i><b>13.2.1</b> Доверительный интервал</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="hypotheses.html"><a href="hypotheses.html"><i class="fa fa-check"></i><b>14</b> Тестирование статистических гипотез</a><ul>
<li class="chapter" data-level="14.1" data-path="hypotheses.html"><a href="hypotheses.html#базовые-понятия"><i class="fa fa-check"></i><b>14.1</b> Базовые понятия</a></li>
<li class="chapter" data-level="14.2" data-path="hypotheses.html"><a href="hypotheses.html#асимметрия-статистического-вывода"><i class="fa fa-check"></i><b>14.2</b> Асимметрия статистического вывода</a></li>
<li class="chapter" data-level="14.3" data-path="hypotheses.html"><a href="hypotheses.html#возможные-результаты-проверки-гипотез"><i class="fa fa-check"></i><b>14.3</b> Возможные результаты проверки гипотез</a></li>
<li class="chapter" data-level="14.4" data-path="hypotheses.html"><a href="hypotheses.html#алгоритм-тестирования-статистических-гипотез"><i class="fa fa-check"></i><b>14.4</b> Алгоритм тестирования статистических гипотез</a></li>
<li class="chapter" data-level="14.5" data-path="hypotheses.html"><a href="hypotheses.html#проблема-множественных-сравнений"><i class="fa fa-check"></i><b>14.5</b> Проблема множественных сравнений</a></li>
</ul></li>
<li class="part"><span><b>III Анализ данных</b></span></li>
<li class="chapter" data-level="15" data-path="descriptives.html"><a href="descriptives.html"><i class="fa fa-check"></i><b>15</b> Описательные статистики</a><ul>
<li class="chapter" data-level="15.1" data-path="descriptives.html"><a href="descriptives.html#меры-центральной-тенденции"><i class="fa fa-check"></i><b>15.1</b> Меры центральной тенденции</a><ul>
<li class="chapter" data-level="15.1.1" data-path="descriptives.html"><a href="descriptives.html#мода"><i class="fa fa-check"></i><b>15.1.1</b> Мода</a></li>
<li class="chapter" data-level="15.1.2" data-path="descriptives.html"><a href="descriptives.html#медиана"><i class="fa fa-check"></i><b>15.1.2</b> Медиана</a></li>
<li class="chapter" data-level="15.1.3" data-path="descriptives.html"><a href="descriptives.html#среднее"><i class="fa fa-check"></i><b>15.1.3</b> Среднее</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="descriptives.html"><a href="descriptives.html#меры-разброса"><i class="fa fa-check"></i><b>15.2</b> Меры разброса</a><ul>
<li class="chapter" data-level="15.2.1" data-path="descriptives.html"><a href="descriptives.html#минимум-и-максимум"><i class="fa fa-check"></i><b>15.2.1</b> Минимум и максимум</a></li>
<li class="chapter" data-level="15.2.2" data-path="descriptives.html"><a href="descriptives.html#размах"><i class="fa fa-check"></i><b>15.2.2</b> Размах</a></li>
<li class="chapter" data-level="15.2.3" data-path="descriptives.html"><a href="descriptives.html#дисперсия"><i class="fa fa-check"></i><b>15.2.3</b> Дисперсия</a></li>
<li class="chapter" data-level="15.2.4" data-path="descriptives.html"><a href="descriptives.html#стандартное-отклонение"><i class="fa fa-check"></i><b>15.2.4</b> Стандартное отклонение</a></li>
<li class="chapter" data-level="15.2.5" data-path="descriptives.html"><a href="descriptives.html#стандартная-ошибка-среднего"><i class="fa fa-check"></i><b>15.2.5</b> Стандартная ошибка среднего</a></li>
<li class="chapter" data-level="15.2.6" data-path="descriptives.html"><a href="descriptives.html#квантили"><i class="fa fa-check"></i><b>15.2.6</b> Квантили</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="descriptives.html"><a href="descriptives.html#асимметрия"><i class="fa fa-check"></i><b>15.3</b> Асимметрия</a></li>
<li class="chapter" data-level="15.4" data-path="descriptives.html"><a href="descriptives.html#эксцесс"><i class="fa fa-check"></i><b>15.4</b> Эксцесс</a></li>
<li class="chapter" data-level="15.5" data-path="descriptives.html"><a href="descriptives.html#описательные-статистики-в-r"><i class="fa fa-check"></i><b>15.5</b> Описательные статистики в R</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="correlation.html"><a href="correlation.html"><i class="fa fa-check"></i><b>16</b> Корреляционный анализ</a><ul>
<li class="chapter" data-level="16.1" data-path="correlation.html"><a href="correlation.html#ковариация"><i class="fa fa-check"></i><b>16.1</b> Ковариация</a></li>
<li class="chapter" data-level="16.2" data-path="correlation.html"><a href="correlation.html#корреляция"><i class="fa fa-check"></i><b>16.2</b> Корреляция</a><ul>
<li class="chapter" data-level="16.2.1" data-path="correlation.html"><a href="correlation.html#тестирование-статистической-значимости-коэффициента-корреляции"><i class="fa fa-check"></i><b>16.2.1</b> Тестирование статистической значимости коэффициента корреляции</a></li>
<li class="chapter" data-level="16.2.2" data-path="correlation.html"><a href="correlation.html#доверительный-интервал-для-коэффициента-корреляции"><i class="fa fa-check"></i><b>16.2.2</b> Доверительный интервал для коэффициента корреляции</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="correlation.html"><a href="correlation.html#ковариация-и-корреляция-в-r"><i class="fa fa-check"></i><b>16.3</b> Ковариация и корреляция в R</a><ul>
<li class="chapter" data-level="16.3.1" data-path="correlation.html"><a href="correlation.html#коэффициенты-корреляции-для-разных-шкал"><i class="fa fa-check"></i><b>16.3.1</b> Коэффициенты корреляции для разных шкал</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="correlation.html"><a href="correlation.html#частный-и-множественный-коэффициент-корреляции"><i class="fa fa-check"></i><b>16.4</b> Частный и множественный коэффициент корреляции</a></li>
<li class="chapter" data-level="16.5" data-path="correlation.html"><a href="correlation.html#другие-корреляции"><i class="fa fa-check"></i><b>16.5</b> Другие корреляции</a><ul>
<li class="chapter" data-level="16.5.1" data-path="correlation.html"><a href="correlation.html#phi-коэффициент"><i class="fa fa-check"></i><b>16.5.1</b> <span class="math inline">\(\phi\)</span>-коэффициент</a></li>
<li class="chapter" data-level="16.5.2" data-path="correlation.html"><a href="correlation.html#бисериальный-коэффициент-корреляции"><i class="fa fa-check"></i><b>16.5.2</b> Бисериальный коэффициент корреляции</a></li>
<li class="chapter" data-level="16.5.3" data-path="correlation.html"><a href="correlation.html#рангово-бисериальный-коэффициент-корреляции"><i class="fa fa-check"></i><b>16.5.3</b> Рангово-бисериальный коэффициент корреляции</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="simple-linear.html"><a href="simple-linear.html"><i class="fa fa-check"></i><b>17</b> Общие линейные модели. Простая линейная регрессия</a></li>
<li class="chapter" data-level="18" data-path="multiple-linear.html"><a href="multiple-linear.html"><i class="fa fa-check"></i><b>18</b> Множественная линейная регрессия</a></li>
<li class="chapter" data-level="19" data-path="anova.html"><a href="anova.html"><i class="fa fa-check"></i><b>19</b> Дисперсионный анализ</a></li>
<li class="chapter" data-level="20" data-path="ancova.html"><a href="ancova.html"><i class="fa fa-check"></i><b>20</b> Ковариационный анализ</a></li>
<li class="chapter" data-level="21" data-path="logistic.html"><a href="logistic.html"><i class="fa fa-check"></i><b>21</b> Обобщенные линейные модели. Логистическая регрессия</a></li>
<li class="chapter" data-level="22" data-path="poisson.html"><a href="poisson.html"><i class="fa fa-check"></i><b>22</b> Пуассоновская регрессия</a></li>
<li class="chapter" data-level="23" data-path="regularization.html"><a href="regularization.html"><i class="fa fa-check"></i><b>23</b> Регуляризация регрессии</a></li>
<li class="chapter" data-level="24" data-path="glmm.html"><a href="glmm.html"><i class="fa fa-check"></i><b>24</b> Смешанные линейные модели</a></li>
<li class="chapter" data-level="25" data-path="cluster.html"><a href="cluster.html"><i class="fa fa-check"></i><b>25</b> Кластерный анализ</a></li>
<li class="chapter" data-level="26" data-path="pca.html"><a href="pca.html"><i class="fa fa-check"></i><b>26</b> Анализ главных компонент</a></li>
<li class="chapter" data-level="27" data-path="efa.html"><a href="efa.html"><i class="fa fa-check"></i><b>27</b> Эксплораторный факторный анализ</a></li>
<li class="chapter" data-level="28" data-path="cfa.html"><a href="cfa.html"><i class="fa fa-check"></i><b>28</b> Конфирматорный факторный анализ</a></li>
<li class="chapter" data-level="29" data-path="further.html"><a href="further.html"><i class="fa fa-check"></i><b>29</b> Что дальше?</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>Литература</a><ul>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#касаемо-математики"><i class="fa fa-check"></i>Касаемо математики</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#относительно-статистики"><i class="fa fa-check"></i>Относительно статистики</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#about-r"><i class="fa fa-check"></i>About R</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#во-славу-андана"><i class="fa fa-check"></i>Во славу андана</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">HSE UX LAB | Анализ данных + R: мир линейных моделей | Book</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="correlation" class="section level1">
<h1><span class="header-section-number">16</span> Корреляционный анализ</h1>
<p>До этого момента мы рассматривали только отдельные переменные и их характерики, однако в практике мы редко работаем только с одной переменной. Как правило, у нас есть многомерное пространство признаков, и нас интересуют взаимосвязи между ними.</p>
<div id="ковариация" class="section level2">
<h2><span class="header-section-number">16.1</span> Ковариация</h2>
<p>Мы хотим описать имеющиеся взаимосвязи как можно проще и опираясь на то, что у нас уже есть. Мы говорили, что дисперсия, или вариация, заключает в себе информацию об изменчивости признака. Если мы хотим исследовать взаимосвязь между признаками, то логично будет посмотреть, как изменяется один из признаков при изменении другого — иначе говоря, рассчитать <em>совместную изменчивость признаков</em>, или <strong>ко-вариацию (covariance)</strong>.</p>
<p>Как мы её будем считать? Подумаем графически. Расположим две переменные на осях и сопоставим каждому имеющемуся наблюдению точку на плоскости.</p>
<p>КАРТИНКА</p>
<p>Отметим средние значения по обеим переменным.</p>
<p>КАРТИНКА</p>
<p>Заметим, что если наши наблюдения по переменной <span class="math inline">\(x_1\)</span> отклоняются в большую сторону, то они отклоняются в большую сторону и по переменной <span class="math inline">\(x_2\)</span>. Аналогично, если они будут отклоняться в меньшую сторону по <span class="math inline">\(x_1\)</span>, то в меньшую же сторону они будут отклоняться и по <span class="math inline">\(x_2\)</span>.</p>
<p>КАРТИНКА</p>
<p>Получается, мы можем на основании согласованности отклонений уже заключить о направлении связи. <em>Произведение отклонений по обеим величинам будет положительно, если отклонения сонаправленны</em>. Запишем это математически.</p>
<p><span class="math display">\[
(\bar x_1 - x_{i1}) (\bar x_2 - x_{i2}) &gt; 0 \Leftarrow \big( (\bar x_1 - x_{i1}) &gt; 0 \wedge (\bar x_2 - x_{i2}) &gt; 0 \big) \vee \big( (\bar x_1 - x_{i1}) &lt; 0 \wedge (\bar x_2 - x_{i2}) &lt; 0 \big)
\]</span></p>
<p>Соответственно, если отклонения будут направлены в разные стороны, из произведение будет отрицательным. Ну, осталось только понять, как совместные отклонения организованы в среднем — это и будет ковариацией двух величин:</p>
<p><span class="math display">\[
\mathrm{cov}(X_1, X_2) = \frac{1}{n-1} \sum_{i=1}^n (\bar x_1 - x_{i1}) (\bar x_2 - x_{i2})
\]</span></p>
<img class="taskimg" src="img/task.png">
<div class="task">
<p>Что такое ковариация величины самой с собой (<span class="math inline">\(\mathrm{cov}(X_1, X_1)\)</span>)? Докажите через выведение формулы.</p>
</div>
<p>Важно отметить, что ковариация улавливается только <em>линейную составляющую</em> взаимосвязи между признаками, поэтому если <span class="math inline">\(\mathrm{cov}(X_1,X_2) = 0\)</span>, то мы можем сказать, что между переменными нет <em>линейной</em> взаимосвязи, однако это не значит, что между этими переменными нет никакой другой зависимости.</p>
<p>У ковариации есть два важных недостатка:</p>
<ul>
<li>это размерная величина, поэтому её значение зависит от единиц измерения признаков,</li>
<li>она зависит от дисперсий признаков, поэтому по её значению можно определить только направление связи (прямая или обратная), однако ничего нельзая сказать о силе связи.</li>
</ul>
<p>Поэтому нам нужно как-то модицифировать эту статистику, чтобы мы могли больше вытащить из её значения.</p>
</div>
<div id="корреляция" class="section level2">
<h2><span class="header-section-number">16.2</span> Корреляция</h2>
<p>Раз ковариация зависит от дисперсии, то можно сделать некоторые математические преобразования, чтобы привести эмпирические распределения к какому-то одному виду — сделать так, чтобы они имели одинакое математическое ожидание (среднее) и одинаковую дисперсию. С этой задачей прекрасно справляется <a href="#standartization">стандартизация</a>. Напоминаю формулу:</p>
<p><span class="math display">\[
x_i^* = \frac{x_i - \bar x}{s}
\]</span>
После такого преобразования математическое ожидание нашего распределения будет равно нуля, а стандартное отклонение — единице. Это избавит нас от влияния дисперсии на значение ковариации. Ковариация двух стандартно нормально распределенных величин называется <strong>корреляцией (correlation)</strong>.</p>
<p><span class="math display">\[
\mathrm{cov}(X_1^*, X_2^*) = \frac{1}{n-1} \sum_{i=1}^n x_{i1}^* x_{i2}^* = \mathrm{corr}(X_1, X_2),
\]</span>
где <span class="math inline">\(X_1^*\)</span> и <span class="math inline">\(X_2^*\)</span> — стандартизированные величины <span class="math inline">\(X_1\)</span> и <span class="math inline">\(X_2\)</span> соответственно.</p>
<p>Корреляцию можно выразить через ковариацию:</p>
<p><span class="math display">\[
\mathrm{corr}(X_1, X_2) = \frac{1}{n-1} \sum_{i=1}^n \Big( \frac{\bar x_1 - x_{i1}}{s_1} \Big) \Big( \frac{\bar x_2 - x_{i2}}{s_2} \Big) = 
\frac{1}{s_1 s_2} \Big( \frac{1}{n-1} \sum_{i=1}^n (\bar x_1 - x_{i1})(\bar x_2 - x_{i2}) \Big) = \frac{\mathrm{cov}(X_1, X_2)}{s_1 s_2}
\]</span></p>
<p>Если внимательно всмотреться в формуле, то можно обнаружить, что корреляция это не что иное, как стандартизированное значение ковариации.</p>
<p>Коэффициент корреляции имеет четкие пределы изменения: <span class="math inline">\([-1; \,1]\)</span>. Крайнее левое значение говорит о том, что присутствует полная обратная линейная взаимосвязь, крайнее правое — что присутствует полная прямая линейная взаимосвязь. Как и ковариация, корреляция ловит <em>только линейную составляющую</em> связи, поэтому нулевое значение корреляци показывает, что между переменными отсутствует <em>линейная взаимосвязь</em>. Это всё еще не значит, что связи нет вовсе.</p>
<div id="тестирование-статистической-значимости-коэффициента-корреляции" class="section level3">
<h3><span class="header-section-number">16.2.1</span> Тестирование статистической значимости коэффициента корреляции</h3>
<p>Оценку коэффициента корреляции мы получаем методом моментов, заменяя истинный момент <span class="math inline">\(\rho_{ij}\)</span> выборочным <span class="math inline">\(r_{ij}\)</span>:</p>
<p><span class="math display">\[
\hat \rho_{ij} = \overline{\big( (X_{ki} - \bar X_i) (X_{kj} - \bar X_j) \big)} = r_{ij}
\]</span></p>
<p>Если в генеральной совокупности связь между признаками отсутствует, то есть <span class="math inline">\(\rho_{ij} = 0\)</span>, будет ли равен нулю <span class="math inline">\(r_{ij}\)</span>? Можно с уверенностью сказать, что не будет, так как выборочный коэффициент корреляции — случайная величина. А мы помним, что вероятность принятия случайной величиной своего конкретного значения равна нулю.</p>
<p>Тогда необходимо протестировать статистическую гипотезу:</p>
<p><span class="math display">\[
H_0: \rho_{ij} = 0 \; \text{(линейной связи нет)} \\
H_1: \rho_{ij} \neq 0 \text{(наиболее частый вариант альтернативы)}
\]</span></p>
<p>Для проверки нулевой гипотезы используется следующая статистика:</p>
<p><span class="math display">\[
t = \frac{r_{ij}}{\sqrt{\frac{1 - r^2_{ij}}{n-2}}} \overset{H_0}{\thicksim} t(\nu = n-2)
\]</span></p>
<p>Вывод о статистической значимости коэффициента корреляции делается согласно <a href="statestim.html#statestim">алгоритму тестировния статистических гипотез</a>.</p>
</div>
<div id="доверительный-интервал-для-коэффициента-корреляции" class="section level3">
<h3><span class="header-section-number">16.2.2</span> Доверительный интервал для коэффициента корреляции</h3>
<p>С построением интервальной оценки коэффциента корреляции возникают некоторые сложности. Наша задача состоит в том, чтобы определить в каких границах будет лежать значение истинного коэффициента корреляции с заданной вероятностью:</p>
<p><span class="math display">\[
\mathrm{P} (\rho_{ij,\min} &lt; \rho_{ij} &lt; \rho_{ij,\max}) = \gamma
\]</span></p>
<p>Нам необходимо найти статистику, закон распределения корой известен, однако ранее упомянутся статистика не подходит, так как она имеет распределение Стьюдента, когда верна нулевая гипотеза об отсутствии связи. Если же мы строим интервальную оценку, нас интересует случай наличия связи.</p>
<p>Такую статистику искали долго, и её удалось найти, когда ввели определённое преобразование выборочного критерия корреяции — <em>z-преобразования Фишера</em>:</p>
<p><span class="math display">\[
z(r_{ij}) = \frac{1}{2} \ln \frac{1 + r_{ij}}{1 - r_{ij}} \thicksim \mathrm{N}(\bar z_{ij}, \tfrac{1}{n-3}),
\]</span>
где <span class="math inline">\(n\)</span> — объём выборки, а <span class="math inline">\(\bar z_{ij}\)</span> получается расчётом по указанной формуле после подставления точечной оценки коэффициента корреляции.</p>
<p>Тогда интервальная оценка для величины <span class="math inline">\(z_{ij, \mathrm{true}}\)</span> приобретает такой вид:</p>
<p><span class="math display">\[
\mathrm{P} \Big( \bar z_{ij} - t_\gamma \sqrt{\tfrac{1}{n-3}} &lt; z_{ij, \mathrm{true}} &lt; \bar z_{ij} + t_\gamma \sqrt{\tfrac{1}{n-3}}  \Big) = \gamma = \Phi(t_\gamma)
\]</span></p>
<p>Далее путём обратного преобразования получаются значения границ интервала <span class="math inline">\((\rho_{ij,\min}, \; \rho_{ij,\max})\)</span>.</p>
</div>
</div>
<div id="ковариация-и-корреляция-в-r" class="section level2">
<h2><span class="header-section-number">16.3</span> Ковариация и корреляция в R</h2>
<p>Запасёмся <a href="https://github.com/angelgardt/hseuxlab-wlm2021/blob/master/book/wlm2021-book/data/clean_dannye_norm.xlsx?raw=true">данными</a>. По ссылке скачается экселька.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="correlation.html#cb1-1"></a>dehum &lt;-<span class="st"> </span>readxl<span class="op">::</span><span class="kw">read_xlsx</span>(<span class="st">&#39;data/clean_dannye_norm.xlsx&#39;</span>)</span>
<span id="cb1-2"><a href="correlation.html#cb1-2"></a><span class="kw">str</span>(dehum)</span></code></pre></div>
<pre><code>## tibble [906 × 39] (S3: tbl_df/tbl/data.frame)
##  $ SEX            : num [1:906] 1 2 2 2 2 2 2 1 2 2 ...
##  $ AGE            : chr [1:906] &quot;32&quot; &quot;22&quot; &quot;21&quot; &quot;15&quot; ...
##  $ MCA            : num [1:906] NA NA 1 NA NA NA NA NA NA 1 ...
##  $ MMA            : num [1:906] NA NA NA NA NA NA NA NA NA NA ...
##  $ MCI            : num [1:906] NA NA NA NA NA NA NA NA NA NA ...
##  $ MMI            : num [1:906] NA NA NA 1 NA NA NA NA NA NA ...
##  $ WCA            : num [1:906] NA NA NA NA 1 NA NA NA NA NA ...
##  $ WMA            : num [1:906] 1 NA NA NA NA 1 NA NA NA NA ...
##  $ WCI            : num [1:906] NA NA NA NA NA NA NA NA NA NA ...
##  $ WMI            : num [1:906] NA NA NA NA NA NA 1 NA NA NA ...
##  $ MX             : num [1:906] NA NA NA NA NA NA NA 1 NA NA ...
##  $ WX             : num [1:906] NA 1 NA NA NA NA NA NA 1 NA ...
##  $ sex_k          : num [1:906] 2 2 1 1 2 2 2 2 2 1 ...
##  $ intention      : num [1:906] 2 2 2 1 2 2 1 2 2 2 ...
##  $ victim         : num [1:906] 2 2 1 2 1 2 2 2 2 1 ...
##  $ CG             : num [1:906] 0 2 0 0 0 0 0 1 2 0 ...
##  $ DP             : num [1:906] 2 1 5 3 1 1 3 1 1 2 ...
##  $ GRa            : num [1:906] 1 3 5 1 1 5 2 1 4 5 ...
##  $ GRb            : num [1:906] 1 3 5 2 1 4 1 1 3 6 ...
##  $ GRc            : num [1:906] 1 3 2 3 1 2 1 1 2 1 ...
##  $ GR_average     : num [1:906] 1 3 4 2 1 ...
##  $ ARa            : num [1:906] 1 2 3 1 2 4 4 1 2 3 ...
##  $ ARb            : num [1:906] 1 2 2 3 1 1 1 1 2 1 ...
##  $ ARc            : num [1:906] 1 2 1 4 1 1 1 1 2 1 ...
##  $ AR_average     : num [1:906] 1 2 2 2.67 1.33 ...
##  $ SRa            : num [1:906] 1 5 5 1 2 4 2 1 3 2 ...
##  $ SRb            : num [1:906] 1 4 4 1 2 5 1 1 3 3 ...
##  $ SRc            : num [1:906] 1 4 5 2 2 2 1 1 4 4 ...
##  $ SR_average     : num [1:906] 1 4.33 4.67 1.33 2 ...
##  $ DHa            : num [1:906] 3 1 5 3 1 5 1 1 3 2 ...
##  $ DHb            : num [1:906] 1 1 2 2 1 2 1 1 2 2 ...
##  $ DHc            : num [1:906] 1 1 5 4 1 2 3 1 4 2 ...
##  $ DHd            : num [1:906] 1 1 1 2 1 1 1 1 1 2 ...
##  $ DHe            : num [1:906] 2 4 5 2 2 1 2 1 3 1 ...
##  $ DHf            : num [1:906] 1 1 1 2 1 1 3 1 3 1 ...
##  $ DHg            : num [1:906] 1 1 2 4 1 4 5 1 1 1 ...
##  $ DHh            : num [1:906] 1 4 7 5 4 4 6 1 4 5 ...
##  $ animal_average : num [1:906] 1.75 2.5 5.5 3.5 2 3 3 1 3.5 2.5 ...
##  $ machine_average: num [1:906] 1 1 1.5 2.5 1 2 2.5 1 1.75 1.5 ...</code></pre>
<p>Это данные исследования на тему дегуманизации убийц. Нас будут интересовать следующие шкалы:</p>
<ul>
<li><em>DPa</em> — шкала «одобрения казни»</li>
<li>Шкала морального возмущения:
<ul>
<li><em>GR_average</em> — подшкала отвращения</li>
<li><em>AR_average</em> — подшкала гнева</li>
<li><em>SR_average</em> — подшкала презрения</li>
</ul></li>
<li>Шкала дегуманизации:
<ul>
<li><em>animal_average</em> — анималистическая дегуманизация</li>
<li><em>machine_average</em> — механистическая дегуманизация</li>
</ul></li>
</ul>
<p>Ковариация считается так:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="correlation.html#cb3-1"></a><span class="kw">cov</span>(dehum<span class="op">$</span>GR_average, dehum<span class="op">$</span>AR_average)</span></code></pre></div>
<pre><code>## [1] 1.567469</code></pre>
<p>А корреляция так:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="correlation.html#cb5-1"></a><span class="kw">cor</span>(dehum<span class="op">$</span>GR_average, dehum<span class="op">$</span>AR_average)</span></code></pre></div>
<pre><code>## [1] 0.7363325</code></pre>
<p>Ещё мы можем построить соответствующий график, чтобы отобразить закономерность — диаграмма рассеяния с линией тренда:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="correlation.html#cb7-1"></a><span class="kw">library</span>(tidyverse)</span></code></pre></div>
<pre><code>## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.0 ──</code></pre>
<pre><code>## ✓ ggplot2 3.3.2     ✓ purrr   0.3.4
## ✓ tibble  3.0.4     ✓ dplyr   1.0.2
## ✓ tidyr   1.1.2     ✓ stringr 1.4.0
## ✓ readr   1.4.0     ✓ forcats 0.5.0</code></pre>
<pre><code>## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="correlation.html#cb11-1"></a><span class="kw">theme_set</span>(<span class="kw">theme_bw</span>())</span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="correlation.html#cb12-1"></a>dehum <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(GR_average, AR_average)) <span class="op">+</span></span>
<span id="cb12-2"><a href="correlation.html#cb12-2"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb12-3"><a href="correlation.html#cb12-3"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&#39;lm&#39;</span>) <span class="co"># мы заинтересованы в отображении линейного компонента связи</span></span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="wlm2021-book_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>Но это мы всё получали выборочные оценки коэффициентов. А как же тестировать гипотезы?</p>
<p>Легко и непринужденно! Просто дописать <code>test</code> в название функции:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="correlation.html#cb14-1"></a><span class="kw">cor.test</span>(dehum<span class="op">$</span>GR_average, dehum<span class="op">$</span>AR_average)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  dehum$GR_average and dehum$AR_average
## t = 32.72, df = 904, p-value &lt; 2.2e-16
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.7050124 0.7647859
## sample estimates:
##       cor 
## 0.7363325</code></pre>
<p>Что мы наблюдаем в аутпуте? Значение t-статистики, число степеней свободы, p-value для значения t-статистики, а также 95% доверительный интервал для коэффициента корреляции. Всё, что мы и хотели — за одну команду!</p>
<div id="коэффициенты-корреляции-для-разных-шкал" class="section level3">
<h3><span class="header-section-number">16.3.1</span> Коэффициенты корреляции для разных шкал</h3>
<p>Дла разных шкал разработаны разные коэффициенты корреляции. Оценки коэффициентов будут рассчитываться по-разному, но логика тестирования статистических гипотез остаётся одинаковой.</p>
<table>
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Переменная <span class="math inline">\(X\)</span></th>
<th align="center">Переменная <span class="math inline">\(Y\)</span></th>
<th align="center">Мера связи</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Интервальная или отношений</td>
<td align="center">Интервальная или отношений</td>
<td align="center">Коэффициент Пирсона</td>
</tr>
<tr class="even">
<td align="center">Ранговая, интервальная или отношений</td>
<td align="center">Ранговая, интервальная или отношений</td>
<td align="center">Коэффициент Спирмена</td>
</tr>
<tr class="odd">
<td align="center">Ранговая</td>
<td align="center">Ранговая</td>
<td align="center">Коэффициент Кенделла</td>
</tr>
</tbody>
</table>
<p>В функциях <code>cor()</code> и <code>cor.test()</code> требуемый коэффициент задаётся черед аргумент <code>method</code>:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="correlation.html#cb16-1"></a><span class="kw">cor.test</span>(dehum<span class="op">$</span>DP, dehum<span class="op">$</span>animal_average, <span class="dt">method =</span> <span class="st">&#39;kendall&#39;</span>)</span></code></pre></div>
<pre><code>## 
##  Kendall&#39;s rank correlation tau
## 
## data:  dehum$DP and dehum$animal_average
## z = 9.5138, p-value &lt; 2.2e-16
## alternative hypothesis: true tau is not equal to 0
## sample estimates:
##     tau 
## 0.24636</code></pre>
</div>
</div>
<div id="частный-и-множественный-коэффициент-корреляции" class="section level2">
<h2><span class="header-section-number">16.4</span> Частный и множественный коэффициент корреляции</h2>
<p>Если у нас два признака, то с ними всё достаточно понятно. А если признаком много? Тогда у нас могут быть сложные взаимосвязи, и возможен такой случай, что некоторый признак оказывает связан как с одним, так и с другим из интересующих нас. Таким образом, мы можем наблюдать <em>ложную корреляцию</em>. Чтобы избавиться от влияния сторонних признаков, используюся частные коэффициенты корреляции.</p>
<p>Функция <code>cor()</code> может возвращать не только оценку одного коэффициента корреляции, но и <strong>корреляционную матрицу</strong>, отобрадающую связи всех признаков со всеми. Например, продолжим работать со шкалой морального возмущения и изучим взаимосвязи внутри неё:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="correlation.html#cb18-1"></a>dehum <span class="op">%&gt;%</span></span>
<span id="cb18-2"><a href="correlation.html#cb18-2"></a><span class="st">  </span><span class="kw">select</span>(GR_average, AR_average, SR_average) <span class="op">%&gt;%</span></span>
<span id="cb18-3"><a href="correlation.html#cb18-3"></a><span class="st">  </span><span class="kw">cor</span>()</span></code></pre></div>
<pre><code>##            GR_average AR_average SR_average
## GR_average  1.0000000  0.7363325   0.607245
## AR_average  0.7363325  1.0000000   0.630688
## SR_average  0.6072450  0.6306880   1.000000</code></pre>
<p>В корреляционной матрице на главной диагонали стоят единицы, отражающай связь переменной в самой собой — разумеется, она будет абсолютно линейная.</p>
<img class="taskimg" src="img/code.png">
<div class="task">
<p>А как посчитать <em>ковариационную</em> матрицу?</p>
</div>
<p>В общем виде корреляционная матрица имеет следующий вид:</p>
<p><span class="math display">\[
R = 
\begin{pmatrix}
1 &amp; r_{12} &amp; \dots &amp; r_{1p} \\
r_{12} &amp; 1 &amp; \dots &amp; r_{2p} \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
r_{p1} &amp; r_{p2} &amp; \dots &amp; 1
\end{pmatrix}
\]</span></p>
<p>Матрица, как можно заметить, симметрична относительно главной диагонали, так как <span class="math inline">\(r_{ij} = r_{ji}\)</span>.</p>
<p>Её можно визуализироать, например, так:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="correlation.html#cb20-1"></a>dehum <span class="op">%&gt;%</span></span>
<span id="cb20-2"><a href="correlation.html#cb20-2"></a><span class="st">  </span><span class="kw">select</span>(GR_average, AR_average, SR_average) <span class="op">%&gt;%</span></span>
<span id="cb20-3"><a href="correlation.html#cb20-3"></a><span class="st">  </span><span class="kw">cor</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb20-4"><a href="correlation.html#cb20-4"></a><span class="st">  </span>corrplot<span class="op">::</span><span class="kw">corrplot</span>()</span></code></pre></div>
<p><img src="wlm2021-book_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>Но можно и усовершенствовать визуализацию, отобразив сами значения:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="correlation.html#cb21-1"></a>dehum <span class="op">%&gt;%</span></span>
<span id="cb21-2"><a href="correlation.html#cb21-2"></a><span class="st">  </span><span class="kw">select</span>(GR_average, AR_average, SR_average) <span class="op">%&gt;%</span></span>
<span id="cb21-3"><a href="correlation.html#cb21-3"></a><span class="st">  </span><span class="kw">cor</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb21-4"><a href="correlation.html#cb21-4"></a><span class="st">  </span>corrplot<span class="op">::</span><span class="kw">corrplot.mixed</span>()</span></code></pre></div>
<p><img src="wlm2021-book_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>На основе этой матрицы мы можем протестировать статистическую значимость каждого из коэффициентов (не забыв про поправки на множественные сравнения!):</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="correlation.html#cb22-1"></a>cor_tests &lt;-<span class="st"> </span>correlation<span class="op">::</span><span class="kw">correlation</span>(</span>
<span id="cb22-2"><a href="correlation.html#cb22-2"></a>  dehum <span class="op">%&gt;%</span></span>
<span id="cb22-3"><a href="correlation.html#cb22-3"></a><span class="st">    </span><span class="kw">select</span>(GR_average, AR_average, SR_average),</span>
<span id="cb22-4"><a href="correlation.html#cb22-4"></a>  <span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>, <span class="co"># указываем, какой коэффициент нам нужен</span></span>
<span id="cb22-5"><a href="correlation.html#cb22-5"></a>  <span class="dt">adjust =</span> <span class="st">&quot;holm&quot;</span> <span class="co"># и какую поправку будем использовать</span></span>
<span id="cb22-6"><a href="correlation.html#cb22-6"></a>)</span>
<span id="cb22-7"><a href="correlation.html#cb22-7"></a>cor_tests</span></code></pre></div>
<pre><code>## # Correlation table (spearman-method)
## 
## Parameter1 | Parameter2 |  rho |       95% CI |        S |         p
## --------------------------------------------------------------------
## GR_average | AR_average | 0.71 | [0.67, 0.74] | 3.65e+07 | &lt; .001***
## GR_average | SR_average | 0.60 | [0.55, 0.64] | 4.99e+07 | &lt; .001***
## AR_average | SR_average | 0.67 | [0.63, 0.70] | 4.13e+07 | &lt; .001***
## 
## p-value adjustment method: Holm (1979)
## Observations: 906</code></pre>
<p>Чтобы перенести их на график, нам нужно получить матрицу из p-значений:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="correlation.html#cb24-1"></a>p_values &lt;-<span class="st"> </span>corrplot<span class="op">::</span><span class="kw">cor.mtest</span>(dehum <span class="op">%&gt;%</span></span>
<span id="cb24-2"><a href="correlation.html#cb24-2"></a><span class="st">  </span><span class="kw">select</span>(GR_average, AR_average, SR_average), <span class="dt">adjust =</span> <span class="st">&#39;holm&#39;</span>)<span class="op">$</span>p</span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="correlation.html#cb25-1"></a>dehum <span class="op">%&gt;%</span></span>
<span id="cb25-2"><a href="correlation.html#cb25-2"></a><span class="st">  </span><span class="kw">select</span>(GR_average, AR_average, SR_average) <span class="op">%&gt;%</span></span>
<span id="cb25-3"><a href="correlation.html#cb25-3"></a><span class="st">  </span><span class="kw">cor</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-4"><a href="correlation.html#cb25-4"></a><span class="st">  </span>corrplot<span class="op">::</span><span class="kw">corrplot</span>(<span class="dt">type =</span> <span class="st">&#39;upper&#39;</span>,</span>
<span id="cb25-5"><a href="correlation.html#cb25-5"></a>                     <span class="dt">p.mat =</span> p_values,</span>
<span id="cb25-6"><a href="correlation.html#cb25-6"></a>                     <span class="dt">sig.level =</span> <span class="fl">0.05</span>)</span></code></pre></div>
<p><img src="wlm2021-book_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>Ну, у нас ничего не поменялось, так как коэффициенты все оказались значимы. Эх…</p>
<p>Но вот для примера на одно из встроенных датасетов:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="correlation.html#cb26-1"></a>corrplot<span class="op">::</span><span class="kw">corrplot</span>(</span>
<span id="cb26-2"><a href="correlation.html#cb26-2"></a>  <span class="kw">cor</span>(mtcars),</span>
<span id="cb26-3"><a href="correlation.html#cb26-3"></a>  <span class="dt">type =</span> <span class="st">&quot;upper&quot;</span>,</span>
<span id="cb26-4"><a href="correlation.html#cb26-4"></a>  <span class="dt">p.mat =</span> corrplot<span class="op">::</span><span class="kw">cor.mtest</span>(mtcars)<span class="op">$</span>p,</span>
<span id="cb26-5"><a href="correlation.html#cb26-5"></a>  <span class="dt">sig.level =</span> <span class="fl">0.01</span></span>
<span id="cb26-6"><a href="correlation.html#cb26-6"></a>)</span></code></pre></div>
<p><img src="wlm2021-book_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>Итак, возвращается к частному коэффициенту корреляции. Он определяется так:</p>
<p><span class="math display">\[
r_{ij, J(i,j)} = - \frac{A_{ij}}{\sqrt{A_{ii} A_{jj}}},
\]</span></p>
<p>где <span class="math inline">\(A\)</span> — алгебраическое дополнение.</p>
<p>В общем виде это осознать сложно, поэтому давайте на примере трёх признаков.</p>
<p><span class="math display">\[
R =
\begin{pmatrix}
1 &amp; r_{12} &amp; r_{13} \\
r_{21} &amp; 1 &amp; r_{23} \\
r_{31} &amp; r_{32} &amp; 1
\end{pmatrix}
\]</span></p>
<p><span class="math display">\[
r_{12,3} = \frac{r_{12} - r_{13} \cdot r_{23}}{\sqrt{(1 - r^2_{23})(1-r^2{13})}}
\]</span></p>
<p><span class="math display">\[
H_0: \rho_{12,3} = 0 \\
H_1: \rho_{12,3} \neq 0 \\
t = \frac{r_{12,3} \sqrt{n-3}}{\sqrt{1 - r^2_{12,3}}} \overset{H_0}{\thicksim} t(\nu = n-3)
\]</span></p>
<p>Но слава богу, что в R это все делается в одну строку:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="correlation.html#cb27-1"></a>ppcor<span class="op">::</span><span class="kw">pcor</span>(</span>
<span id="cb27-2"><a href="correlation.html#cb27-2"></a>  dehum <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb27-3"><a href="correlation.html#cb27-3"></a><span class="st">    </span><span class="kw">select</span>(GR_average, AR_average, SR_average)</span>
<span id="cb27-4"><a href="correlation.html#cb27-4"></a>)</span></code></pre></div>
<pre><code>## $estimate
##            GR_average AR_average SR_average
## GR_average  1.0000000  0.5730882  0.2720509
## AR_average  0.5730882  1.0000000  0.3414418
## SR_average  0.2720509  0.3414418  1.0000000
## 
## $p.value
##              GR_average   AR_average   SR_average
## GR_average 0.000000e+00 3.948903e-80 8.051918e-17
## AR_average 3.948903e-80 0.000000e+00 3.811050e-26
## SR_average 8.051918e-17 3.811050e-26 0.000000e+00
## 
## $statistic
##            GR_average AR_average SR_average
## GR_average   0.000000   21.01453   8.495546
## AR_average  21.014531    0.00000  10.916353
## SR_average   8.495546   10.91635   0.000000
## 
## $n
## [1] 906
## 
## $gp
## [1] 1
## 
## $method
## [1] &quot;pearson&quot;</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="correlation.html#cb29-1"></a>ppcor<span class="op">::</span><span class="kw">pcor.test</span>(dehum<span class="op">$</span>GR_average,</span>
<span id="cb29-2"><a href="correlation.html#cb29-2"></a>                 dehum<span class="op">$</span>AR_average,</span>
<span id="cb29-3"><a href="correlation.html#cb29-3"></a>                 dehum<span class="op">$</span>SR_average)</span></code></pre></div>
<pre><code>##    estimate      p.value statistic   n gp  Method
## 1 0.5730882 3.948903e-80  21.01453 906  1 pearson</code></pre>
<p>Хорошо, а если нас интересует связь одного признака с несколькими сразу? Тогда нам нужен множественный коэффициент корреляции. Он также вычисляется на основе корреляционной матрицы и определяется следующим образом. Пусть нас интересует связь первого признака со всеми остальными:</p>
<p><span class="math display">\[
R_1 = \sqrt{1 - \frac{\det R}{A_{11}}}
\]</span></p>
<p>Квадрат множественонго коэффициента корреляции называется <em>коэффициентом детерминации</em><a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>. Он показывает, во-первых, степень тесноты связи данного признака со всеми остальными, но, кроме того, ещё и долю дисперсии данного признака, определяемую вариацией все остальных признаков, включенных в данную корреляционную модель.</p>
<p>Мы подробнее его изучим в следуюшей теме, а также увидим, где нам его найти, чтобы не считать руками.</p>
</div>
<div id="другие-корреляции" class="section level2">
<h2><span class="header-section-number">16.5</span> Другие корреляции</h2>
<p>Можно коррелировать не только количественные и ранговые шкалы между собой, но и качественные тоже:</p>
<table>
<thead>
<tr class="header">
<th align="center">Переменная <span class="math inline">\(X\)</span></th>
<th align="center">Переменная <span class="math inline">\(Y\)</span></th>
<th align="center">Мера связи</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Дихотомическая</td>
<td align="center">Дихотомическая</td>
<td align="center"><span class="math inline">\(\phi\)</span>-коэффициент</td>
</tr>
<tr class="even">
<td align="center">Дихотомическая</td>
<td align="center">Ранговая</td>
<td align="center">Рангово-бисериальный коэффициент</td>
</tr>
<tr class="odd">
<td align="center">Дихотомическая</td>
<td align="center">Интервальная или отношений</td>
<td align="center">Бисериальный коэффициент</td>
</tr>
</tbody>
</table>
<div id="phi-коэффициент" class="section level3">
<h3><span class="header-section-number">16.5.1</span> <span class="math inline">\(\phi\)</span>-коэффициент</h3>
<p>Этот коэффициент позволяет рассчитать корреляцию между двумы дихотомическими шкалами. Он основан на расчёте статистики <span class="math inline">\(\chi^2\)</span>.</p>
<p>По двум дихотомическим переменным можно построить таблицу сопряженности. Разберемся на <a href="https://raw.githubusercontent.com/angelgardt/hseuxlab-wlm2021/master/book/wlm2021-book/data/cats_n_dogs.csv">котиках и пёсиках</a>:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="correlation.html#cb31-1"></a>cats_n_dogs &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&#39;https://raw.githubusercontent.com/angelgardt/hseuxlab-wlm2021/master/book/wlm2021-book/data/cats_n_dogs.csv&#39;</span>)</span></code></pre></div>
<pre><code>## 
## ── Column specification ────────────────────────────────────────────────────────
## cols(
##   id = col_double(),
##   species = col_character(),
##   size = col_character()
## )</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="correlation.html#cb33-1"></a><span class="kw">table</span>(cats_n_dogs<span class="op">$</span>species, cats_n_dogs<span class="op">$</span>size)</span></code></pre></div>
<pre><code>##      
##       big small
##   cat  17     8
##   dog  16     9</code></pre>
<p>По данной таблице можно рассчитать <strong>критерий согласия Пирсона (<span class="math inline">\(\chi^2\)</span>)</strong>:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="correlation.html#cb35-1"></a><span class="kw">chisq.test</span>(<span class="kw">table</span>(cats_n_dogs<span class="op">$</span>species, cats_n_dogs<span class="op">$</span>size))</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test with Yates&#39; continuity correction
## 
## data:  table(cats_n_dogs$species, cats_n_dogs$size)
## X-squared = 0, df = 1, p-value = 1</code></pre>
<p>Сам хи-квартар тестирует гипотезу о том, что между двумя категориальными переменными те связи. Он это делает путём сравнения теоретической и эмпирической таблицы частот.</p>
<p>Эмпирическую таблицу частот мы получаем по результатам наблюдений (то, что мы делаем с помощью функции <code>table()</code>):</p>
<table>
<thead>
<tr class="header">
<th align="center"></th>
<th align="center"><span class="math inline">\(X_1\)</span></th>
<th align="center"><span class="math inline">\(X_2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><span class="math inline">\(Y_1\)</span></td>
<td align="center"><span class="math inline">\(p_{X_1,Y_1} = a\)</span></td>
<td align="center"><span class="math inline">\(p_{X_2,Y_1} = b\)</span></td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(Y_2\)</span></td>
<td align="center"><span class="math inline">\(p_{X_1,Y_2} = c\)</span></td>
<td align="center"><span class="math inline">\(p_{X_2,Y_2} = d\)</span></td>
</tr>
</tbody>
</table>
<p>Далее вычисляются теоретические частоты:</p>
<table>
<thead>
<tr class="header">
<th align="center"></th>
<th align="center"><span class="math inline">\(X_1^*\)</span></th>
<th align="center"><span class="math inline">\(X_2^*\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><span class="math inline">\(Y_1^*\)</span></td>
<td align="center"><span class="math inline">\(\frac{a+b}{N}\)</span></td>
<td align="center"><span class="math inline">\(\frac{b+a}{N}\)</span></td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(Y_2^*\)</span></td>
<td align="center"><span class="math inline">\(\frac{c+d}{N}\)</span></td>
<td align="center"><span class="math inline">\(\frac{d+c}{N}\)</span></td>
</tr>
</tbody>
</table>
<p>где <span class="math inline">\(N = a + b + c + d\)</span>.</p>
<p>Затем считаются расхождения частот, которые суммируются и получается статистика <span class="math inline">\(\chi^2\)</span>:</p>
<p><span class="math display">\[
\chi^2 = \sum_{i,j} \frac{p_{X_i,Y_j} - p_{X_i^*,Y_j^*}}{p_{X_i^*,Y_j^*}}
\]</span></p>
<p>Статистика подчиняется распределению <span class="math inline">\(\chi^2\)</span>, и чем больше значение этой статистики, тем сильнее связаны признаки. В нашем случае мы получили значение 0, что говорит о абсолютном отсутствии связи между видом животного и его размером.</p>
<p>Но по значению <span class="math inline">\(\chi^2\)</span> сложно что-то сказать о силе связи, поэтому его нормируют следующим образом, чтобы получить значения от 0 до 1, которые можно интерпретироват аналогично коэффициенту корреляции:</p>
<p><span class="math display">\[
\phi = \sqrt{\frac{\chi^2}{N}}
\]</span></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="correlation.html#cb37-1"></a><span class="kw">sqrt</span>(</span>
<span id="cb37-2"><a href="correlation.html#cb37-2"></a>  <span class="kw">chisq.test</span>(<span class="kw">table</span>(cats_n_dogs<span class="op">$</span>species, cats_n_dogs<span class="op">$</span>size))<span class="op">$</span>statistic <span class="op">/</span><span class="st"> </span></span>
<span id="cb37-3"><a href="correlation.html#cb37-3"></a><span class="st">    </span><span class="kw">nrow</span>(cats_n_dogs)</span>
<span id="cb37-4"><a href="correlation.html#cb37-4"></a>)</span></code></pre></div>
<pre><code>## X-squared 
##         0</code></pre>
<p>Так как в нашем случае значение <span class="math inline">\(\chi^2\)</span> было 0, то и коэффициент <span class="math inline">\(\phi\)</span> мы получили 0.</p>
</div>
<div id="бисериальный-коэффициент-корреляции" class="section level3">
<h3><span class="header-section-number">16.5.2</span> Бисериальный коэффициент корреляции</h3>
<p>Этот коэффициент используется для вычисления корреляции между количественной (<span class="math inline">\(y\)</span>) и категориальной (<span class="math inline">\(x\)</span>) шкалой и рассчитывается следующим образом:</p>
<p><span class="math display">\[
r = \frac{\bar x_1 - \bar x_2}{s_y} \sqrt{\frac{n_1 n_2}{N(N-1)}},
\]</span>
где <span class="math inline">\(\bar x_1\)</span> — среднее по элементам переменной <span class="math inline">\(y\)</span> из группы <span class="math inline">\(x_1\)</span>, <span class="math inline">\(\bar x_2\)</span> — среднее по элементам <span class="math inline">\(y\)</span> из группы <span class="math inline">\(x_2\)</span>, <span class="math inline">\(s_y\)</span> — стандартное отклонение по переменной <span class="math inline">\(y\)</span>, <span class="math inline">\(n_1\)</span> — число элементов в группе <span class="math inline">\(x_1\)</span>, <span class="math inline">\(n_2\)</span> — число элементов в группе <span class="math inline">\(x_2\)</span>, <span class="math inline">\(N\)</span> — общее число элементов.</p>
<p>Важно отметить, что несмотря на то, что значение коэффициента может быть как положительным, так и отрицательным, это <em>не влияет на интерпретацию</em>. Это одно из исключений из общего правила.</p>
<p>В R его можно вычислить так:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="correlation.html#cb39-1"></a>ltm<span class="op">::</span><span class="kw">biserial.cor</span>(dehum<span class="op">$</span>GR_average, dehum<span class="op">$</span>SEX)</span></code></pre></div>
<pre><code>## [1] -0.01406144</code></pre>
</div>
<div id="рангово-бисериальный-коэффициент-корреляции" class="section level3">
<h3><span class="header-section-number">16.5.3</span> Рангово-бисериальный коэффициент корреляции</h3>
<p>Если у нас не количественная, а ранговая шкала, то применяется рангово-бисериальный коэффициент:</p>
<p><span class="math display">\[
r = \frac{2(\bar x_1 - \bar x_2)}{N},
\]</span>
где <span class="math inline">\(\bar x_1\)</span> — средний ранг в группе <span class="math inline">\(x_1\)</span>, <span class="math inline">\(\bar x_2\)</span> — средний ранг в группе <span class="math inline">\(\x_2\)</span>, <span class="math inline">\(N\)</span> — общее количество наблюдений.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="correlation.html#cb41-1"></a>polycor<span class="op">::</span><span class="kw">polyserial</span>(dehum<span class="op">$</span>DP, dehum<span class="op">$</span>SEX)</span></code></pre></div>
<pre><code>## [1] 0.0530944</code></pre>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>Вы точно видели это словосочетание, когда сталкивались с линейной регресией.<a href="correlation.html#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="descriptives.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="simple-linear.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["wlm2021-book.pdf", "wlm2021-book.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>

<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7 Предобработка данных. Концепция tidy data | HSE UX LAB | Анализ данных + R: мир линейных моделей | Book</title>
  <meta name="description" content="Книга написана для слушателей курса по анализу данных от HSE UX LAB" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="7 Предобработка данных. Концепция tidy data | HSE UX LAB | Анализ данных + R: мир линейных моделей | Book" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Книга написана для слушателей курса по анализу данных от HSE UX LAB" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7 Предобработка данных. Концепция tidy data | HSE UX LAB | Анализ данных + R: мир линейных моделей | Book" />
  
  <meta name="twitter:description" content="Книга написана для слушателей курса по анализу данных от HSE UX LAB" />
  

<meta name="author" content="А. Ангельгардт" />


<meta name="date" content="2021-01-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="realdata.html"/>
<link rel="next" href="visualization.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="">HSE UX LAB | WLM 2021</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#благодарности"><i class="fa fa-check"></i>Благодарности</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#условные-обозначения"><i class="fa fa-check"></i>Условные обозначения</a></li>
</ul></li>
<li class="part"><span><b>I R programming</b></span></li>
<li class="chapter" data-level="1" data-path="Rintro.html"><a href="Rintro.html"><i class="fa fa-check"></i><b>1</b> Знакомство с R и RStudio</a><ul>
<li class="chapter" data-level="1.1" data-path="Rintro.html"><a href="Rintro.html#что-это-и-откуда"><i class="fa fa-check"></i><b>1.1</b> Что это и откуда?</a></li>
<li class="chapter" data-level="1.2" data-path="Rintro.html"><a href="Rintro.html#whyr"><i class="fa fa-check"></i><b>1.2</b> Почему R?</a><ul>
<li class="chapter" data-level="1.2.1" data-path="Rintro.html"><a href="Rintro.html#а-он-лучше-питона"><i class="fa fa-check"></i><b>1.2.1</b> А он лучше Питона?</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="Rintro.html"><a href="Rintro.html#установка-r-и-rstudio"><i class="fa fa-check"></i><b>1.3</b> Установка R и RStudio</a><ul>
<li class="chapter" data-level="1.3.1" data-path="Rintro.html"><a href="Rintro.html#а-зачем-обе-штуки-ставить"><i class="fa fa-check"></i><b>1.3.1</b> А зачем обе штуки ставить?</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="Rintro.html"><a href="Rintro.html#где-спросить-вопрос-или-искать-ответ"><i class="fa fa-check"></i><b>1.4</b> Где спросить вопрос или искать ответ?</a></li>
<li class="chapter" data-level="1.5" data-path="Rintro.html"><a href="Rintro.html#интерфейс-r"><i class="fa fa-check"></i><b>1.5</b> Интерфейс R</a></li>
<li class="chapter" data-level="1.6" data-path="Rintro.html"><a href="Rintro.html#интерфейс-rstudio"><i class="fa fa-check"></i><b>1.6</b> Интерфейс RStudio</a><ul>
<li class="chapter" data-level="1.6.1" data-path="Rintro.html"><a href="Rintro.html#console"><i class="fa fa-check"></i><b>1.6.1</b> Console</a></li>
<li class="chapter" data-level="1.6.2" data-path="Rintro.html"><a href="Rintro.html#code-editor"><i class="fa fa-check"></i><b>1.6.2</b> Code Editor</a></li>
<li class="chapter" data-level="1.6.3" data-path="Rintro.html"><a href="Rintro.html#environment-workspace-и-history"><i class="fa fa-check"></i><b>1.6.3</b> Environment (Workspace) и History</a></li>
<li class="chapter" data-level="1.6.4" data-path="Rintro.html"><a href="Rintro.html#plots-files-packages-help-viewer"><i class="fa fa-check"></i><b>1.6.4</b> Plots, Files, Packages, Help, Viewer</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="Rintro.html"><a href="Rintro.html#r-как-калькулятор"><i class="fa fa-check"></i><b>1.7</b> R как калькулятор</a><ul>
<li class="chapter" data-level="1.7.1" data-path="Rintro.html"><a href="Rintro.html#арифметические-операции"><i class="fa fa-check"></i><b>1.7.1</b> Арифметические операции</a></li>
<li class="chapter" data-level="1.7.2" data-path="Rintro.html"><a href="Rintro.html#funcs"><i class="fa fa-check"></i><b>1.7.2</b> Функции</a></li>
<li class="chapter" data-level="1.7.3" data-path="Rintro.html"><a href="Rintro.html#сравнение-и-логические-операции"><i class="fa fa-check"></i><b>1.7.3</b> Сравнение и логические операции</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="Rintro.html"><a href="Rintro.html#assignment-и-переменные"><i class="fa fa-check"></i><b>1.8</b> Assignment и переменные</a></li>
<li class="chapter" data-level="1.9" data-path="Rintro.html"><a href="Rintro.html#wd"><i class="fa fa-check"></i><b>1.9</b> Рабочая директория. Projects</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="datatypes.html"><a href="datatypes.html"><i class="fa fa-check"></i><b>2</b> Типы данных</a><ul>
<li class="chapter" data-level="2.1" data-path="datatypes.html"><a href="datatypes.html#numeric"><i class="fa fa-check"></i><b>2.1</b> <code>numeric</code></a></li>
<li class="chapter" data-level="2.2" data-path="datatypes.html"><a href="datatypes.html#logical"><i class="fa fa-check"></i><b>2.2</b> <code>logical</code></a></li>
<li class="chapter" data-level="2.3" data-path="datatypes.html"><a href="datatypes.html#character"><i class="fa fa-check"></i><b>2.3</b> <code>character</code></a></li>
<li class="chapter" data-level="2.4" data-path="datatypes.html"><a href="datatypes.html#factors"><i class="fa fa-check"></i><b>2.4</b> <code>factor</code></a></li>
<li class="chapter" data-level="2.5" data-path="datatypes.html"><a href="datatypes.html#coercion-part-one"><i class="fa fa-check"></i><b>2.5</b> Coercion [part one]</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="datastructures.html"><a href="datastructures.html"><i class="fa fa-check"></i><b>3</b> Структуры данных</a><ul>
<li class="chapter" data-level="3.1" data-path="datastructures.html"><a href="datastructures.html#векторы"><i class="fa fa-check"></i><b>3.1</b> Векторы</a><ul>
<li class="chapter" data-level="3.1.1" data-path="datastructures.html"><a href="datastructures.html#coercion-part-two"><i class="fa fa-check"></i><b>3.1.1</b> Coercion [part two]</a></li>
<li class="chapter" data-level="3.1.2" data-path="datastructures.html"><a href="datastructures.html#генерация-числовых-последовательностей"><i class="fa fa-check"></i><b>3.1.2</b> Генерация числовых последовательностей</a></li>
<li class="chapter" data-level="3.1.3" data-path="datastructures.html"><a href="datastructures.html#операции-с-векторами"><i class="fa fa-check"></i><b>3.1.3</b> Операции с векторами</a></li>
<li class="chapter" data-level="3.1.4" data-path="datastructures.html"><a href="datastructures.html#recycling"><i class="fa fa-check"></i><b>3.1.4</b> Recycling</a></li>
<li class="chapter" data-level="3.1.5" data-path="datastructures.html"><a href="datastructures.html#индексация-векторов"><i class="fa fa-check"></i><b>3.1.5</b> Индексация векторов</a></li>
<li class="chapter" data-level="3.1.6" data-path="datastructures.html"><a href="datastructures.html#na-nan-null"><i class="fa fa-check"></i><b>3.1.6</b> NA, NaN, NULL</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="datastructures.html"><a href="datastructures.html#матрицы"><i class="fa fa-check"></i><b>3.2</b> Матрицы</a><ul>
<li class="chapter" data-level="3.2.1" data-path="datastructures.html"><a href="datastructures.html#индексация-матриц"><i class="fa fa-check"></i><b>3.2.1</b> Индексация матриц</a></li>
<li class="chapter" data-level="3.2.2" data-path="datastructures.html"><a href="datastructures.html#операции-в-матрицами"><i class="fa fa-check"></i><b>3.2.2</b> Операции в матрицами</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="datastructures.html"><a href="datastructures.html#списки"><i class="fa fa-check"></i><b>3.3</b> Списки</a><ul>
<li class="chapter" data-level="3.3.1" data-path="datastructures.html"><a href="datastructures.html#индексация-списков"><i class="fa fa-check"></i><b>3.3.1</b> Индексация списков</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="datastructures.html"><a href="datastructures.html#датафреймы"><i class="fa fa-check"></i><b>3.4</b> Датафреймы</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>4</b> Функции</a><ul>
<li class="chapter" data-level="4.1" data-path="functions.html"><a href="functions.html#открытый-исходный-код"><i class="fa fa-check"></i><b>4.1</b> Открытый исходный код</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="strings.html"><a href="strings.html"><i class="fa fa-check"></i><b>5</b> Строки</a><ul>
<li class="chapter" data-level="5.1" data-path="strings.html"><a href="strings.html#установка-дополнительных-пакетов"><i class="fa fa-check"></i><b>5.1</b> Установка дополнительных пакетов</a></li>
<li class="chapter" data-level="5.2" data-path="strings.html"><a href="strings.html#создание-строк"><i class="fa fa-check"></i><b>5.2</b> Создание строк</a></li>
<li class="chapter" data-level="5.3" data-path="strings.html"><a href="strings.html#конкатенация-строк"><i class="fa fa-check"></i><b>5.3</b> Конкатенация строк</a></li>
<li class="chapter" data-level="5.4" data-path="strings.html"><a href="strings.html#разделение-строк"><i class="fa fa-check"></i><b>5.4</b> Разделение строк</a></li>
<li class="chapter" data-level="5.5" data-path="strings.html"><a href="strings.html#сортировка-строк"><i class="fa fa-check"></i><b>5.5</b> Сортировка строк</a></li>
<li class="chapter" data-level="5.6" data-path="strings.html"><a href="strings.html#изменение-регистра"><i class="fa fa-check"></i><b>5.6</b> Изменение регистра</a></li>
<li class="chapter" data-level="5.7" data-path="strings.html"><a href="strings.html#поиск-подстроки"><i class="fa fa-check"></i><b>5.7</b> Поиск подстроки</a></li>
<li class="chapter" data-level="5.8" data-path="strings.html"><a href="strings.html#изменение-строк"><i class="fa fa-check"></i><b>5.8</b> Изменение строк</a><ul>
<li class="chapter" data-level="5.8.1" data-path="strings.html"><a href="strings.html#выделение-подстроки"><i class="fa fa-check"></i><b>5.8.1</b> Выделение подстроки</a></li>
<li class="chapter" data-level="5.8.2" data-path="strings.html"><a href="strings.html#замена-подстроки"><i class="fa fa-check"></i><b>5.8.2</b> Замена подстроки</a></li>
<li class="chapter" data-level="5.8.3" data-path="strings.html"><a href="strings.html#удаление-подстроки"><i class="fa fa-check"></i><b>5.8.3</b> Удаление подстроки</a></li>
<li class="chapter" data-level="5.8.4" data-path="strings.html"><a href="strings.html#транслитерация-строк"><i class="fa fa-check"></i><b>5.8.4</b> Транслитерация строк</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="strings.html"><a href="strings.html#регулярные-выражения"><i class="fa fa-check"></i><b>5.9</b> Регулярные выражения</a><ul>
<li class="chapter" data-level="5.9.1" data-path="strings.html"><a href="strings.html#метасимволы"><i class="fa fa-check"></i><b>5.9.1</b> Метасимволы</a></li>
<li class="chapter" data-level="5.9.2" data-path="strings.html"><a href="strings.html#классы-знаков"><i class="fa fa-check"></i><b>5.9.2</b> Классы знаков</a></li>
<li class="chapter" data-level="5.9.3" data-path="strings.html"><a href="strings.html#quant"><i class="fa fa-check"></i><b>5.9.3</b> Квантификация</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="realdata.html"><a href="realdata.html"><i class="fa fa-check"></i><b>6</b> Работа с реальными данными</a><ul>
<li class="chapter" data-level="6.1" data-path="realdata.html"><a href="realdata.html#рабочая-директория"><i class="fa fa-check"></i><b>6.1</b> Рабочая директория</a></li>
<li class="chapter" data-level="6.2" data-path="realdata.html"><a href="realdata.html#импорт-данных"><i class="fa fa-check"></i><b>6.2</b> Импорт данных</a><ul>
<li class="chapter" data-level="6.2.1" data-path="realdata.html"><a href="realdata.html#форматы-данных"><i class="fa fa-check"></i><b>6.2.1</b> Форматы данных</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="realdata.html"><a href="realdata.html#исследование-данных"><i class="fa fa-check"></i><b>6.3</b> Исследование данных</a></li>
<li class="chapter" data-level="6.4" data-path="realdata.html"><a href="realdata.html#файл-.rdata"><i class="fa fa-check"></i><b>6.4</b> Файл <code>.RData</code></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="tidy.html"><a href="tidy.html"><i class="fa fa-check"></i><b>7</b> Предобработка данных. Концепция tidy data</a><ul>
<li class="chapter" data-level="7.1" data-path="tidy.html"><a href="tidy.html#tidyverse"><i class="fa fa-check"></i><b>7.1</b> <code>tidyverse</code></a></li>
<li class="chapter" data-level="7.2" data-path="tidy.html"><a href="tidy.html#импорт-данных-1"><i class="fa fa-check"></i><b>7.2</b> Импорт данных</a></li>
<li class="chapter" data-level="7.3" data-path="tidy.html"><a href="tidy.html#tibble"><i class="fa fa-check"></i><b>7.3</b> <code>tibble</code></a></li>
<li class="chapter" data-level="7.4" data-path="tidy.html"><a href="tidy.html#грузим-много-данных"><i class="fa fa-check"></i><b>7.4</b> Грузим много данных</a></li>
<li class="chapter" data-level="7.5" data-path="tidy.html"><a href="tidy.html#сабсет-данных"><i class="fa fa-check"></i><b>7.5</b> Сабсет данных</a><ul>
<li class="chapter" data-level="7.5.1" data-path="tidy.html"><a href="tidy.html#pipe"><i class="fa fa-check"></i><b>7.5.1</b> <code>%&gt;%</code></a></li>
<li class="chapter" data-level="7.5.2" data-path="tidy.html"><a href="tidy.html#select"><i class="fa fa-check"></i><b>7.5.2</b> <code>select()</code></a></li>
<li class="chapter" data-level="7.5.3" data-path="tidy.html"><a href="tidy.html#rename"><i class="fa fa-check"></i><b>7.5.3</b> <code>rename()</code></a></li>
<li class="chapter" data-level="7.5.4" data-path="tidy.html"><a href="tidy.html#slice"><i class="fa fa-check"></i><b>7.5.4</b> <code>slice()</code></a></li>
<li class="chapter" data-level="7.5.5" data-path="tidy.html"><a href="tidy.html#filter"><i class="fa fa-check"></i><b>7.5.5</b> <code>filter()</code></a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="tidy.html"><a href="tidy.html#mutate"><i class="fa fa-check"></i><b>7.6</b> <code>mutate()</code></a></li>
<li class="chapter" data-level="7.7" data-path="tidy.html"><a href="tidy.html#догрузим-остальные-данные"><i class="fa fa-check"></i><b>7.7</b> Догрузим остальные данные</a><ul>
<li class="chapter" data-level="7.7.1" data-path="tidy.html"><a href="tidy.html#соединение-датафреймов-i"><i class="fa fa-check"></i><b>7.7.1</b> Соединение датафреймов I</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="tidy.html"><a href="tidy.html#сортировка"><i class="fa fa-check"></i><b>7.8</b> Сортировка</a><ul>
<li class="chapter" data-level="7.8.1" data-path="tidy.html"><a href="tidy.html#sort"><i class="fa fa-check"></i><b>7.8.1</b> <code>sort()</code></a></li>
<li class="chapter" data-level="7.8.2" data-path="tidy.html"><a href="tidy.html#arrange"><i class="fa fa-check"></i><b>7.8.2</b> <code>arrange()</code></a></li>
<li class="chapter" data-level="7.8.3" data-path="tidy.html"><a href="tidy.html#distinct"><i class="fa fa-check"></i><b>7.8.3</b> <code>distinct()</code></a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="tidy.html"><a href="tidy.html#соединение-датафреймов-ii"><i class="fa fa-check"></i><b>7.9</b> Соединение датафреймов II</a><ul>
<li class="chapter" data-level="7.9.1" data-path="tidy.html"><a href="tidy.html#join"><i class="fa fa-check"></i><b>7.9.1</b> <code>..._join()</code></a></li>
</ul></li>
<li class="chapter" data-level="7.10" data-path="tidy.html"><a href="tidy.html#группировка-и-аггрегация-данных"><i class="fa fa-check"></i><b>7.10</b> Группировка и аггрегация данных</a><ul>
<li class="chapter" data-level="7.10.1" data-path="tidy.html"><a href="tidy.html#group_by-ungroup"><i class="fa fa-check"></i><b>7.10.1</b> <code>group_by()</code> &amp; <code>ungroup()</code></a></li>
<li class="chapter" data-level="7.10.2" data-path="tidy.html"><a href="tidy.html#summarize"><i class="fa fa-check"></i><b>7.10.2</b> <code>summarize()</code></a></li>
</ul></li>
<li class="chapter" data-level="7.11" data-path="tidy.html"><a href="tidy.html#широкий-и-длинный-формат"><i class="fa fa-check"></i><b>7.11</b> Широкий и длинный формат</a><ul>
<li class="chapter" data-level="7.11.1" data-path="tidy.html"><a href="tidy.html#pivot_longer-pivot_wider"><i class="fa fa-check"></i><b>7.11.1</b> <code>pivot_longer()</code> &amp; <code>pivot_wider()</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="visualization.html"><a href="visualization.html"><i class="fa fa-check"></i><b>8</b> Визуализация данных</a><ul>
<li class="chapter" data-level="8.1" data-path="visualization.html"><a href="visualization.html#философия-ggplot2-a-layered-grammar-of-graphics"><i class="fa fa-check"></i><b>8.1</b> Философия ggplot2 (A Layered Grammar of Graphics)</a><ul>
<li class="chapter" data-level="8.1.1" data-path="visualization.html"><a href="visualization.html#собственно-к-философии-построения-графиков"><i class="fa fa-check"></i><b>8.1.1</b> Собственно к философии построения графиков</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="visualization.html"><a href="visualization.html#данные"><i class="fa fa-check"></i><b>8.2</b> Данные</a></li>
<li class="chapter" data-level="8.3" data-path="visualization.html"><a href="visualization.html#строим-базовый-график"><i class="fa fa-check"></i><b>8.3</b> Строим базовый график</a><ul>
<li class="chapter" data-level="8.3.1" data-path="visualization.html"><a href="visualization.html#базовый-слой"><i class="fa fa-check"></i><b>8.3.1</b> Базовый слой</a></li>
<li class="chapter" data-level="8.3.2" data-path="visualization.html"><a href="visualization.html#разметка-осей-и-переменные"><i class="fa fa-check"></i><b>8.3.2</b> Разметка осей и переменные</a></li>
<li class="chapter" data-level="8.3.3" data-path="visualization.html"><a href="visualization.html#геомы"><i class="fa fa-check"></i><b>8.3.3</b> Геомы</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="visualization.html"><a href="visualization.html#группировка-по-переменной"><i class="fa fa-check"></i><b>8.4</b> Группировка по переменной</a></li>
<li class="chapter" data-level="8.5" data-path="visualization.html"><a href="visualization.html#графики-со-встроенной-статистической-обработкой"><i class="fa fa-check"></i><b>8.5</b> Графики со встроенной статистической обработкой</a><ul>
<li class="chapter" data-level="8.5.1" data-path="visualization.html"><a href="visualization.html#статы-stat_"><i class="fa fa-check"></i><b>8.5.1</b> Статы (stat_)</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="visualization.html"><a href="visualization.html#ищем-более-сложные-закономерности"><i class="fa fa-check"></i><b>8.6</b> Ищем более сложные закономерности</a></li>
<li class="chapter" data-level="8.7" data-path="visualization.html"><a href="visualization.html#настраиваем-график"><i class="fa fa-check"></i><b>8.7</b> Настраиваем график</a><ul>
<li class="chapter" data-level="8.7.1" data-path="visualization.html"><a href="visualization.html#темы"><i class="fa fa-check"></i><b>8.7.1</b> Темы</a></li>
<li class="chapter" data-level="8.7.2" data-path="visualization.html"><a href="visualization.html#кастомизация-шкал-scale_"><i class="fa fa-check"></i><b>8.7.2</b> Кастомизация шкал (scale_)</a></li>
<li class="chapter" data-level="8.7.3" data-path="visualization.html"><a href="visualization.html#последние-штрихи"><i class="fa fa-check"></i><b>8.7.3</b> Последние штрихи</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="visualization.html"><a href="visualization.html#больше-переменных"><i class="fa fa-check"></i><b>8.8</b> Больше переменных</a><ul>
<li class="chapter" data-level="8.8.1" data-path="visualization.html"><a href="visualization.html#фасетизация"><i class="fa fa-check"></i><b>8.8.1</b> Фасетизация</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="visualization.html"><a href="visualization.html#сохранение-графиков"><i class="fa fa-check"></i><b>8.9</b> Сохранение графиков</a></li>
<li class="chapter" data-level="8.10" data-path="visualization.html"><a href="visualization.html#другие-геомы"><i class="fa fa-check"></i><b>8.10</b> Другие геомы</a></li>
</ul></li>
<li class="part"><span><b>II Теория вероятностей и математическая статистика</b></span></li>
<li class="chapter" data-level="9" data-path="maths.html"><a href="maths.html"><i class="fa fa-check"></i><b>9</b> Математический ликбез</a><ul>
<li class="chapter" data-level="9.1" data-path="maths.html"><a href="maths.html#alg_logic"><i class="fa fa-check"></i><b>9.1</b> Элементы алгебры логики</a><ul>
<li class="chapter" data-level="9.1.1" data-path="maths.html"><a href="maths.html#высказывания"><i class="fa fa-check"></i><b>9.1.1</b> Высказывания</a></li>
<li class="chapter" data-level="9.1.2" data-path="maths.html"><a href="maths.html#logic_operations"><i class="fa fa-check"></i><b>9.1.2</b> Логические операции</a></li>
<li class="chapter" data-level="9.1.3" data-path="maths.html"><a href="maths.html#сложные-высказвания"><i class="fa fa-check"></i><b>9.1.3</b> Сложные высказвания</a></li>
<li class="chapter" data-level="9.1.4" data-path="maths.html"><a href="maths.html#условные-высказывания"><i class="fa fa-check"></i><b>9.1.4</b> Условные высказывания</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="maths.html"><a href="maths.html#set_theory"><i class="fa fa-check"></i><b>9.2</b> Элементы теории множеств</a><ul>
<li class="chapter" data-level="9.2.1" data-path="maths.html"><a href="maths.html#set"><i class="fa fa-check"></i><b>9.2.1</b> Множество</a></li>
<li class="chapter" data-level="9.2.2" data-path="maths.html"><a href="maths.html#sets_operations"><i class="fa fa-check"></i><b>9.2.2</b> Операции над множествами</a></li>
<li class="chapter" data-level="9.2.3" data-path="maths.html"><a href="maths.html#отображения"><i class="fa fa-check"></i><b>9.2.3</b> Отображения</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="maths.html"><a href="maths.html#combinatorics"><i class="fa fa-check"></i><b>9.3</b> Немного комбинаторики</a><ul>
<li class="chapter" data-level="9.3.1" data-path="maths.html"><a href="maths.html#permutations"><i class="fa fa-check"></i><b>9.3.1</b> Перестановки</a></li>
<li class="chapter" data-level="9.3.2" data-path="maths.html"><a href="maths.html#accomodations"><i class="fa fa-check"></i><b>9.3.2</b> Размещения</a></li>
<li class="chapter" data-level="9.3.3" data-path="maths.html"><a href="maths.html#combinations"><i class="fa fa-check"></i><b>9.3.3</b> Сочетания</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="maths.html"><a href="maths.html#calculus"><i class="fa fa-check"></i><b>9.4</b> Элементы математического анализа</a><ul>
<li class="chapter" data-level="9.4.1" data-path="maths.html"><a href="maths.html#последовательность"><i class="fa fa-check"></i><b>9.4.1</b> Последовательность</a></li>
<li class="chapter" data-level="9.4.2" data-path="maths.html"><a href="maths.html#предел-последовательности"><i class="fa fa-check"></i><b>9.4.2</b> Предел последовательности</a></li>
<li class="chapter" data-level="9.4.3" data-path="maths.html"><a href="maths.html#функции"><i class="fa fa-check"></i><b>9.4.3</b> Функции</a></li>
<li class="chapter" data-level="9.4.4" data-path="maths.html"><a href="maths.html#дифференцируемость-функции.-производная"><i class="fa fa-check"></i><b>9.4.4</b> Дифференцируемость функции. Производная</a></li>
<li class="chapter" data-level="9.4.5" data-path="maths.html"><a href="maths.html#функции-нескольких-переменных"><i class="fa fa-check"></i><b>9.4.5</b> Функции нескольких переменных</a></li>
<li class="chapter" data-level="9.4.6" data-path="maths.html"><a href="maths.html#частные-производные"><i class="fa fa-check"></i><b>9.4.6</b> Частные производные</a></li>
<li class="chapter" data-level="9.4.7" data-path="maths.html"><a href="maths.html#интеграл"><i class="fa fa-check"></i><b>9.4.7</b> Интеграл</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="maths.html"><a href="maths.html#matrix"><i class="fa fa-check"></i><b>9.5</b> Элементы линейной алгебры</a><ul>
<li class="chapter" data-level="9.5.1" data-path="maths.html"><a href="maths.html#что-такое-матрица"><i class="fa fa-check"></i><b>9.5.1</b> Что такое матрица?</a></li>
<li class="chapter" data-level="9.5.2" data-path="maths.html"><a href="maths.html#откуда-берутся-матрицы"><i class="fa fa-check"></i><b>9.5.2</b> Откуда берутся матрицы?</a></li>
<li class="chapter" data-level="9.5.3" data-path="maths.html"><a href="maths.html#действия-с-матрицами"><i class="fa fa-check"></i><b>9.5.3</b> Действия с матрицами</a></li>
<li class="chapter" data-level="9.5.4" data-path="maths.html"><a href="maths.html#скалярное-произведение-векторов"><i class="fa fa-check"></i><b>9.5.4</b> Скалярное произведение векторов</a></li>
<li class="chapter" data-level="9.5.5" data-path="maths.html"><a href="maths.html#векторное-произведение-векторов"><i class="fa fa-check"></i><b>9.5.5</b> Векторное произведение векторов</a></li>
<li class="chapter" data-level="9.5.6" data-path="maths.html"><a href="maths.html#произведение-матриц-матричное-умножение"><i class="fa fa-check"></i><b>9.5.6</b> Произведение матриц (матричное умножение)</a></li>
<li class="chapter" data-level="9.5.7" data-path="maths.html"><a href="maths.html#транспонирование-матрицы"><i class="fa fa-check"></i><b>9.5.7</b> Транспонирование матрицы</a></li>
<li class="chapter" data-level="9.5.8" data-path="maths.html"><a href="maths.html#детерминант-и-обратная-матрица"><i class="fa fa-check"></i><b>9.5.8</b> Детерминант и обратная матрица</a></li>
<li class="chapter" data-level="9.5.9" data-path="maths.html"><a href="maths.html#след-матрицы"><i class="fa fa-check"></i><b>9.5.9</b> След матрицы</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="stats-intro.html"><a href="stats-intro.html"><i class="fa fa-check"></i><b>10</b> Введение в статистику</a><ul>
<li class="chapter" data-level="10.1" data-path="stats-intro.html"><a href="stats-intro.html#исходные-понятия-статистики"><i class="fa fa-check"></i><b>10.1</b> Исходные понятия статистики</a></li>
<li class="chapter" data-level="10.2" data-path="stats-intro.html"><a href="stats-intro.html#виды-статистических-данных"><i class="fa fa-check"></i><b>10.2</b> Виды статистических данных</a></li>
<li class="chapter" data-level="10.3" data-path="stats-intro.html"><a href="stats-intro.html#шкалы"><i class="fa fa-check"></i><b>10.3</b> Шкалы</a></li>
<li class="chapter" data-level="10.4" data-path="stats-intro.html"><a href="stats-intro.html#задачи-статистики"><i class="fa fa-check"></i><b>10.4</b> Задачи статистики</a><ul>
<li class="chapter" data-level="10.4.1" data-path="stats-intro.html"><a href="stats-intro.html#этапы-статистического-моделирования"><i class="fa fa-check"></i><b>10.4.1</b> Этапы статистического моделирования</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="randexp.html"><a href="randexp.html"><i class="fa fa-check"></i><b>11</b> Случайный эксперимент</a><ul>
<li class="chapter" data-level="11.1" data-path="randexp.html"><a href="randexp.html#ход-исследования"><i class="fa fa-check"></i><b>11.1</b> Ход исследования</a></li>
<li class="chapter" data-level="11.2" data-path="randexp.html"><a href="randexp.html#событие.-пространство-элементарных-событий."><i class="fa fa-check"></i><b>11.2</b> Событие. Пространство элементарных событий.</a><ul>
<li class="chapter" data-level="11.2.1" data-path="randexp.html"><a href="randexp.html#игральный-кубик"><i class="fa fa-check"></i><b>11.2.1</b> Игральный кубик</a></li>
<li class="chapter" data-level="11.2.2" data-path="randexp.html"><a href="randexp.html#events_operations"><i class="fa fa-check"></i><b>11.2.2</b> Действия над событиями</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="randexp.html"><a href="randexp.html#классическое-определение-вероятности"><i class="fa fa-check"></i><b>11.3</b> Классическое определение вероятности</a></li>
<li class="chapter" data-level="11.4" data-path="randexp.html"><a href="randexp.html#статистическое-определение-вероятности"><i class="fa fa-check"></i><b>11.4</b> Статистическое определение вероятности</a></li>
<li class="chapter" data-level="11.5" data-path="randexp.html"><a href="randexp.html#кроме-кубика"><i class="fa fa-check"></i><b>11.5</b> Кроме кубика</a></li>
<li class="chapter" data-level="11.6" data-path="randexp.html"><a href="randexp.html#вероятности-сложных-событий"><i class="fa fa-check"></i><b>11.6</b> Вероятности сложных событий</a><ul>
<li class="chapter" data-level="11.6.1" data-path="randexp.html"><a href="randexp.html#условная-вероятность"><i class="fa fa-check"></i><b>11.6.1</b> Условная вероятность</a></li>
<li class="chapter" data-level="11.6.2" data-path="randexp.html"><a href="randexp.html#теорема-байеса"><i class="fa fa-check"></i><b>11.6.2</b> Теорема Байеса</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="prob.html"><a href="prob.html"><i class="fa fa-check"></i><b>12</b> Вероятность и случайные величины</a><ul>
<li class="chapter" data-level="12.1" data-path="prob.html"><a href="prob.html#дискретные-случайные-величины"><i class="fa fa-check"></i><b>12.1</b> Дискретные случайные величины</a></li>
<li class="chapter" data-level="12.2" data-path="prob.html"><a href="prob.html#непрерывные-случайные-величины"><i class="fa fa-check"></i><b>12.2</b> Непрерывные случайные величины</a></li>
<li class="chapter" data-level="12.3" data-path="prob.html"><a href="prob.html#moments_distributions"><i class="fa fa-check"></i><b>12.3</b> Характеристики распределения случайных величин</a></li>
<li class="chapter" data-level="12.4" data-path="prob.html"><a href="prob.html#normal_distribution"><i class="fa fa-check"></i><b>12.4</b> Нормальное распределение</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="statestim.html"><a href="statestim.html"><i class="fa fa-check"></i><b>13</b> Оценивание параметров в практике статистического анализа</a><ul>
<li class="chapter" data-level="13.1" data-path="statestim.html"><a href="statestim.html#точечные-оценки"><i class="fa fa-check"></i><b>13.1</b> Точечные оценки</a><ul>
<li class="chapter" data-level="13.1.1" data-path="statestim.html"><a href="statestim.html#метод-моментов"><i class="fa fa-check"></i><b>13.1.1</b> Метод моментов</a></li>
<li class="chapter" data-level="13.1.2" data-path="statestim.html"><a href="statestim.html#свойства-точечных-оценок"><i class="fa fa-check"></i><b>13.1.2</b> Свойства точечных оценок</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="statestim.html"><a href="statestim.html#интервальные-оценки"><i class="fa fa-check"></i><b>13.2</b> Интервальные оценки</a><ul>
<li class="chapter" data-level="13.2.1" data-path="statestim.html"><a href="statestim.html#confinterval"><i class="fa fa-check"></i><b>13.2.1</b> Доверительный интервал</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="hypotheses.html"><a href="hypotheses.html"><i class="fa fa-check"></i><b>14</b> Тестирование статистических гипотез</a></li>
<li class="part"><span><b>III Анализ данных</b></span></li>
<li class="chapter" data-level="15" data-path="descriptives.html"><a href="descriptives.html"><i class="fa fa-check"></i><b>15</b> Описательные статистики</a><ul>
<li class="chapter" data-level="15.1" data-path="descriptives.html"><a href="descriptives.html#меры-центральной-тенденции"><i class="fa fa-check"></i><b>15.1</b> Меры центральной тенденции</a><ul>
<li class="chapter" data-level="15.1.1" data-path="descriptives.html"><a href="descriptives.html#мода"><i class="fa fa-check"></i><b>15.1.1</b> Мода</a></li>
<li class="chapter" data-level="15.1.2" data-path="descriptives.html"><a href="descriptives.html#медиана"><i class="fa fa-check"></i><b>15.1.2</b> Медиана</a></li>
<li class="chapter" data-level="15.1.3" data-path="descriptives.html"><a href="descriptives.html#среднее"><i class="fa fa-check"></i><b>15.1.3</b> Среднее</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="descriptives.html"><a href="descriptives.html#меры-разброса"><i class="fa fa-check"></i><b>15.2</b> Меры разброса</a><ul>
<li class="chapter" data-level="15.2.1" data-path="descriptives.html"><a href="descriptives.html#минимум-и-максимум"><i class="fa fa-check"></i><b>15.2.1</b> Минимум и максимум</a></li>
<li class="chapter" data-level="15.2.2" data-path="descriptives.html"><a href="descriptives.html#размах"><i class="fa fa-check"></i><b>15.2.2</b> Размах</a></li>
<li class="chapter" data-level="15.2.3" data-path="descriptives.html"><a href="descriptives.html#дисперсия"><i class="fa fa-check"></i><b>15.2.3</b> Дисперсия</a></li>
<li class="chapter" data-level="15.2.4" data-path="descriptives.html"><a href="descriptives.html#стандартное-отклонение"><i class="fa fa-check"></i><b>15.2.4</b> Стандартное отклонение</a></li>
<li class="chapter" data-level="15.2.5" data-path="descriptives.html"><a href="descriptives.html#стандартная-ошибка-среднего"><i class="fa fa-check"></i><b>15.2.5</b> Стандартная ошибка среднего</a></li>
<li class="chapter" data-level="15.2.6" data-path="descriptives.html"><a href="descriptives.html#квантили"><i class="fa fa-check"></i><b>15.2.6</b> Квантили</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="descriptives.html"><a href="descriptives.html#асимметрия"><i class="fa fa-check"></i><b>15.3</b> Асимметрия</a></li>
<li class="chapter" data-level="15.4" data-path="descriptives.html"><a href="descriptives.html#эксцесс"><i class="fa fa-check"></i><b>15.4</b> Эксцесс</a></li>
<li class="chapter" data-level="15.5" data-path="descriptives.html"><a href="descriptives.html#описательные-статистики-в-r"><i class="fa fa-check"></i><b>15.5</b> Описательные статистики в R</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="correlation.html"><a href="correlation.html"><i class="fa fa-check"></i><b>16</b> Корреляционный анализ</a><ul>
<li class="chapter" data-level="16.1" data-path="correlation.html"><a href="correlation.html#ковариация"><i class="fa fa-check"></i><b>16.1</b> Ковариация</a></li>
<li class="chapter" data-level="16.2" data-path="correlation.html"><a href="correlation.html#корреляция"><i class="fa fa-check"></i><b>16.2</b> Корреляция</a><ul>
<li class="chapter" data-level="16.2.1" data-path="correlation.html"><a href="correlation.html#тестирование-статистической-значимости-коэффициента-корреляции"><i class="fa fa-check"></i><b>16.2.1</b> Тестирование статистической значимости коэффициента корреляции</a></li>
<li class="chapter" data-level="16.2.2" data-path="correlation.html"><a href="correlation.html#доверительный-интервал-для-коэффициента-корреляции"><i class="fa fa-check"></i><b>16.2.2</b> Доверительный интервал для коэффициента корреляции</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="simple-linear.html"><a href="simple-linear.html"><i class="fa fa-check"></i><b>17</b> Общие линейные модели. Простая линейная регрессия</a></li>
<li class="chapter" data-level="18" data-path="multiple-linear.html"><a href="multiple-linear.html"><i class="fa fa-check"></i><b>18</b> Множественная линейная регрессия</a></li>
<li class="chapter" data-level="19" data-path="anova.html"><a href="anova.html"><i class="fa fa-check"></i><b>19</b> Дисперсионный анализ</a></li>
<li class="chapter" data-level="20" data-path="ancova.html"><a href="ancova.html"><i class="fa fa-check"></i><b>20</b> Ковариационный анализ</a></li>
<li class="chapter" data-level="21" data-path="logistic.html"><a href="logistic.html"><i class="fa fa-check"></i><b>21</b> Обобщенные линейные модели. Логистическая регрессия</a></li>
<li class="chapter" data-level="22" data-path="poisson.html"><a href="poisson.html"><i class="fa fa-check"></i><b>22</b> Пуассоновская регрессия</a></li>
<li class="chapter" data-level="23" data-path="regularization.html"><a href="regularization.html"><i class="fa fa-check"></i><b>23</b> Регуляризация регрессии</a></li>
<li class="chapter" data-level="24" data-path="glmm.html"><a href="glmm.html"><i class="fa fa-check"></i><b>24</b> Смешанные линейные модели</a></li>
<li class="chapter" data-level="25" data-path="cluster.html"><a href="cluster.html"><i class="fa fa-check"></i><b>25</b> Кластерный анализ</a></li>
<li class="chapter" data-level="26" data-path="pca.html"><a href="pca.html"><i class="fa fa-check"></i><b>26</b> Анализ главных компонент</a></li>
<li class="chapter" data-level="27" data-path="efa.html"><a href="efa.html"><i class="fa fa-check"></i><b>27</b> Эксплораторный факторный анализ</a></li>
<li class="chapter" data-level="28" data-path="cfa.html"><a href="cfa.html"><i class="fa fa-check"></i><b>28</b> Конфирматорный факторный анализ</a></li>
<li class="chapter" data-level="29" data-path="further.html"><a href="further.html"><i class="fa fa-check"></i><b>29</b> Что дальше?</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>Литература</a><ul>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#касаемо-математики"><i class="fa fa-check"></i>Касаемо математики</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#относительно-статистики"><i class="fa fa-check"></i>Относительно статистики</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#about-r"><i class="fa fa-check"></i>About R</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#во-славу-андана"><i class="fa fa-check"></i>Во славу андана</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">HSE UX LAB | Анализ данных + R: мир линейных моделей | Book</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="tidy" class="section level1">
<h1><span class="header-section-number">7</span> Предобработка данных. Концепция tidy data</h1>
<p>Мы приступаем к одной из ключевых тем курса — предобработка данных. И это тему мы будем осваивать c помощью семейства пакетов <code>tidyverse</code>.</p>
<div id="tidyverse" class="section level2">
<h2><span class="header-section-number">7.1</span> <code>tidyverse</code></h2>
<p>Чтобы преуспеть в этом деле, нам надо поставить себе на машину пакет с пакетами:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="tidy.html#cb1-1"></a><span class="kw">install.packages</span>(<span class="st">&#39;tidyverse&#39;</span>, <span class="dt">dependencies =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p>Какие пакеты внутри пакета?</p>
<ul>
<li><code>ggplot2</code> — для визуализации</li>
<li><code>tibble</code> — для работы с тибблами (как датафрейм, только лучше)</li>
<li><code>tidyr</code> — для формата <em>tidy data</em></li>
<li><code>readr</code> — для чтения файлов</li>
<li><code>purrr</code> — для функционального программирования</li>
<li><code>dplyr</code> — для преобразования данных</li>
<li><code>stringr</code> — для работы со строковыми переменными (с ним мы уже виделись)</li>
<li><code>forcats</code> — для работы с факторными переменными</li>
</ul>
<p>Кроме этого джентельменского набора нам еще пригодится пакет <code>readxl</code>, и которого мы будем брать функции для чтения файлов <code>.xls</code> и <code>.xlsx</code>.</p>
<p>Подключаем пакеты к сессии:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="tidy.html#cb2-1"></a><span class="kw">library</span>(tidyverse)</span></code></pre></div>
<pre><code>## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.0 ──</code></pre>
<pre><code>## ✓ ggplot2 3.3.2     ✓ purrr   0.3.4
## ✓ tibble  3.0.4     ✓ dplyr   1.0.2
## ✓ tidyr   1.1.2     ✓ stringr 1.4.0
## ✓ readr   1.4.0     ✓ forcats 0.5.0</code></pre>
<pre><code>## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<p>Нам написали верси пакетов, которые мы подгрузили, а также обозначили ряд конфликтов, которые произошли — базовые функции перекрылись функциями из внешних пакетов<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>. Но это всё можно игнорировать.</p>
</div>
<div id="импорт-данных-1" class="section level2">
<h2><span class="header-section-number">7.2</span> Импорт данных</h2>
<p>Мы уже говорили с вами, что для импорта данных есть generic-функция <code>read.table()</code> и ещё ряд функций, которые адаптированы под конкретные форматы данных (<code>read.tsv()</code>, <code>read.csv()</code>). Это всё хорошо и приятно, но мы будем пользоваться их сестами-близнецами из пакета <code>readr</code>:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="tidy.html#cb6-1"></a><span class="kw">read_csv</span>(<span class="st">&quot;path/to/file&quot;</span>) <span class="co"># для чтения классических csv-файлов</span></span>
<span id="cb6-2"><a href="tidy.html#cb6-2"></a><span class="kw">read_csv2</span>(<span class="st">&quot;path/to/file&quot;</span>) <span class="co"># для чтения csv-файлов с разделителем точка в запятой</span></span>
<span id="cb6-3"><a href="tidy.html#cb6-3"></a><span class="kw">read_delim</span>(<span class="st">&quot;path/to/file&quot;</span>, <span class="dt">delim =</span> <span class="st">&quot;...&quot;</span>) <span class="co"># для чтения файлов с любым разделителем</span></span></code></pre></div>
<p>Эти функции, как и базовые, умеют открывать файлы</p>
<ul>
<li><em>только по имени</em> (если файл лежит в рабочей директории)</li>
<li><em>по относительному пути</em> (если файл лежит в подпапке рабочей директории)</li>
<li><em>по абсолютному пути</em> (когда мы прописываем путь к файлу от корня)</li>
<li><em>напрямую из интернета</em> (при наличии интернет-соединения)</li>
</ul>
<p>Каков профит? Во-первых, они работают быстрее, но на наших объемах данных мы этого, скорее всего, не заметим. А во-вторых, они считывают данные не в датафрейм, а в <code>tibble</code>, что очень радостно и приятно, если осознать, что <code>tibble</code> есть такое.</p>
</div>
<div id="tibble" class="section level2">
<h2><span class="header-section-number">7.3</span> <code>tibble</code></h2>
<p>Мы уже умеет работать с датафреймами, однако мы пока не сталкивались с некоторыми их особенностями. В частности, если мы попытаемся создать новую переменную на основе имеющейся прям при создании датафрейма, случится ошибка. Пусть у нас есть колонка с возрастом респондентов, и мы хотим сделать новый переменную, которая будет задавать контрастные группы:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="tidy.html#cb7-1"></a><span class="kw">data.frame</span>(<span class="dt">age =</span> <span class="kw">sample</span>(<span class="dv">18</span><span class="op">:</span><span class="dv">60</span>, <span class="dt">size =</span> <span class="dv">30</span>),</span>
<span id="cb7-2"><a href="tidy.html#cb7-2"></a>           <span class="dt">group =</span> <span class="kw">ifelse</span>(age <span class="op">&gt;</span><span class="st"> </span><span class="dv">40</span>, <span class="st">&#39;old&#39;</span>,</span>
<span id="cb7-3"><a href="tidy.html#cb7-3"></a>                          <span class="kw">ifelse</span>(age <span class="op">&lt;</span><span class="st"> </span><span class="dv">25</span>, <span class="st">&#39;young&#39;</span>, <span class="st">&#39;middle&#39;</span>)))</span></code></pre></div>
<pre><code>## Error in ifelse(age &gt; 40, &quot;old&quot;, ifelse(age &lt; 25, &quot;young&quot;, &quot;middle&quot;)): object &#39;age&#39; not found</code></pre>
<p>R говорит нам, что переменная <code>age</code> ещё не создана, что в целом достаточно справедливо. Мы можем эту напасть побороть, сначала создав переменную <code>age</code>, а затем сделать новую переменную <code>group</code> через присваивание… но чёт лень…</p>
<p>Лучше воспользуемся мощностями <code>tibble</code>:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="tidy.html#cb9-1"></a><span class="kw">tibble</span>(<span class="dt">age =</span> <span class="kw">sample</span>(<span class="dv">18</span><span class="op">:</span><span class="dv">60</span>, <span class="dt">size =</span> <span class="dv">30</span>),</span>
<span id="cb9-2"><a href="tidy.html#cb9-2"></a>           <span class="dt">group =</span> <span class="kw">ifelse</span>(age <span class="op">&gt;</span><span class="st"> </span><span class="dv">40</span>, <span class="st">&#39;old&#39;</span>,</span>
<span id="cb9-3"><a href="tidy.html#cb9-3"></a>                          <span class="kw">ifelse</span>(age <span class="op">&lt;</span><span class="st"> </span><span class="dv">25</span>, <span class="st">&#39;young&#39;</span>, <span class="st">&#39;middle&#39;</span>)))</span></code></pre></div>
<pre><code>## # A tibble: 30 x 2
##      age group 
##    &lt;int&gt; &lt;chr&gt; 
##  1    31 middle
##  2    40 middle
##  3    56 old   
##  4    27 middle
##  5    52 old   
##  6    55 old   
##  7    29 middle
##  8    53 old   
##  9    48 old   
## 10    30 middle
## # … with 20 more rows</code></pre>
<p>Роскошно!</p>
<p>Может показаться, что это достаточно незначительно преимущество. В целом, да — <code>tibble</code> и <code>data.frame</code> практически одно и то же. Однако, во-первых, стоит помнить, что функции из <code>tidyverse</code> всегда возвращают <code>tibble</code>, а во-вторых, когда мы познаем всю мощь <del>тёмной стороны</del> <a href="tidy.html#mutate">функции <code>mutate()</code></a>, мы осознаем полезность фичи исползования переменных «по ходу событий».</p>
</div>
<div id="грузим-много-данных" class="section level2">
<h2><span class="header-section-number">7.4</span> Грузим много данных</h2>
<p>На самом деле, не так уж и много. Просто в этот раз они располагаются в разных файлах. Нам понадобится <a href="https://drive.google.com/uc?export=download&amp;id=1pEfS2MH6t3scZ-tp7XSCfbOHpcvNKwcR">вот этот архив</a>.</p>
<p>Его надо (1) разархивировать, и (2) положить всю получившуюся папку в нашу папку <code>data</code> в директории курса.</p>
<p>Кстати, чтобы отобразить список файлов, которые лежат в некоторой папке есть команда <code>dir()</code> (по умолчанию отображает содержимое рабочей директории):</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="tidy.html#cb11-1"></a><span class="kw">dir</span>(<span class="dt">path =</span> <span class="st">&#39;data/data_sharexp&#39;</span>)</span></code></pre></div>
<pre><code>##  [1] &quot;01.xlsx&quot;              &quot;02.xlsx&quot;              &quot;03.xlsx&quot;             
##  [4] &quot;04.xlsx&quot;              &quot;05.xlsx&quot;              &quot;06.xlsx&quot;             
##  [7] &quot;07.xlsx&quot;              &quot;08.xlsx&quot;              &quot;09.xlsx&quot;             
## [10] &quot;10.xlsx&quot;              &quot;11.xlsx&quot;              &quot;12.xlsx&quot;             
## [13] &quot;13.xlsx&quot;              &quot;14.xlsx&quot;              &quot;15.xlsx&quot;             
## [16] &quot;16.xlsx&quot;              &quot;17.xlsx&quot;              &quot;18.xlsx&quot;             
## [19] &quot;19.xlsx&quot;              &quot;20.xlsx&quot;              &quot;targetpositions.xlsx&quot;</code></pre>
<p>Функция возвращает строковый вектор, поэтому чтобы узнать количество файлов в директории, можно сделать следующее:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="tidy.html#cb13-1"></a><span class="kw">length</span>(<span class="kw">dir</span>(<span class="dt">path =</span> <span class="st">&#39;data/data_sharexp&#39;</span>))</span></code></pre></div>
<pre><code>## [1] 21</code></pre>
<p>У нас есть 21 файл. Это данные поведенческого эксперимента, в котором пользователи платформ iOS и Android искали иконки share обеих платформ среди других иконок. Судя по тому, как названы файлы, у нас есть 20 Excel-ек с данными и файл <code>targetpositions.xlsx</code>, в котором содержатся координаты целевых стимулов.</p>
<p>Загрузим один файл, и посмотрим, что получится. Нам будет нужен второй лист, так как данные основной серии записаны на нём:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="tidy.html#cb15-1"></a>raw01 &lt;-<span class="st"> </span>readxl<span class="op">::</span><span class="kw">read_xlsx</span>(<span class="st">&#39;data/data_sharexp/01.xlsx&#39;</span>, <span class="dv">2</span>)</span>
<span id="cb15-2"><a href="tidy.html#cb15-2"></a><span class="kw">str</span>(raw01)</span></code></pre></div>
<pre><code>## tibble [459 × 91] (S3: tbl_df/tbl/data.frame)
##  $ stim1                       : chr [1:459] &quot;tray1.png&quot; &quot;08.png&quot; NA &quot;22.png&quot; ...
##  $ stim2                       : chr [1:459] &quot;01.png&quot; &quot;tray1.png&quot; NA &quot;23.png&quot; ...
##  $ stim3                       : chr [1:459] &quot;02.png&quot; &quot;09.png&quot; &quot;tray1.png&quot; &quot;24.png&quot; ...
##  $ stim4                       : chr [1:459] &quot;03.png&quot; NA &quot;15.png&quot; &quot;tray1.png&quot; ...
##  $ stim5                       : chr [1:459] &quot;04.png&quot; &quot;10.png&quot; &quot;16.png&quot; NA ...
##  $ stim6                       : chr [1:459] &quot;05.png&quot; &quot;11.png&quot; &quot;17.png&quot; NA ...
##  $ stim7                       : chr [1:459] &quot;06.png&quot; &quot;12.png&quot; &quot;18.png&quot; &quot;25.png&quot; ...
##  $ stim8                       : chr [1:459] &quot;07.png&quot; &quot;13.png&quot; &quot;19.png&quot; &quot;26.png&quot; ...
##  $ stim9                       : chr [1:459] NA NA &quot;20.png&quot; NA ...
##  $ stim10                      : chr [1:459] NA &quot;14.png&quot; &quot;21.png&quot; NA ...
##  $ stim11                      : chr [1:459] NA NA NA &quot;27.png&quot; ...
##  $ stim12                      : chr [1:459] NA NA NA &quot;28.png&quot; ...
##  $ stim13                      : chr [1:459] NA NA NA NA ...
##  $ stim14                      : chr [1:459] NA NA NA NA ...
##  $ stim15                      : chr [1:459] NA NA NA NA ...
##  $ stim16                      : chr [1:459] NA NA NA NA ...
##  $ pos1                        : chr [1:459] &quot;[-238, 202]&quot; &quot;[-213, 226]&quot; &quot;[-234, 217]&quot; &quot;[-247, 218]&quot; ...
##  $ pos2                        : chr [1:459] &quot;[-88, 202]&quot; &quot;[-63, 226]&quot; &quot;[-84, 217]&quot; &quot;[-97, 218]&quot; ...
##  $ pos3                        : chr [1:459] &quot;[62, 202]&quot; &quot;[87, 226]&quot; &quot;[66, 217]&quot; &quot;[53, 218]&quot; ...
##  $ pos4                        : chr [1:459] &quot;[212, 202]&quot; &quot;[237, 226]&quot; &quot;[216, 217]&quot; &quot;[203, 218]&quot; ...
##  $ pos5                        : chr [1:459] &quot;[-238, 52]&quot; &quot;[-213, 76]&quot; &quot;[-234, 67]&quot; &quot;[-247, 68]&quot; ...
##  $ pos6                        : chr [1:459] &quot;[-88, 52]&quot; &quot;[-63, 76]&quot; &quot;[-84, 67]&quot; &quot;[-97, 68]&quot; ...
##  $ pos7                        : chr [1:459] &quot;[62, 52]&quot; &quot;[87, 76]&quot; &quot;[66, 67]&quot; &quot;[53, 68]&quot; ...
##  $ pos8                        : chr [1:459] &quot;[212, 52]&quot; &quot;[237, 76]&quot; &quot;[216, 67]&quot; &quot;[203, 68]&quot; ...
##  $ pos9                        : chr [1:459] &quot;[-238, -98]&quot; &quot;[-213, -74]&quot; &quot;[-234, -83]&quot; &quot;[-247, -82]&quot; ...
##  $ pos10                       : chr [1:459] &quot;[-88, -98]&quot; &quot;[-63, -74]&quot; &quot;[-84, -83]&quot; &quot;[-97, -82]&quot; ...
##  $ pos11                       : chr [1:459] &quot;[62, -98]&quot; &quot;[87, -74]&quot; &quot;[66, -83]&quot; &quot;[53, -82]&quot; ...
##  $ pos12                       : chr [1:459] &quot;[212, -98]&quot; &quot;[237, -74]&quot; &quot;[216, -83]&quot; &quot;[203, -82]&quot; ...
##  $ pos13                       : chr [1:459] &quot;[-238, -248]&quot; &quot;[-213, -224]&quot; &quot;[-234, -233]&quot; &quot;[-247, -232]&quot; ...
##  $ pos14                       : chr [1:459] &quot;[-88, -248]&quot; &quot;[-63, -224]&quot; &quot;[-84, -233]&quot; &quot;[-97, -232]&quot; ...
##  $ pos15                       : chr [1:459] &quot;[62, -248]&quot; &quot;[87, -224]&quot; &quot;[66, -233]&quot; &quot;[53, -232]&quot; ...
##  $ pos16                       : chr [1:459] &quot;[212, -248]&quot; &quot;[237, -224]&quot; &quot;[216, -233]&quot; &quot;[203, -232]&quot; ...
##  $ size1                       : chr [1:459] &quot;[100, 100]&quot; &quot;[100, 100]&quot; &quot;[100, 100]&quot; &quot;[100, 100]&quot; ...
##  $ size2                       : chr [1:459] &quot;[100, 100]&quot; &quot;[100, 100]&quot; &quot;[100, 100]&quot; &quot;[100, 100]&quot; ...
##  $ size3                       : chr [1:459] &quot;[100, 100]&quot; &quot;[100, 100]&quot; &quot;[100, 100]&quot; &quot;[100, 100]&quot; ...
##  $ size4                       : chr [1:459] &quot;[100, 100]&quot; &quot;[100, 100]&quot; &quot;[100, 100]&quot; &quot;[100, 100]&quot; ...
##  $ size5                       : chr [1:459] &quot;[100, 100]&quot; &quot;[100, 100]&quot; &quot;[100, 100]&quot; &quot;[100, 100]&quot; ...
##  $ size6                       : chr [1:459] &quot;[100, 100]&quot; &quot;[100, 100]&quot; &quot;[100, 100]&quot; &quot;[100, 100]&quot; ...
##  $ size7                       : chr [1:459] &quot;[100, 100]&quot; &quot;[100, 100]&quot; &quot;[100, 100]&quot; &quot;[100, 100]&quot; ...
##  $ size8                       : chr [1:459] &quot;[100, 100]&quot; &quot;[100, 100]&quot; &quot;[100, 100]&quot; &quot;[100, 100]&quot; ...
##  $ size9                       : chr [1:459] &quot;[100, 100]&quot; &quot;[100, 100]&quot; &quot;[100, 100]&quot; &quot;[100, 100]&quot; ...
##  $ size10                      : chr [1:459] &quot;[100, 100]&quot; &quot;[100, 100]&quot; &quot;[100, 100]&quot; &quot;[100, 100]&quot; ...
##  $ size11                      : chr [1:459] &quot;[100, 100]&quot; &quot;[100, 100]&quot; &quot;[100, 100]&quot; &quot;[100, 100]&quot; ...
##  $ size12                      : chr [1:459] &quot;[100, 100]&quot; &quot;[100, 100]&quot; &quot;[100, 100]&quot; &quot;[100, 100]&quot; ...
##  $ size13                      : chr [1:459] &quot;[100, 100]&quot; &quot;[100, 100]&quot; &quot;[100, 100]&quot; &quot;[100, 100]&quot; ...
##  $ size14                      : chr [1:459] &quot;[100, 100]&quot; &quot;[100, 100]&quot; &quot;[100, 100]&quot; &quot;[100, 100]&quot; ...
##  $ size15                      : chr [1:459] &quot;[100, 100]&quot; &quot;[100, 100]&quot; &quot;[100, 100]&quot; &quot;[100, 100]&quot; ...
##  $ size16                      : chr [1:459] &quot;[100, 100]&quot; &quot;[100, 100]&quot; &quot;[100, 100]&quot; &quot;[100, 100]&quot; ...
##  $ ok                          : chr [1:459] &quot;ok.png&quot; &quot;ok.png&quot; &quot;ok.png&quot; &quot;ok.png&quot; ...
##  $ posok                       : chr [1:459] &quot;[0, -375]&quot; &quot;[0, -375]&quot; &quot;[0, -375]&quot; &quot;[0, -375]&quot; ...
##  $ sizeok                      : chr [1:459] &quot;[150, 100]&quot; &quot;[150, 100]&quot; &quot;[150, 100]&quot; &quot;[150, 100]&quot; ...
##  $ numtrial                    : num [1:459] 1 2 3 4 5 6 7 8 9 10 ...
##  $ trialtype                   : chr [1:459] &quot;tray&quot; &quot;tray&quot; &quot;tray&quot; &quot;tray&quot; ...
##  $ setsize                     : num [1:459] 8 8 8 8 8 8 8 8 8 8 ...
##  $ trialtypenum                : num [1:459] 1 1 1 1 1 1 1 1 1 1 ...
##  $ ser                         : chr [1:459] &quot;m&quot; &quot;m&quot; &quot;m&quot; &quot;m&quot; ...
##  $ sernum                      : num [1:459] 1 1 1 1 1 1 1 1 1 1 ...
##  $ n                           : num [1:459] 1 1 1 1 1 1 1 1 1 1 ...
##  $ mouse_main1.leftButton_mean : num [1:459] 1 1 1 1 1 1 1 1 1 1 ...
##  $ mouse_main1.leftButton_raw  : num [1:459] 1 1 1 1 1 1 1 1 1 1 ...
##  $ mouse_main1.leftButton_std  : num [1:459] 0 0 0 0 0 0 0 0 0 0 ...
##  $ mouse_main1.midButton_mean  : num [1:459] 0 0 0 0 0 0 0 0 0 0 ...
##  $ mouse_main1.midButton_raw   : num [1:459] 0 0 0 0 0 0 0 0 0 0 ...
##  $ mouse_main1.midButton_std   : num [1:459] 0 0 0 0 0 0 0 0 0 0 ...
##  $ mouse_main1.rightButton_mean: num [1:459] 0 0 0 0 0 0 0 0 0 0 ...
##  $ mouse_main1.rightButton_raw : num [1:459] 0 0 0 0 0 0 0 0 0 0 ...
##  $ mouse_main1.rightButton_std : num [1:459] 0 0 0 0 0 0 0 0 0 0 ...
##  $ mouse_main1.time_mean       : num [1:459] 1.67 1.13 2.6 2.61 1.59 ...
##  $ mouse_main1.time_raw        : num [1:459] 1.67 1.13 2.6 2.61 1.59 ...
##  $ mouse_main1.time_std        : num [1:459] 0 0 0 0 0 0 0 0 0 0 ...
##  $ mouse_main1.x_mean          : num [1:459] -227 -69 60 199 -241 -51 99 213 -201 -70 ...
##  $ mouse_main1.x_raw           : num [1:459] -227 -69 60 199 -241 -51 99 213 -201 -70 ...
##  $ mouse_main1.y_mean          : num [1:459] 202 231 195 213 43 59 62 46 -123 -82 ...
##  $ mouse_main1.y_raw           : num [1:459] 202 231 195 213 43 59 62 46 -123 -82 ...
##  $ mouse_main2.leftButton_mean : num [1:459] 1 1 1 1 1 1 1 1 1 1 ...
##  $ mouse_main2.leftButton_raw  : num [1:459] 1 1 1 1 1 1 1 1 1 1 ...
##  $ mouse_main2.leftButton_std  : num [1:459] 0 0 0 0 0 0 0 0 0 0 ...
##  $ mouse_main2.midButton_mean  : num [1:459] 0 0 0 0 0 0 0 0 0 0 ...
##  $ mouse_main2.midButton_raw   : num [1:459] 0 0 0 0 0 0 0 0 0 0 ...
##  $ mouse_main2.midButton_std   : num [1:459] 0 0 0 0 0 0 0 0 0 0 ...
##  $ mouse_main2.rightButton_mean: num [1:459] 0 0 0 0 0 0 0 0 0 0 ...
##  $ mouse_main2.rightButton_raw : num [1:459] 0 0 0 0 0 0 0 0 0 0 ...
##  $ mouse_main2.rightButton_std : num [1:459] 0 0 0 0 0 0 0 0 0 0 ...
##  $ mouse_main2.time_mean       : num [1:459] 1.28 1.061 0.963 0.863 0.931 ...
##  $ mouse_main2.time_raw        : num [1:459] 1.28 1.061 0.963 0.863 0.931 ...
##  $ mouse_main2.time_std        : num [1:459] 0 0 0 0 0 0 0 0 0 0 ...
##  $ mouse_main2.x_mean          : num [1:459] 14 -44 17 -26 -25 10 -29 -27 -25 -19 ...
##  $ mouse_main2.x_raw           : num [1:459] 14 -44 17 -26 -25 10 -29 -27 -25 -19 ...
##  $ mouse_main2.y_mean          : num [1:459] -351 -392 -361 -356 -397 -383 -372 -353 -385 -394 ...
##  $ mouse_main2.y_raw           : num [1:459] -351 -392 -361 -356 -397 -383 -372 -353 -385 -394 ...
##  $ order                       : num [1:459] 353 441 247 364 246 45 411 257 273 252 ...</code></pre>
<p>Данные выглядят адекватно, но — куча переменных. Нам явно нужны не все.</p>
</div>
<div id="сабсет-данных" class="section level2">
<h2><span class="header-section-number">7.5</span> Сабсет данных</h2>
<p>Кто знаком с аутпутами PsychoPy, тот опознает смысл названий переменных. Кто не знаком с аутпутами PsychoPy — не страшно. Нам нужны следующие переменные:</p>
<ul>
<li>независимые переменные:
<ul>
<li><code>trialtype</code> — тип пробы (<code>tray</code>, <code>dots</code>, <code>both</code>)</li>
<li><code>setsize</code> — количество стимулов в пробе (<code>8</code>, <code>12</code>, <code>16</code>)</li>
</ul></li>
<li>зависимые переменные (или те переменные, на основе которых мы их посчитаем):
<ul>
<li><code>mouse_main1.time_raw</code> — время первого клика (мс)</li>
<li><code>mouse_main1.x_raw</code> — координата <code>x</code> первого клика</li>
<li><code>mouse_main1.y_raw</code> — координата <code>y</code> первого клика</li>
<li><code>mouse_main2.time_raw</code> — время второго клика (мс)</li>
<li><code>mouse_main2.x_raw</code> — координата <code>x</code> второго клика</li>
<li><code>mouse_main2.y_raw</code> — координата <code>y</code> второго клика</li>
</ul></li>
<li><code>numtrial</code> — номер пробы в исходном файле с координатами (пригодится нам позднее)</li>
</ul>
<p>Давайте их вытаскивать.</p>
<div id="pipe" class="section level3">
<h3><span class="header-section-number">7.5.1</span> <code>%&gt;%</code></h3>
<p>Для того, чтобы это делать элегантно и красиво, нам надо познакомиться с ключевой особенностью синтаксиса <code>tidyverse</code>. На секунду отвлечемся от данных и представим, что нам надо посчитать вот такое дикое выражение:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="tidy.html#cb17-1"></a><span class="kw">sqrt</span>(<span class="kw">abs</span>(<span class="kw">log</span>(<span class="kw">abs</span>(<span class="kw">round</span>(<span class="kw">sin</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="kw">cos</span>(<span class="dv">3</span>)), <span class="dv">2</span>)), <span class="dv">3</span>)))</span></code></pre></div>
<pre><code>## [1] 0.3846181</code></pre>
<p>Запись верная, но читать это совершенно невозможно. Чтобы решить этот вопрос, нам на помощь приходит <em>pipe</em> — специальный оператор, чем-то напоминающий вилосипедик <code>%&gt;%</code>.</p>
<p>Работает он очень просто: он передаёт то, что от него стоит слева, в функцию, которая стоит от него справа, в качестве первого аргумента. То есть эти две команды</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="tidy.html#cb19-1"></a><span class="kw">sum</span>(<span class="dv">3</span>, <span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 7</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="tidy.html#cb21-1"></a><span class="dv">3</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sum</span>(<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 7</code></pre>
<p>содержательно абсолютно идентичны. Только записываются немного по-разному.</p>
<p>Если переписать выражение выше с помощью <em>pipes</em>, то получится очень понятный «конвейер»:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="tidy.html#cb23-1"></a><span class="dv">3</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">cos</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb23-2"><a href="tidy.html#cb23-2"></a><span class="st">  `</span><span class="dt">/</span><span class="st">`</span>(<span class="dv">1</span>, .) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb23-3"><a href="tidy.html#cb23-3"></a><span class="st">  </span><span class="kw">sin</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb23-4"><a href="tidy.html#cb23-4"></a><span class="st">  </span><span class="kw">round</span>(<span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb23-5"><a href="tidy.html#cb23-5"></a><span class="st">  </span><span class="kw">abs</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb23-6"><a href="tidy.html#cb23-6"></a><span class="st">  </span><span class="kw">log</span>(<span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb23-7"><a href="tidy.html#cb23-7"></a><span class="st">  </span><span class="kw">abs</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb23-8"><a href="tidy.html#cb23-8"></a><span class="st">  </span><span class="kw">sqrt</span>()</span></code></pre></div>
<pre><code>## [1] 0.3846181</code></pre>
<p>Теперь отчетливо видна последовательность функций, которые мы совершали, и более того, если что-то можно не так, то можно запросто откопать баг, выполнив только часть кода до определенного пайпа. Во второй строчке нам встретилась особенность — если нам нужно передать объект слева в функцию справа, но не первым аргументом, надо указать его позицию с помощью точки<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>.</p>
<p>Теперь мы готовы идти в бой!</p>
</div>
<div id="select" class="section level3">
<h3><span class="header-section-number">7.5.2</span> <code>select()</code></h3>
<p>Фнукция <code>select()</code> выбирает опредлённые колонки из нашего датасета. Работает очень просто:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="tidy.html#cb25-1"></a>raw01 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(trialtype,</span>
<span id="cb25-2"><a href="tidy.html#cb25-2"></a>                 setsize,</span>
<span id="cb25-3"><a href="tidy.html#cb25-3"></a>                 numtrial,</span>
<span id="cb25-4"><a href="tidy.html#cb25-4"></a>                 mouse_main1.time_raw,</span>
<span id="cb25-5"><a href="tidy.html#cb25-5"></a>                 mouse_main1.x_raw,</span>
<span id="cb25-6"><a href="tidy.html#cb25-6"></a>                 mouse_main1.y_raw,</span>
<span id="cb25-7"><a href="tidy.html#cb25-7"></a>                 mouse_main2.time_raw,</span>
<span id="cb25-8"><a href="tidy.html#cb25-8"></a>                 mouse_main2.x_raw,</span>
<span id="cb25-9"><a href="tidy.html#cb25-9"></a>                 mouse_main2.y_raw)</span></code></pre></div>
<pre><code>## # A tibble: 459 x 9
##    trialtype setsize numtrial mouse_main1.tim… mouse_main1.x_r… mouse_main1.y_r…
##    &lt;chr&gt;       &lt;dbl&gt;    &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;
##  1 tray            8        1             1.67             -227              202
##  2 tray            8        2             1.13              -69              231
##  3 tray            8        3             2.60               60              195
##  4 tray            8        4             2.61              199              213
##  5 tray            8        5             1.59             -241               43
##  6 tray            8        6             1.14              -51               59
##  7 tray            8        7             2.14               99               62
##  8 tray            8        8             1.63              213               46
##  9 tray            8        9             2.56             -201             -123
## 10 tray            8       10             2.02              -70              -82
## # … with 449 more rows, and 3 more variables: mouse_main2.time_raw &lt;dbl&gt;,
## #   mouse_main2.x_raw &lt;dbl&gt;, mouse_main2.y_raw &lt;dbl&gt;</code></pre>
<p>Кайф! Только пока мы наш новый тиббл никуда не записали. Но, подождём — мы ещё не закончили.</p>
</div>
<div id="rename" class="section level3">
<h3><span class="header-section-number">7.5.3</span> <code>rename()</code></h3>
<p>Мы будем теперь практически всегда обращаться к колонкам по имени, поэтому полезно будет их сразу переименовать во что-то более юзабельное. Функци <code>rename()</code> занимается именно этим. В качестве её аргументов надо перечислить <em>новые имена колонок</em> и <em>к каким колонкам они относятся</em>:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="tidy.html#cb27-1"></a>raw01 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(trialtype,</span>
<span id="cb27-2"><a href="tidy.html#cb27-2"></a>                 setsize,</span>
<span id="cb27-3"><a href="tidy.html#cb27-3"></a>                 numtrial,</span>
<span id="cb27-4"><a href="tidy.html#cb27-4"></a>                 mouse_main1.time_raw,</span>
<span id="cb27-5"><a href="tidy.html#cb27-5"></a>                 mouse_main1.x_raw,</span>
<span id="cb27-6"><a href="tidy.html#cb27-6"></a>                 mouse_main1.y_raw,</span>
<span id="cb27-7"><a href="tidy.html#cb27-7"></a>                 mouse_main2.time_raw,</span>
<span id="cb27-8"><a href="tidy.html#cb27-8"></a>                 mouse_main2.x_raw,</span>
<span id="cb27-9"><a href="tidy.html#cb27-9"></a>                 mouse_main2.y_raw) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb27-10"><a href="tidy.html#cb27-10"></a><span class="st">  </span><span class="kw">rename</span>(<span class="dt">time1 =</span> mouse_main1.time_raw,</span>
<span id="cb27-11"><a href="tidy.html#cb27-11"></a>         <span class="dt">click1x =</span> mouse_main1.x_raw,</span>
<span id="cb27-12"><a href="tidy.html#cb27-12"></a>         <span class="dt">click1y =</span> mouse_main1.y_raw,</span>
<span id="cb27-13"><a href="tidy.html#cb27-13"></a>         <span class="dt">time2 =</span> mouse_main2.time_raw,</span>
<span id="cb27-14"><a href="tidy.html#cb27-14"></a>         <span class="dt">click2x =</span> mouse_main2.x_raw,</span>
<span id="cb27-15"><a href="tidy.html#cb27-15"></a>         <span class="dt">click2y =</span> mouse_main2.y_raw)</span></code></pre></div>
<pre><code>## # A tibble: 459 x 9
##    trialtype setsize numtrial time1 click1x click1y time2 click2x click2y
##    &lt;chr&gt;       &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
##  1 tray            8        1  1.67    -227     202 1.28       14    -351
##  2 tray            8        2  1.13     -69     231 1.06      -44    -392
##  3 tray            8        3  2.60      60     195 0.963      17    -361
##  4 tray            8        4  2.61     199     213 0.863     -26    -356
##  5 tray            8        5  1.59    -241      43 0.931     -25    -397
##  6 tray            8        6  1.14     -51      59 0.896      10    -383
##  7 tray            8        7  2.14      99      62 0.879     -29    -372
##  8 tray            8        8  1.63     213      46 0.947     -27    -353
##  9 tray            8        9  2.56    -201    -123 1.65      -25    -385
## 10 tray            8       10  2.02     -70     -82 0.970     -19    -394
## # … with 449 more rows</code></pre>
<p>Красuво! Заметьте, что мы продолжаем наш «конвейер».</p>
</div>
<div id="slice" class="section level3">
<h3><span class="header-section-number">7.5.4</span> <code>slice()</code></h3>
<p>Посмотрим, если строки с пропущенными значениями. Прям тут, не отходя от конвейера:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="tidy.html#cb29-1"></a>raw01 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(trialtype,</span>
<span id="cb29-2"><a href="tidy.html#cb29-2"></a>                 setsize,</span>
<span id="cb29-3"><a href="tidy.html#cb29-3"></a>                 numtrial,</span>
<span id="cb29-4"><a href="tidy.html#cb29-4"></a>                 mouse_main1.time_raw,</span>
<span id="cb29-5"><a href="tidy.html#cb29-5"></a>                 mouse_main1.x_raw,</span>
<span id="cb29-6"><a href="tidy.html#cb29-6"></a>                 mouse_main1.y_raw,</span>
<span id="cb29-7"><a href="tidy.html#cb29-7"></a>                 mouse_main2.time_raw,</span>
<span id="cb29-8"><a href="tidy.html#cb29-8"></a>                 mouse_main2.x_raw,</span>
<span id="cb29-9"><a href="tidy.html#cb29-9"></a>                 mouse_main2.y_raw) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb29-10"><a href="tidy.html#cb29-10"></a><span class="st">  </span><span class="kw">rename</span>(<span class="dt">time1 =</span> mouse_main1.time_raw,</span>
<span id="cb29-11"><a href="tidy.html#cb29-11"></a>         <span class="dt">click1x =</span> mouse_main1.x_raw,</span>
<span id="cb29-12"><a href="tidy.html#cb29-12"></a>         <span class="dt">click1y =</span> mouse_main1.y_raw,</span>
<span id="cb29-13"><a href="tidy.html#cb29-13"></a>         <span class="dt">time2 =</span> mouse_main2.time_raw,</span>
<span id="cb29-14"><a href="tidy.html#cb29-14"></a>         <span class="dt">click2x =</span> mouse_main2.x_raw,</span>
<span id="cb29-15"><a href="tidy.html#cb29-15"></a>         <span class="dt">click2y =</span> mouse_main2.y_raw) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb29-16"><a href="tidy.html#cb29-16"></a><span class="st">  </span><span class="kw">sapply</span>(is.na) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">apply</span>(<span class="dv">2</span>, sum)</span></code></pre></div>
<pre><code>## trialtype   setsize  numtrial     time1   click1x   click1y     time2   click2x 
##         9         9         9         9         9         9         9         9 
##   click2y 
##         9</code></pre>
<p>В каждой переменной есть по девять пропусков. Чтобы понять, что это за пропуски, надо немного знать о том, как PsychoPy записывает данные. После того, как он написал в Excel все экспериментальные данные, он в самом низу дописывает соцдем, который испытуемые заполняют в самом начале эксперимента.</p>
<p>Вот эта штука:</p>
<center>
<img src="img/socdem_psychopy.png">
</center>
<p>Как раз девять строчек — они нам и делают пропущенные значения. Так как они идут после всех наших данные, то мы можем просто <em>«отрезать»</em> этот кусок таблицы:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="tidy.html#cb31-1"></a>raw01 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(trialtype,</span>
<span id="cb31-2"><a href="tidy.html#cb31-2"></a>                 setsize,</span>
<span id="cb31-3"><a href="tidy.html#cb31-3"></a>                 numtrial,</span>
<span id="cb31-4"><a href="tidy.html#cb31-4"></a>                 mouse_main1.time_raw,</span>
<span id="cb31-5"><a href="tidy.html#cb31-5"></a>                 mouse_main1.x_raw,</span>
<span id="cb31-6"><a href="tidy.html#cb31-6"></a>                 mouse_main1.y_raw,</span>
<span id="cb31-7"><a href="tidy.html#cb31-7"></a>                 mouse_main2.time_raw,</span>
<span id="cb31-8"><a href="tidy.html#cb31-8"></a>                 mouse_main2.x_raw,</span>
<span id="cb31-9"><a href="tidy.html#cb31-9"></a>                 mouse_main2.y_raw) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb31-10"><a href="tidy.html#cb31-10"></a><span class="st">  </span><span class="kw">rename</span>(<span class="dt">time1 =</span> mouse_main1.time_raw,</span>
<span id="cb31-11"><a href="tidy.html#cb31-11"></a>         <span class="dt">click1x =</span> mouse_main1.x_raw,</span>
<span id="cb31-12"><a href="tidy.html#cb31-12"></a>         <span class="dt">click1y =</span> mouse_main1.y_raw,</span>
<span id="cb31-13"><a href="tidy.html#cb31-13"></a>         <span class="dt">time2 =</span> mouse_main2.time_raw,</span>
<span id="cb31-14"><a href="tidy.html#cb31-14"></a>         <span class="dt">click2x =</span> mouse_main2.x_raw,</span>
<span id="cb31-15"><a href="tidy.html#cb31-15"></a>         <span class="dt">click2y =</span> mouse_main2.y_raw) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb31-16"><a href="tidy.html#cb31-16"></a><span class="st">  </span><span class="kw">slice</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">450</span>) <span class="co"># мы знаем, что у нас было 450 экспериментальных проб</span></span></code></pre></div>
<pre><code>## # A tibble: 450 x 9
##    trialtype setsize numtrial time1 click1x click1y time2 click2x click2y
##    &lt;chr&gt;       &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
##  1 tray            8        1  1.67    -227     202 1.28       14    -351
##  2 tray            8        2  1.13     -69     231 1.06      -44    -392
##  3 tray            8        3  2.60      60     195 0.963      17    -361
##  4 tray            8        4  2.61     199     213 0.863     -26    -356
##  5 tray            8        5  1.59    -241      43 0.931     -25    -397
##  6 tray            8        6  1.14     -51      59 0.896      10    -383
##  7 tray            8        7  2.14      99      62 0.879     -29    -372
##  8 tray            8        8  1.63     213      46 0.947     -27    -353
##  9 tray            8        9  2.56    -201    -123 1.65      -25    -385
## 10 tray            8       10  2.02     -70     -82 0.970     -19    -394
## # … with 440 more rows</code></pre>
<p>Можно перепроверить, не осталось ли у нас пропущенных значений, с помощью той же строчки, что и в предыдущем чанке.</p>
</div>
<div id="filter" class="section level3">
<h3><span class="header-section-number">7.5.5</span> <code>filter()</code></h3>
<p>Для анализа нам будут нужны не все пробы, а только из экспериметальных условий <code>tray</code> и <code>dots</code>. А как мы помним из описания переменные, экспериметальных условий было три — <code>tray</code>, <code>dots</code> и <code>both</code>. Надо <em>отфильтровать</em> это третье условие. Изи:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="tidy.html#cb33-1"></a>raw01 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(trialtype,</span>
<span id="cb33-2"><a href="tidy.html#cb33-2"></a>                 setsize,</span>
<span id="cb33-3"><a href="tidy.html#cb33-3"></a>                 numtrial,</span>
<span id="cb33-4"><a href="tidy.html#cb33-4"></a>                 mouse_main1.time_raw,</span>
<span id="cb33-5"><a href="tidy.html#cb33-5"></a>                 mouse_main1.x_raw,</span>
<span id="cb33-6"><a href="tidy.html#cb33-6"></a>                 mouse_main1.y_raw,</span>
<span id="cb33-7"><a href="tidy.html#cb33-7"></a>                 mouse_main2.time_raw,</span>
<span id="cb33-8"><a href="tidy.html#cb33-8"></a>                 mouse_main2.x_raw,</span>
<span id="cb33-9"><a href="tidy.html#cb33-9"></a>                 mouse_main2.y_raw) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb33-10"><a href="tidy.html#cb33-10"></a><span class="st">  </span><span class="kw">rename</span>(<span class="dt">time1 =</span> mouse_main1.time_raw,</span>
<span id="cb33-11"><a href="tidy.html#cb33-11"></a>         <span class="dt">click1x =</span> mouse_main1.x_raw,</span>
<span id="cb33-12"><a href="tidy.html#cb33-12"></a>         <span class="dt">click1y =</span> mouse_main1.y_raw,</span>
<span id="cb33-13"><a href="tidy.html#cb33-13"></a>         <span class="dt">time2 =</span> mouse_main2.time_raw,</span>
<span id="cb33-14"><a href="tidy.html#cb33-14"></a>         <span class="dt">click2x =</span> mouse_main2.x_raw,</span>
<span id="cb33-15"><a href="tidy.html#cb33-15"></a>         <span class="dt">click2y =</span> mouse_main2.y_raw) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb33-16"><a href="tidy.html#cb33-16"></a><span class="st">  </span><span class="kw">slice</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">450</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb33-17"><a href="tidy.html#cb33-17"></a><span class="st">  </span><span class="kw">filter</span>(trialtype <span class="op">!=</span><span class="st"> &#39;both&#39;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 300 x 9
##    trialtype setsize numtrial time1 click1x click1y time2 click2x click2y
##    &lt;chr&gt;       &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
##  1 tray            8        1  1.67    -227     202 1.28       14    -351
##  2 tray            8        2  1.13     -69     231 1.06      -44    -392
##  3 tray            8        3  2.60      60     195 0.963      17    -361
##  4 tray            8        4  2.61     199     213 0.863     -26    -356
##  5 tray            8        5  1.59    -241      43 0.931     -25    -397
##  6 tray            8        6  1.14     -51      59 0.896      10    -383
##  7 tray            8        7  2.14      99      62 0.879     -29    -372
##  8 tray            8        8  1.63     213      46 0.947     -27    -353
##  9 tray            8        9  2.56    -201    -123 1.65      -25    -385
## 10 tray            8       10  2.02     -70     -82 0.970     -19    -394
## # … with 290 more rows</code></pre>
<p>Вот теперь хорошо и красиво! Можно сохранить в новый объект!</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="tidy.html#cb35-1"></a>raw01 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(trialtype,</span>
<span id="cb35-2"><a href="tidy.html#cb35-2"></a>                 setsize,</span>
<span id="cb35-3"><a href="tidy.html#cb35-3"></a>                 numtrial,</span>
<span id="cb35-4"><a href="tidy.html#cb35-4"></a>                 mouse_main1.time_raw,</span>
<span id="cb35-5"><a href="tidy.html#cb35-5"></a>                 mouse_main1.x_raw,</span>
<span id="cb35-6"><a href="tidy.html#cb35-6"></a>                 mouse_main1.y_raw,</span>
<span id="cb35-7"><a href="tidy.html#cb35-7"></a>                 mouse_main2.time_raw,</span>
<span id="cb35-8"><a href="tidy.html#cb35-8"></a>                 mouse_main2.x_raw,</span>
<span id="cb35-9"><a href="tidy.html#cb35-9"></a>                 mouse_main2.y_raw) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb35-10"><a href="tidy.html#cb35-10"></a><span class="st">  </span><span class="kw">rename</span>(<span class="dt">time1 =</span> mouse_main1.time_raw,</span>
<span id="cb35-11"><a href="tidy.html#cb35-11"></a>         <span class="dt">click1x =</span> mouse_main1.x_raw,</span>
<span id="cb35-12"><a href="tidy.html#cb35-12"></a>         <span class="dt">click1y =</span> mouse_main1.y_raw,</span>
<span id="cb35-13"><a href="tidy.html#cb35-13"></a>         <span class="dt">time2 =</span> mouse_main2.time_raw,</span>
<span id="cb35-14"><a href="tidy.html#cb35-14"></a>         <span class="dt">click2x =</span> mouse_main2.x_raw,</span>
<span id="cb35-15"><a href="tidy.html#cb35-15"></a>         <span class="dt">click2y =</span> mouse_main2.y_raw) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb35-16"><a href="tidy.html#cb35-16"></a><span class="st">  </span><span class="kw">slice</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">450</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb35-17"><a href="tidy.html#cb35-17"></a><span class="st">  </span><span class="kw">filter</span>(trialtype <span class="op">!=</span><span class="st"> &#39;both&#39;</span>) -&gt;<span class="st"> </span>d01</span>
<span id="cb35-18"><a href="tidy.html#cb35-18"></a><span class="kw">str</span>(d01)</span></code></pre></div>
<pre><code>## tibble [300 × 9] (S3: tbl_df/tbl/data.frame)
##  $ trialtype: chr [1:300] &quot;tray&quot; &quot;tray&quot; &quot;tray&quot; &quot;tray&quot; ...
##  $ setsize  : num [1:300] 8 8 8 8 8 8 8 8 8 8 ...
##  $ numtrial : num [1:300] 1 2 3 4 5 6 7 8 9 10 ...
##  $ time1    : num [1:300] 1.67 1.13 2.6 2.61 1.59 ...
##  $ click1x  : num [1:300] -227 -69 60 199 -241 -51 99 213 -201 -70 ...
##  $ click1y  : num [1:300] 202 231 195 213 43 59 62 46 -123 -82 ...
##  $ time2    : num [1:300] 1.28 1.061 0.963 0.863 0.931 ...
##  $ click2x  : num [1:300] 14 -44 17 -26 -25 10 -29 -27 -25 -19 ...
##  $ click2y  : num [1:300] -351 -392 -361 -356 -397 -383 -372 -353 -385 -394 ...</code></pre>
<p>Да, assignment слева направо тоже работает, и в данном случае это хорошо согласуется с логикой пайпов.</p>
<p>Всё хорошо, но в данном датасете нам не хватает двух вещей — <code>id</code> нашего испытуемого. Зачем? Во-первых, он может быть нужен для некоторых видов анализа, а кроме того, он нам пригодится чуть позже, когда мы будем возиться ещё с одной историей.</p>
</div>
</div>
<div id="mutate" class="section level2">
<h2><span class="header-section-number">7.6</span> <code>mutate()</code></h2>
<p>Функция <code>mutate()</code> позволяет делать дикую кучу всего, но пока познакомимся с логикой её работы.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="tidy.html#cb37-1"></a>d01 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">id =</span> <span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">str</span>()</span></code></pre></div>
<pre><code>## tibble [300 × 10] (S3: tbl_df/tbl/data.frame)
##  $ trialtype: chr [1:300] &quot;tray&quot; &quot;tray&quot; &quot;tray&quot; &quot;tray&quot; ...
##  $ setsize  : num [1:300] 8 8 8 8 8 8 8 8 8 8 ...
##  $ numtrial : num [1:300] 1 2 3 4 5 6 7 8 9 10 ...
##  $ time1    : num [1:300] 1.67 1.13 2.6 2.61 1.59 ...
##  $ click1x  : num [1:300] -227 -69 60 199 -241 -51 99 213 -201 -70 ...
##  $ click1y  : num [1:300] 202 231 195 213 43 59 62 46 -123 -82 ...
##  $ time2    : num [1:300] 1.28 1.061 0.963 0.863 0.931 ...
##  $ click2x  : num [1:300] 14 -44 17 -26 -25 10 -29 -27 -25 -19 ...
##  $ click2y  : num [1:300] -351 -392 -361 -356 -397 -383 -372 -353 -385 -394 ...
##  $ id       : num [1:300] 1 1 1 1 1 1 1 1 1 1 ...</code></pre>
<p>То есть она просто создаёт нам новую переменную. Круто же.</p>
<p>Не забудем перезаписать нас тиббл:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="tidy.html#cb39-1"></a>d01 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">id =</span> <span class="dv">1</span>) -&gt;<span class="st"> </span>d01</span></code></pre></div>
</div>
<div id="догрузим-остальные-данные" class="section level2">
<h2><span class="header-section-number">7.7</span> Догрузим остальные данные</h2>
<p>Вернёмся немного назад и вспомним, что у нас не один файл данных, а <em>двадцать</em>. При этом — так как это автоматически записанные файлы — они одинаково устроены. То есть, чтобы их предобработать, нам надо будет двадцать раз повторить один и те же операции. Ну, не будем же мы двадцать раз копировать тот абзац кода, который мы написали!</p>
<p>Конечно, нет. Мы завернем его в функцию.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="tidy.html#cb40-1"></a>import_data &lt;-<span class="st"> </span><span class="cf">function</span>(x, id) {</span>
<span id="cb40-2"><a href="tidy.html#cb40-2"></a>  <span class="kw">library</span>(tidyr)</span>
<span id="cb40-3"><a href="tidy.html#cb40-3"></a>  <span class="kw">library</span>(readr)</span>
<span id="cb40-4"><a href="tidy.html#cb40-4"></a>  readxl<span class="op">::</span><span class="kw">read_excel</span>(x, <span class="dv">2</span>) <span class="op">%&gt;%</span></span>
<span id="cb40-5"><a href="tidy.html#cb40-5"></a><span class="st">    </span><span class="kw">select</span>(</span>
<span id="cb40-6"><a href="tidy.html#cb40-6"></a>      trialtype,</span>
<span id="cb40-7"><a href="tidy.html#cb40-7"></a>      setsize,</span>
<span id="cb40-8"><a href="tidy.html#cb40-8"></a>      numtrial,</span>
<span id="cb40-9"><a href="tidy.html#cb40-9"></a>      mouse_main1.time_raw,</span>
<span id="cb40-10"><a href="tidy.html#cb40-10"></a>      mouse_main1.x_raw,</span>
<span id="cb40-11"><a href="tidy.html#cb40-11"></a>      mouse_main1.y_raw,</span>
<span id="cb40-12"><a href="tidy.html#cb40-12"></a>      mouse_main2.time_raw,</span>
<span id="cb40-13"><a href="tidy.html#cb40-13"></a>      mouse_main2.x_raw,</span>
<span id="cb40-14"><a href="tidy.html#cb40-14"></a>      mouse_main2.y_raw</span>
<span id="cb40-15"><a href="tidy.html#cb40-15"></a>    ) <span class="op">%&gt;%</span></span>
<span id="cb40-16"><a href="tidy.html#cb40-16"></a><span class="st">    </span><span class="kw">rename</span>(</span>
<span id="cb40-17"><a href="tidy.html#cb40-17"></a>      <span class="dt">time1 =</span> mouse_main1.time_raw,</span>
<span id="cb40-18"><a href="tidy.html#cb40-18"></a>      <span class="dt">click1x =</span> mouse_main1.x_raw,</span>
<span id="cb40-19"><a href="tidy.html#cb40-19"></a>      <span class="dt">click1y =</span> mouse_main1.y_raw,</span>
<span id="cb40-20"><a href="tidy.html#cb40-20"></a>      <span class="dt">time2 =</span> mouse_main2.time_raw,</span>
<span id="cb40-21"><a href="tidy.html#cb40-21"></a>      <span class="dt">click2x =</span> mouse_main2.x_raw,</span>
<span id="cb40-22"><a href="tidy.html#cb40-22"></a>      <span class="dt">click2y =</span> mouse_main2.y_raw</span>
<span id="cb40-23"><a href="tidy.html#cb40-23"></a>    ) <span class="op">%&gt;%</span></span>
<span id="cb40-24"><a href="tidy.html#cb40-24"></a><span class="st">    </span><span class="kw">slice</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">450</span>) <span class="op">%&gt;%</span></span>
<span id="cb40-25"><a href="tidy.html#cb40-25"></a><span class="st">    </span><span class="kw">filter</span>(trialtype <span class="op">!=</span><span class="st"> &#39;both&#39;</span>) <span class="op">%&gt;%</span></span>
<span id="cb40-26"><a href="tidy.html#cb40-26"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">id =</span> id) <span class="op">%&gt;%</span></span>
<span id="cb40-27"><a href="tidy.html#cb40-27"></a><span class="st">    </span><span class="kw">return</span>()</span>
<span id="cb40-28"><a href="tidy.html#cb40-28"></a>}</span></code></pre></div>
<p>Роскошь! Теперь у нас есть функция, которая грузит данные и сразу их предобрабатывает! Ну, не чудо ли!</p>
<p>Вот только эта функция у нас работает на одном датасете, то есть чтобы загрузить все двадцать, нам всё равно придется написать 20 одинаковых строк кода. Нерадужное мероприятие.</p>
<p>Но мы сделаем по-другому.</p>
<div id="соединение-датафреймов-i" class="section level3">
<h3><span class="header-section-number">7.7.1</span> Соединение датафреймов I</h3>
<p>Наша конечная цель — получить единый датасет, в котором будут содержаться все наблюдения по всем испытуемым. Мы уже добились того, что наша функция возвращает нам ровный и красивый tidy <code>tibble</code>. Нам осталось лишь поставить их друг на друга, чтобы получить то, что нам нужно.</p>
<div id="bind_..." class="section level4">
<h4><span class="header-section-number">7.7.1.1</span> <code>bind_...()</code></h4>
<p>Слепить два тиббла можно либо по столбцам, либо по строкам. Этим занимаются две функции: <code>bind_cols()</code> и <code>bind_rows()</code> соответственно. Что происходит, когда количество строк / столбцов одинаковое — понятно: таблички просто слепляются. А вот если это не так:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="tidy.html#cb41-1"></a>tbl1 &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(<span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">nrow =</span> <span class="dv">3</span>))</span></code></pre></div>
<pre><code>## Warning: The `x` argument of `as_tibble.matrix()` must have unique column names if `.name_repair` is omitted as of tibble 2.0.0.
## Using compatibility `.name_repair`.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_warnings()` to see where this warning was generated.</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="tidy.html#cb43-1"></a>tbl2 &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(<span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">ncol =</span> <span class="dv">3</span>))</span>
<span id="cb43-2"><a href="tidy.html#cb43-2"></a></span>
<span id="cb43-3"><a href="tidy.html#cb43-3"></a><span class="kw">bind_rows</span>(tbl1, tbl2)</span></code></pre></div>
<pre><code>## # A tibble: 7 x 4
##      V1    V2    V3    V4
##   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;
## 1     1     4     7    10
## 2     2     5     8    11
## 3     3     6     9    12
## 4     1     5     9    NA
## 5     2     6    10    NA
## 6     3     7    11    NA
## 7     4     8    12    NA</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="tidy.html#cb45-1"></a><span class="kw">bind_cols</span>(tbl1, tbl2)</span></code></pre></div>
<pre><code>## Error: Can&#39;t recycle `..1` (size 3) to match `..2` (size 4).</code></pre>
<p>Вот так вот.</p>
<p>В нашем случае всё прозаично — нам просто нужно поставить 20 тибблов друг на друга. Нам — единственный раз! — понадобиться цикл.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="tidy.html#cb47-1"></a>share &lt;-<span class="st"> </span><span class="kw">tibble</span>() <span class="co"># заглушка для первой итерации</span></span>
<span id="cb47-2"><a href="tidy.html#cb47-2"></a>files &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&#39;data/data_sharexp/&#39;</span>, <span class="kw">dir</span>(<span class="st">&#39;data/data_sharexp&#39;</span>)[<span class="op">-</span><span class="dv">21</span>]) <span class="co"># вектор с названиями файлов</span></span>
<span id="cb47-3"><a href="tidy.html#cb47-3"></a></span>
<span id="cb47-4"><a href="tidy.html#cb47-4"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">20</span>) {</span>
<span id="cb47-5"><a href="tidy.html#cb47-5"></a>  <span class="kw">import_data</span>(files[i], i) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">bind_rows</span>(share, .) -&gt;<span class="st"> </span>share</span>
<span id="cb47-6"><a href="tidy.html#cb47-6"></a>}</span></code></pre></div>
<p>Посмотрим, что получилось:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="tidy.html#cb48-1"></a><span class="kw">str</span>(share)</span></code></pre></div>
<pre><code>## tibble [6,000 × 10] (S3: tbl_df/tbl/data.frame)
##  $ trialtype: chr [1:6000] &quot;tray&quot; &quot;tray&quot; &quot;tray&quot; &quot;tray&quot; ...
##  $ setsize  : num [1:6000] 8 8 8 8 8 8 8 8 8 8 ...
##  $ numtrial : num [1:6000] 1 2 3 4 5 6 7 8 9 10 ...
##  $ time1    : num [1:6000] 1.67 1.13 2.6 2.61 1.59 ...
##  $ click1x  : num [1:6000] -227 -69 60 199 -241 -51 99 213 -201 -70 ...
##  $ click1y  : num [1:6000] 202 231 195 213 43 59 62 46 -123 -82 ...
##  $ time2    : num [1:6000] 1.28 1.061 0.963 0.863 0.931 ...
##  $ click2x  : num [1:6000] 14 -44 17 -26 -25 10 -29 -27 -25 -19 ...
##  $ click2y  : num [1:6000] -351 -392 -361 -356 -397 -383 -372 -353 -385 -394 ...
##  $ id       : int [1:6000] 1 1 1 1 1 1 1 1 1 1 ...</code></pre>
<p>Выглядит вроде верно.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="tidy.html#cb50-1"></a><span class="kw">unique</span>(share<span class="op">$</span>id)</span></code></pre></div>
<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="tidy.html#cb52-1"></a><span class="kw">table</span>(share<span class="op">$</span>trialtype, share<span class="op">$</span>id)</span></code></pre></div>
<pre><code>##       
##          1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18
##   dots 150 150 150 150 150 150 150 150 150 150 150 150 150 150 150 150 150 150
##   tray 150 150 150 150 150 150 150 150 150 150 150 150 150 150 150 150 150 150
##       
##         19  20
##   dots 150 150
##   tray 150 150</code></pre>
<p>Вроде всё ровно. Чилл.</p>
</div>
</div>
</div>
<div id="сортировка" class="section level2">
<h2><span class="header-section-number">7.8</span> Сортировка</h2>
<div id="sort" class="section level3">
<h3><span class="header-section-number">7.8.1</span> <code>sort()</code></h3>
<p>Иногда нам может потребоваться отсортировать наши данные. Как сортировать отдельные векторы, мы уже знаем:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="tidy.html#cb54-1"></a><span class="kw">sort</span>(share<span class="op">$</span>numtrial)</span></code></pre></div>
<pre><code>##    [1]   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1
##   [19]   1   1   2   2   2   2   2   2   2   2   2   2   2   2   2   2   2   2
##   [37]   2   2   2   2   3   3   3   3   3   3   3   3   3   3   3   3   3   3
##   [55]   3   3   3   3   3   3   4   4   4   4   4   4   4   4   4   4   4   4
##   [73]   4   4   4   4   4   4   4   4   5   5   5   5   5   5   5   5   5   5
##   [91]   5   5   5   5   5   5   5   5   5   5   6   6   6   6   6   6   6   6
##  [109]   6   6   6   6   6   6   6   6   6   6   6   6   7   7   7   7   7   7
##  [127]   7   7   7   7   7   7   7   7   7   7   7   7   7   7   8   8   8   8
##  [145]   8   8   8   8   8   8   8   8   8   8   8   8   8   8   8   8   9   9
##  [163]   9   9   9   9   9   9   9   9   9   9   9   9   9   9   9   9   9   9
##  [181]  10  10  10  10  10  10  10  10  10  10  10  10  10  10  10  10  10  10
##  [199]  10  10  11  11  11  11  11  11  11  11  11  11  11  11  11  11  11  11
##  [217]  11  11  11  11  12  12  12  12  12  12  12  12  12  12  12  12  12  12
##  [235]  12  12  12  12  12  12  13  13  13  13  13  13  13  13  13  13  13  13
##  [253]  13  13  13  13  13  13  13  13  14  14  14  14  14  14  14  14  14  14
##  [271]  14  14  14  14  14  14  14  14  14  14  15  15  15  15  15  15  15  15
##  [289]  15  15  15  15  15  15  15  15  15  15  15  15  16  16  16  16  16  16
##  [307]  16  16  16  16  16  16  16  16  16  16  16  16  16  16  17  17  17  17
##  [325]  17  17  17  17  17  17  17  17  17  17  17  17  17  17  17  17  18  18
##  [343]  18  18  18  18  18  18  18  18  18  18  18  18  18  18  18  18  18  18
##  [361]  19  19  19  19  19  19  19  19  19  19  19  19  19  19  19  19  19  19
##  [379]  19  19  20  20  20  20  20  20  20  20  20  20  20  20  20  20  20  20
##  [397]  20  20  20  20  21  21  21  21  21  21  21  21  21  21  21  21  21  21
##  [415]  21  21  21  21  21  21  22  22  22  22  22  22  22  22  22  22  22  22
##  [433]  22  22  22  22  22  22  22  22  23  23  23  23  23  23  23  23  23  23
##  [451]  23  23  23  23  23  23  23  23  23  23  24  24  24  24  24  24  24  24
##  [469]  24  24  24  24  24  24  24  24  24  24  24  24  25  25  25  25  25  25
##  [487]  25  25  25  25  25  25  25  25  25  25  25  25  25  25  26  26  26  26
##  [505]  26  26  26  26  26  26  26  26  26  26  26  26  26  26  26  26  27  27
##  [523]  27  27  27  27  27  27  27  27  27  27  27  27  27  27  27  27  27  27
##  [541]  28  28  28  28  28  28  28  28  28  28  28  28  28  28  28  28  28  28
##  [559]  28  28  29  29  29  29  29  29  29  29  29  29  29  29  29  29  29  29
##  [577]  29  29  29  29  30  30  30  30  30  30  30  30  30  30  30  30  30  30
##  [595]  30  30  30  30  30  30  31  31  31  31  31  31  31  31  31  31  31  31
##  [613]  31  31  31  31  31  31  31  31  32  32  32  32  32  32  32  32  32  32
##  [631]  32  32  32  32  32  32  32  32  32  32  33  33  33  33  33  33  33  33
##  [649]  33  33  33  33  33  33  33  33  33  33  33  33  34  34  34  34  34  34
##  [667]  34  34  34  34  34  34  34  34  34  34  34  34  34  34  35  35  35  35
##  [685]  35  35  35  35  35  35  35  35  35  35  35  35  35  35  35  35  36  36
##  [703]  36  36  36  36  36  36  36  36  36  36  36  36  36  36  36  36  36  36
##  [721]  37  37  37  37  37  37  37  37  37  37  37  37  37  37  37  37  37  37
##  [739]  37  37  38  38  38  38  38  38  38  38  38  38  38  38  38  38  38  38
##  [757]  38  38  38  38  39  39  39  39  39  39  39  39  39  39  39  39  39  39
##  [775]  39  39  39  39  39  39  40  40  40  40  40  40  40  40  40  40  40  40
##  [793]  40  40  40  40  40  40  40  40  41  41  41  41  41  41  41  41  41  41
##  [811]  41  41  41  41  41  41  41  41  41  41  42  42  42  42  42  42  42  42
##  [829]  42  42  42  42  42  42  42  42  42  42  42  42  43  43  43  43  43  43
##  [847]  43  43  43  43  43  43  43  43  43  43  43  43  43  43  44  44  44  44
##  [865]  44  44  44  44  44  44  44  44  44  44  44  44  44  44  44  44  45  45
##  [883]  45  45  45  45  45  45  45  45  45  45  45  45  45  45  45  45  45  45
##  [901]  46  46  46  46  46  46  46  46  46  46  46  46  46  46  46  46  46  46
##  [919]  46  46  47  47  47  47  47  47  47  47  47  47  47  47  47  47  47  47
##  [937]  47  47  47  47  48  48  48  48  48  48  48  48  48  48  48  48  48  48
##  [955]  48  48  48  48  48  48  49  49  49  49  49  49  49  49  49  49  49  49
##  [973]  49  49  49  49  49  49  49  49  50  50  50  50  50  50  50  50  50  50
##  [991]  50  50  50  50  50  50  50  50  50  50  51  51  51  51  51  51  51  51
## [1009]  51  51  51  51  51  51  51  51  51  51  51  51  52  52  52  52  52  52
## [1027]  52  52  52  52  52  52  52  52  52  52  52  52  52  52  53  53  53  53
## [1045]  53  53  53  53  53  53  53  53  53  53  53  53  53  53  53  53  54  54
## [1063]  54  54  54  54  54  54  54  54  54  54  54  54  54  54  54  54  54  54
## [1081]  55  55  55  55  55  55  55  55  55  55  55  55  55  55  55  55  55  55
## [1099]  55  55  56  56  56  56  56  56  56  56  56  56  56  56  56  56  56  56
## [1117]  56  56  56  56  57  57  57  57  57  57  57  57  57  57  57  57  57  57
## [1135]  57  57  57  57  57  57  58  58  58  58  58  58  58  58  58  58  58  58
## [1153]  58  58  58  58  58  58  58  58  59  59  59  59  59  59  59  59  59  59
## [1171]  59  59  59  59  59  59  59  59  59  59  60  60  60  60  60  60  60  60
## [1189]  60  60  60  60  60  60  60  60  60  60  60  60  61  61  61  61  61  61
## [1207]  61  61  61  61  61  61  61  61  61  61  61  61  61  61  62  62  62  62
## [1225]  62  62  62  62  62  62  62  62  62  62  62  62  62  62  62  62  63  63
## [1243]  63  63  63  63  63  63  63  63  63  63  63  63  63  63  63  63  63  63
## [1261]  64  64  64  64  64  64  64  64  64  64  64  64  64  64  64  64  64  64
## [1279]  64  64  65  65  65  65  65  65  65  65  65  65  65  65  65  65  65  65
## [1297]  65  65  65  65  66  66  66  66  66  66  66  66  66  66  66  66  66  66
## [1315]  66  66  66  66  66  66  67  67  67  67  67  67  67  67  67  67  67  67
## [1333]  67  67  67  67  67  67  67  67  68  68  68  68  68  68  68  68  68  68
## [1351]  68  68  68  68  68  68  68  68  68  68  69  69  69  69  69  69  69  69
## [1369]  69  69  69  69  69  69  69  69  69  69  69  69  70  70  70  70  70  70
## [1387]  70  70  70  70  70  70  70  70  70  70  70  70  70  70  71  71  71  71
## [1405]  71  71  71  71  71  71  71  71  71  71  71  71  71  71  71  71  72  72
## [1423]  72  72  72  72  72  72  72  72  72  72  72  72  72  72  72  72  72  72
## [1441]  73  73  73  73  73  73  73  73  73  73  73  73  73  73  73  73  73  73
## [1459]  73  73  74  74  74  74  74  74  74  74  74  74  74  74  74  74  74  74
## [1477]  74  74  74  74  75  75  75  75  75  75  75  75  75  75  75  75  75  75
## [1495]  75  75  75  75  75  75  76  76  76  76  76  76  76  76  76  76  76  76
## [1513]  76  76  76  76  76  76  76  76  77  77  77  77  77  77  77  77  77  77
## [1531]  77  77  77  77  77  77  77  77  77  77  78  78  78  78  78  78  78  78
## [1549]  78  78  78  78  78  78  78  78  78  78  78  78  79  79  79  79  79  79
## [1567]  79  79  79  79  79  79  79  79  79  79  79  79  79  79  80  80  80  80
## [1585]  80  80  80  80  80  80  80  80  80  80  80  80  80  80  80  80  81  81
## [1603]  81  81  81  81  81  81  81  81  81  81  81  81  81  81  81  81  81  81
## [1621]  82  82  82  82  82  82  82  82  82  82  82  82  82  82  82  82  82  82
## [1639]  82  82  83  83  83  83  83  83  83  83  83  83  83  83  83  83  83  83
## [1657]  83  83  83  83  84  84  84  84  84  84  84  84  84  84  84  84  84  84
## [1675]  84  84  84  84  84  84  85  85  85  85  85  85  85  85  85  85  85  85
## [1693]  85  85  85  85  85  85  85  85  86  86  86  86  86  86  86  86  86  86
## [1711]  86  86  86  86  86  86  86  86  86  86  87  87  87  87  87  87  87  87
## [1729]  87  87  87  87  87  87  87  87  87  87  87  87  88  88  88  88  88  88
## [1747]  88  88  88  88  88  88  88  88  88  88  88  88  88  88  89  89  89  89
## [1765]  89  89  89  89  89  89  89  89  89  89  89  89  89  89  89  89  90  90
## [1783]  90  90  90  90  90  90  90  90  90  90  90  90  90  90  90  90  90  90
## [1801]  91  91  91  91  91  91  91  91  91  91  91  91  91  91  91  91  91  91
## [1819]  91  91  92  92  92  92  92  92  92  92  92  92  92  92  92  92  92  92
## [1837]  92  92  92  92  93  93  93  93  93  93  93  93  93  93  93  93  93  93
## [1855]  93  93  93  93  93  93  94  94  94  94  94  94  94  94  94  94  94  94
## [1873]  94  94  94  94  94  94  94  94  95  95  95  95  95  95  95  95  95  95
## [1891]  95  95  95  95  95  95  95  95  95  95  96  96  96  96  96  96  96  96
## [1909]  96  96  96  96  96  96  96  96  96  96  96  96  97  97  97  97  97  97
## [1927]  97  97  97  97  97  97  97  97  97  97  97  97  97  97  98  98  98  98
## [1945]  98  98  98  98  98  98  98  98  98  98  98  98  98  98  98  98  99  99
## [1963]  99  99  99  99  99  99  99  99  99  99  99  99  99  99  99  99  99  99
## [1981] 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100 100
## [1999] 100 100 151 151 151 151 151 151 151 151 151 151 151 151 151 151 151 151
## [2017] 151 151 151 151 152 152 152 152 152 152 152 152 152 152 152 152 152 152
## [2035] 152 152 152 152 152 152 153 153 153 153 153 153 153 153 153 153 153 153
## [2053] 153 153 153 153 153 153 153 153 154 154 154 154 154 154 154 154 154 154
## [2071] 154 154 154 154 154 154 154 154 154 154 155 155 155 155 155 155 155 155
## [2089] 155 155 155 155 155 155 155 155 155 155 155 155 156 156 156 156 156 156
## [2107] 156 156 156 156 156 156 156 156 156 156 156 156 156 156 157 157 157 157
## [2125] 157 157 157 157 157 157 157 157 157 157 157 157 157 157 157 157 158 158
## [2143] 158 158 158 158 158 158 158 158 158 158 158 158 158 158 158 158 158 158
## [2161] 159 159 159 159 159 159 159 159 159 159 159 159 159 159 159 159 159 159
## [2179] 159 159 160 160 160 160 160 160 160 160 160 160 160 160 160 160 160 160
## [2197] 160 160 160 160 161 161 161 161 161 161 161 161 161 161 161 161 161 161
## [2215] 161 161 161 161 161 161 162 162 162 162 162 162 162 162 162 162 162 162
## [2233] 162 162 162 162 162 162 162 162 163 163 163 163 163 163 163 163 163 163
## [2251] 163 163 163 163 163 163 163 163 163 163 164 164 164 164 164 164 164 164
## [2269] 164 164 164 164 164 164 164 164 164 164 164 164 165 165 165 165 165 165
## [2287] 165 165 165 165 165 165 165 165 165 165 165 165 165 165 166 166 166 166
## [2305] 166 166 166 166 166 166 166 166 166 166 166 166 166 166 166 166 167 167
## [2323] 167 167 167 167 167 167 167 167 167 167 167 167 167 167 167 167 167 167
## [2341] 168 168 168 168 168 168 168 168 168 168 168 168 168 168 168 168 168 168
## [2359] 168 168 169 169 169 169 169 169 169 169 169 169 169 169 169 169 169 169
## [2377] 169 169 169 169 170 170 170 170 170 170 170 170 170 170 170 170 170 170
## [2395] 170 170 170 170 170 170 171 171 171 171 171 171 171 171 171 171 171 171
## [2413] 171 171 171 171 171 171 171 171 172 172 172 172 172 172 172 172 172 172
## [2431] 172 172 172 172 172 172 172 172 172 172 173 173 173 173 173 173 173 173
## [2449] 173 173 173 173 173 173 173 173 173 173 173 173 174 174 174 174 174 174
## [2467] 174 174 174 174 174 174 174 174 174 174 174 174 174 174 175 175 175 175
## [2485] 175 175 175 175 175 175 175 175 175 175 175 175 175 175 175 175 176 176
## [2503] 176 176 176 176 176 176 176 176 176 176 176 176 176 176 176 176 176 176
## [2521] 177 177 177 177 177 177 177 177 177 177 177 177 177 177 177 177 177 177
## [2539] 177 177 178 178 178 178 178 178 178 178 178 178 178 178 178 178 178 178
## [2557] 178 178 178 178 179 179 179 179 179 179 179 179 179 179 179 179 179 179
## [2575] 179 179 179 179 179 179 180 180 180 180 180 180 180 180 180 180 180 180
## [2593] 180 180 180 180 180 180 180 180 181 181 181 181 181 181 181 181 181 181
## [2611] 181 181 181 181 181 181 181 181 181 181 182 182 182 182 182 182 182 182
## [2629] 182 182 182 182 182 182 182 182 182 182 182 182 183 183 183 183 183 183
## [2647] 183 183 183 183 183 183 183 183 183 183 183 183 183 183 184 184 184 184
## [2665] 184 184 184 184 184 184 184 184 184 184 184 184 184 184 184 184 185 185
## [2683] 185 185 185 185 185 185 185 185 185 185 185 185 185 185 185 185 185 185
## [2701] 186 186 186 186 186 186 186 186 186 186 186 186 186 186 186 186 186 186
## [2719] 186 186 187 187 187 187 187 187 187 187 187 187 187 187 187 187 187 187
## [2737] 187 187 187 187 188 188 188 188 188 188 188 188 188 188 188 188 188 188
## [2755] 188 188 188 188 188 188 189 189 189 189 189 189 189 189 189 189 189 189
## [2773] 189 189 189 189 189 189 189 189 190 190 190 190 190 190 190 190 190 190
## [2791] 190 190 190 190 190 190 190 190 190 190 191 191 191 191 191 191 191 191
## [2809] 191 191 191 191 191 191 191 191 191 191 191 191 192 192 192 192 192 192
## [2827] 192 192 192 192 192 192 192 192 192 192 192 192 192 192 193 193 193 193
## [2845] 193 193 193 193 193 193 193 193 193 193 193 193 193 193 193 193 194 194
## [2863] 194 194 194 194 194 194 194 194 194 194 194 194 194 194 194 194 194 194
## [2881] 195 195 195 195 195 195 195 195 195 195 195 195 195 195 195 195 195 195
## [2899] 195 195 196 196 196 196 196 196 196 196 196 196 196 196 196 196 196 196
## [2917] 196 196 196 196 197 197 197 197 197 197 197 197 197 197 197 197 197 197
## [2935] 197 197 197 197 197 197 198 198 198 198 198 198 198 198 198 198 198 198
## [2953] 198 198 198 198 198 198 198 198 199 199 199 199 199 199 199 199 199 199
## [2971] 199 199 199 199 199 199 199 199 199 199 200 200 200 200 200 200 200 200
## [2989] 200 200 200 200 200 200 200 200 200 200 200 200 201 201 201 201 201 201
## [3007] 201 201 201 201 201 201 201 201 201 201 201 201 201 201 202 202 202 202
## [3025] 202 202 202 202 202 202 202 202 202 202 202 202 202 202 202 202 203 203
## [3043] 203 203 203 203 203 203 203 203 203 203 203 203 203 203 203 203 203 203
## [3061] 204 204 204 204 204 204 204 204 204 204 204 204 204 204 204 204 204 204
## [3079] 204 204 205 205 205 205 205 205 205 205 205 205 205 205 205 205 205 205
## [3097] 205 205 205 205 206 206 206 206 206 206 206 206 206 206 206 206 206 206
## [3115] 206 206 206 206 206 206 207 207 207 207 207 207 207 207 207 207 207 207
## [3133] 207 207 207 207 207 207 207 207 208 208 208 208 208 208 208 208 208 208
## [3151] 208 208 208 208 208 208 208 208 208 208 209 209 209 209 209 209 209 209
## [3169] 209 209 209 209 209 209 209 209 209 209 209 209 210 210 210 210 210 210
## [3187] 210 210 210 210 210 210 210 210 210 210 210 210 210 210 211 211 211 211
## [3205] 211 211 211 211 211 211 211 211 211 211 211 211 211 211 211 211 212 212
## [3223] 212 212 212 212 212 212 212 212 212 212 212 212 212 212 212 212 212 212
## [3241] 213 213 213 213 213 213 213 213 213 213 213 213 213 213 213 213 213 213
## [3259] 213 213 214 214 214 214 214 214 214 214 214 214 214 214 214 214 214 214
## [3277] 214 214 214 214 215 215 215 215 215 215 215 215 215 215 215 215 215 215
## [3295] 215 215 215 215 215 215 216 216 216 216 216 216 216 216 216 216 216 216
## [3313] 216 216 216 216 216 216 216 216 217 217 217 217 217 217 217 217 217 217
## [3331] 217 217 217 217 217 217 217 217 217 217 218 218 218 218 218 218 218 218
## [3349] 218 218 218 218 218 218 218 218 218 218 218 218 219 219 219 219 219 219
## [3367] 219 219 219 219 219 219 219 219 219 219 219 219 219 219 220 220 220 220
## [3385] 220 220 220 220 220 220 220 220 220 220 220 220 220 220 220 220 221 221
## [3403] 221 221 221 221 221 221 221 221 221 221 221 221 221 221 221 221 221 221
## [3421] 222 222 222 222 222 222 222 222 222 222 222 222 222 222 222 222 222 222
## [3439] 222 222 223 223 223 223 223 223 223 223 223 223 223 223 223 223 223 223
## [3457] 223 223 223 223 224 224 224 224 224 224 224 224 224 224 224 224 224 224
## [3475] 224 224 224 224 224 224 225 225 225 225 225 225 225 225 225 225 225 225
## [3493] 225 225 225 225 225 225 225 225 226 226 226 226 226 226 226 226 226 226
## [3511] 226 226 226 226 226 226 226 226 226 226 227 227 227 227 227 227 227 227
## [3529] 227 227 227 227 227 227 227 227 227 227 227 227 228 228 228 228 228 228
## [3547] 228 228 228 228 228 228 228 228 228 228 228 228 228 228 229 229 229 229
## [3565] 229 229 229 229 229 229 229 229 229 229 229 229 229 229 229 229 230 230
## [3583] 230 230 230 230 230 230 230 230 230 230 230 230 230 230 230 230 230 230
## [3601] 231 231 231 231 231 231 231 231 231 231 231 231 231 231 231 231 231 231
## [3619] 231 231 232 232 232 232 232 232 232 232 232 232 232 232 232 232 232 232
## [3637] 232 232 232 232 233 233 233 233 233 233 233 233 233 233 233 233 233 233
## [3655] 233 233 233 233 233 233 234 234 234 234 234 234 234 234 234 234 234 234
## [3673] 234 234 234 234 234 234 234 234 235 235 235 235 235 235 235 235 235 235
## [3691] 235 235 235 235 235 235 235 235 235 235 236 236 236 236 236 236 236 236
## [3709] 236 236 236 236 236 236 236 236 236 236 236 236 237 237 237 237 237 237
## [3727] 237 237 237 237 237 237 237 237 237 237 237 237 237 237 238 238 238 238
## [3745] 238 238 238 238 238 238 238 238 238 238 238 238 238 238 238 238 239 239
## [3763] 239 239 239 239 239 239 239 239 239 239 239 239 239 239 239 239 239 239
## [3781] 240 240 240 240 240 240 240 240 240 240 240 240 240 240 240 240 240 240
## [3799] 240 240 241 241 241 241 241 241 241 241 241 241 241 241 241 241 241 241
## [3817] 241 241 241 241 242 242 242 242 242 242 242 242 242 242 242 242 242 242
## [3835] 242 242 242 242 242 242 243 243 243 243 243 243 243 243 243 243 243 243
## [3853] 243 243 243 243 243 243 243 243 244 244 244 244 244 244 244 244 244 244
## [3871] 244 244 244 244 244 244 244 244 244 244 245 245 245 245 245 245 245 245
## [3889] 245 245 245 245 245 245 245 245 245 245 245 245 246 246 246 246 246 246
## [3907] 246 246 246 246 246 246 246 246 246 246 246 246 246 246 247 247 247 247
## [3925] 247 247 247 247 247 247 247 247 247 247 247 247 247 247 247 247 248 248
## [3943] 248 248 248 248 248 248 248 248 248 248 248 248 248 248 248 248 248 248
## [3961] 249 249 249 249 249 249 249 249 249 249 249 249 249 249 249 249 249 249
## [3979] 249 249 250 250 250 250 250 250 250 250 250 250 250 250 250 250 250 250
## [3997] 250 250 250 250 301 301 301 301 301 301 301 301 301 301 301 301 301 301
## [4015] 301 301 301 301 301 301 302 302 302 302 302 302 302 302 302 302 302 302
## [4033] 302 302 302 302 302 302 302 302 303 303 303 303 303 303 303 303 303 303
## [4051] 303 303 303 303 303 303 303 303 303 303 304 304 304 304 304 304 304 304
## [4069] 304 304 304 304 304 304 304 304 304 304 304 304 305 305 305 305 305 305
## [4087] 305 305 305 305 305 305 305 305 305 305 305 305 305 305 306 306 306 306
## [4105] 306 306 306 306 306 306 306 306 306 306 306 306 306 306 306 306 307 307
## [4123] 307 307 307 307 307 307 307 307 307 307 307 307 307 307 307 307 307 307
## [4141] 308 308 308 308 308 308 308 308 308 308 308 308 308 308 308 308 308 308
## [4159] 308 308 309 309 309 309 309 309 309 309 309 309 309 309 309 309 309 309
## [4177] 309 309 309 309 310 310 310 310 310 310 310 310 310 310 310 310 310 310
## [4195] 310 310 310 310 310 310 311 311 311 311 311 311 311 311 311 311 311 311
## [4213] 311 311 311 311 311 311 311 311 312 312 312 312 312 312 312 312 312 312
## [4231] 312 312 312 312 312 312 312 312 312 312 313 313 313 313 313 313 313 313
## [4249] 313 313 313 313 313 313 313 313 313 313 313 313 314 314 314 314 314 314
## [4267] 314 314 314 314 314 314 314 314 314 314 314 314 314 314 315 315 315 315
## [4285] 315 315 315 315 315 315 315 315 315 315 315 315 315 315 315 315 316 316
## [4303] 316 316 316 316 316 316 316 316 316 316 316 316 316 316 316 316 316 316
## [4321] 317 317 317 317 317 317 317 317 317 317 317 317 317 317 317 317 317 317
## [4339] 317 317 318 318 318 318 318 318 318 318 318 318 318 318 318 318 318 318
## [4357] 318 318 318 318 319 319 319 319 319 319 319 319 319 319 319 319 319 319
## [4375] 319 319 319 319 319 319 320 320 320 320 320 320 320 320 320 320 320 320
## [4393] 320 320 320 320 320 320 320 320 321 321 321 321 321 321 321 321 321 321
## [4411] 321 321 321 321 321 321 321 321 321 321 322 322 322 322 322 322 322 322
## [4429] 322 322 322 322 322 322 322 322 322 322 322 322 323 323 323 323 323 323
## [4447] 323 323 323 323 323 323 323 323 323 323 323 323 323 323 324 324 324 324
## [4465] 324 324 324 324 324 324 324 324 324 324 324 324 324 324 324 324 325 325
## [4483] 325 325 325 325 325 325 325 325 325 325 325 325 325 325 325 325 325 325
## [4501] 326 326 326 326 326 326 326 326 326 326 326 326 326 326 326 326 326 326
## [4519] 326 326 327 327 327 327 327 327 327 327 327 327 327 327 327 327 327 327
## [4537] 327 327 327 327 328 328 328 328 328 328 328 328 328 328 328 328 328 328
## [4555] 328 328 328 328 328 328 329 329 329 329 329 329 329 329 329 329 329 329
## [4573] 329 329 329 329 329 329 329 329 330 330 330 330 330 330 330 330 330 330
## [4591] 330 330 330 330 330 330 330 330 330 330 331 331 331 331 331 331 331 331
## [4609] 331 331 331 331 331 331 331 331 331 331 331 331 332 332 332 332 332 332
## [4627] 332 332 332 332 332 332 332 332 332 332 332 332 332 332 333 333 333 333
## [4645] 333 333 333 333 333 333 333 333 333 333 333 333 333 333 333 333 334 334
## [4663] 334 334 334 334 334 334 334 334 334 334 334 334 334 334 334 334 334 334
## [4681] 335 335 335 335 335 335 335 335 335 335 335 335 335 335 335 335 335 335
## [4699] 335 335 336 336 336 336 336 336 336 336 336 336 336 336 336 336 336 336
## [4717] 336 336 336 336 337 337 337 337 337 337 337 337 337 337 337 337 337 337
## [4735] 337 337 337 337 337 337 338 338 338 338 338 338 338 338 338 338 338 338
## [4753] 338 338 338 338 338 338 338 338 339 339 339 339 339 339 339 339 339 339
## [4771] 339 339 339 339 339 339 339 339 339 339 340 340 340 340 340 340 340 340
## [4789] 340 340 340 340 340 340 340 340 340 340 340 340 341 341 341 341 341 341
## [4807] 341 341 341 341 341 341 341 341 341 341 341 341 341 341 342 342 342 342
## [4825] 342 342 342 342 342 342 342 342 342 342 342 342 342 342 342 342 343 343
## [4843] 343 343 343 343 343 343 343 343 343 343 343 343 343 343 343 343 343 343
## [4861] 344 344 344 344 344 344 344 344 344 344 344 344 344 344 344 344 344 344
## [4879] 344 344 345 345 345 345 345 345 345 345 345 345 345 345 345 345 345 345
## [4897] 345 345 345 345 346 346 346 346 346 346 346 346 346 346 346 346 346 346
## [4915] 346 346 346 346 346 346 347 347 347 347 347 347 347 347 347 347 347 347
## [4933] 347 347 347 347 347 347 347 347 348 348 348 348 348 348 348 348 348 348
## [4951] 348 348 348 348 348 348 348 348 348 348 349 349 349 349 349 349 349 349
## [4969] 349 349 349 349 349 349 349 349 349 349 349 349 350 350 350 350 350 350
## [4987] 350 350 350 350 350 350 350 350 350 350 350 350 350 350 351 351 351 351
## [5005] 351 351 351 351 351 351 351 351 351 351 351 351 351 351 351 351 352 352
## [5023] 352 352 352 352 352 352 352 352 352 352 352 352 352 352 352 352 352 352
## [5041] 353 353 353 353 353 353 353 353 353 353 353 353 353 353 353 353 353 353
## [5059] 353 353 354 354 354 354 354 354 354 354 354 354 354 354 354 354 354 354
## [5077] 354 354 354 354 355 355 355 355 355 355 355 355 355 355 355 355 355 355
## [5095] 355 355 355 355 355 355 356 356 356 356 356 356 356 356 356 356 356 356
## [5113] 356 356 356 356 356 356 356 356 357 357 357 357 357 357 357 357 357 357
## [5131] 357 357 357 357 357 357 357 357 357 357 358 358 358 358 358 358 358 358
## [5149] 358 358 358 358 358 358 358 358 358 358 358 358 359 359 359 359 359 359
## [5167] 359 359 359 359 359 359 359 359 359 359 359 359 359 359 360 360 360 360
## [5185] 360 360 360 360 360 360 360 360 360 360 360 360 360 360 360 360 361 361
## [5203] 361 361 361 361 361 361 361 361 361 361 361 361 361 361 361 361 361 361
## [5221] 362 362 362 362 362 362 362 362 362 362 362 362 362 362 362 362 362 362
## [5239] 362 362 363 363 363 363 363 363 363 363 363 363 363 363 363 363 363 363
## [5257] 363 363 363 363 364 364 364 364 364 364 364 364 364 364 364 364 364 364
## [5275] 364 364 364 364 364 364 365 365 365 365 365 365 365 365 365 365 365 365
## [5293] 365 365 365 365 365 365 365 365 366 366 366 366 366 366 366 366 366 366
## [5311] 366 366 366 366 366 366 366 366 366 366 367 367 367 367 367 367 367 367
## [5329] 367 367 367 367 367 367 367 367 367 367 367 367 368 368 368 368 368 368
## [5347] 368 368 368 368 368 368 368 368 368 368 368 368 368 368 369 369 369 369
## [5365] 369 369 369 369 369 369 369 369 369 369 369 369 369 369 369 369 370 370
## [5383] 370 370 370 370 370 370 370 370 370 370 370 370 370 370 370 370 370 370
## [5401] 371 371 371 371 371 371 371 371 371 371 371 371 371 371 371 371 371 371
## [5419] 371 371 372 372 372 372 372 372 372 372 372 372 372 372 372 372 372 372
## [5437] 372 372 372 372 373 373 373 373 373 373 373 373 373 373 373 373 373 373
## [5455] 373 373 373 373 373 373 374 374 374 374 374 374 374 374 374 374 374 374
## [5473] 374 374 374 374 374 374 374 374 375 375 375 375 375 375 375 375 375 375
## [5491] 375 375 375 375 375 375 375 375 375 375 376 376 376 376 376 376 376 376
## [5509] 376 376 376 376 376 376 376 376 376 376 376 376 377 377 377 377 377 377
## [5527] 377 377 377 377 377 377 377 377 377 377 377 377 377 377 378 378 378 378
## [5545] 378 378 378 378 378 378 378 378 378 378 378 378 378 378 378 378 379 379
## [5563] 379 379 379 379 379 379 379 379 379 379 379 379 379 379 379 379 379 379
## [5581] 380 380 380 380 380 380 380 380 380 380 380 380 380 380 380 380 380 380
## [5599] 380 380 381 381 381 381 381 381 381 381 381 381 381 381 381 381 381 381
## [5617] 381 381 381 381 382 382 382 382 382 382 382 382 382 382 382 382 382 382
## [5635] 382 382 382 382 382 382 383 383 383 383 383 383 383 383 383 383 383 383
## [5653] 383 383 383 383 383 383 383 383 384 384 384 384 384 384 384 384 384 384
## [5671] 384 384 384 384 384 384 384 384 384 384 385 385 385 385 385 385 385 385
## [5689] 385 385 385 385 385 385 385 385 385 385 385 385 386 386 386 386 386 386
## [5707] 386 386 386 386 386 386 386 386 386 386 386 386 386 386 387 387 387 387
## [5725] 387 387 387 387 387 387 387 387 387 387 387 387 387 387 387 387 388 388
## [5743] 388 388 388 388 388 388 388 388 388 388 388 388 388 388 388 388 388 388
## [5761] 389 389 389 389 389 389 389 389 389 389 389 389 389 389 389 389 389 389
## [5779] 389 389 390 390 390 390 390 390 390 390 390 390 390 390 390 390 390 390
## [5797] 390 390 390 390 391 391 391 391 391 391 391 391 391 391 391 391 391 391
## [5815] 391 391 391 391 391 391 392 392 392 392 392 392 392 392 392 392 392 392
## [5833] 392 392 392 392 392 392 392 392 393 393 393 393 393 393 393 393 393 393
## [5851] 393 393 393 393 393 393 393 393 393 393 394 394 394 394 394 394 394 394
## [5869] 394 394 394 394 394 394 394 394 394 394 394 394 395 395 395 395 395 395
## [5887] 395 395 395 395 395 395 395 395 395 395 395 395 395 395 396 396 396 396
## [5905] 396 396 396 396 396 396 396 396 396 396 396 396 396 396 396 396 397 397
## [5923] 397 397 397 397 397 397 397 397 397 397 397 397 397 397 397 397 397 397
## [5941] 398 398 398 398 398 398 398 398 398 398 398 398 398 398 398 398 398 398
## [5959] 398 398 399 399 399 399 399 399 399 399 399 399 399 399 399 399 399 399
## [5977] 399 399 399 399 400 400 400 400 400 400 400 400 400 400 400 400 400 400
## [5995] 400 400 400 400 400 400</code></pre>
<p>А если весь датасет?</p>
</div>
<div id="arrange" class="section level3">
<h3><span class="header-section-number">7.8.2</span> <code>arrange()</code></h3>
<p>Тогда вот так:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="tidy.html#cb56-1"></a>share <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(numtrial)</span></code></pre></div>
<pre><code>## # A tibble: 6,000 x 10
##    trialtype setsize numtrial time1 click1x click1y time2 click2x click2y    id
##    &lt;chr&gt;       &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;
##  1 tray            8        1 1.67     -227     202 1.28       14    -351     1
##  2 tray            8        1 2.25     -252     198 2.53       28    -362     2
##  3 tray            8        1 1.04     -212     211 0.969      27    -384     3
##  4 tray            8        1 1.32     -244     199 0.666     -15    -408     4
##  5 tray            8        1 0.905    -255     190 0.361     150    -369     5
##  6 tray            8        1 2.45        6    -357 2.27       83      36     6
##  7 tray            8        1 1.44     -224     175 0.797      31    -345     7
##  8 tray            8        1 1.49     -243     219 1.05        2    -378     8
##  9 tray            8        1 1.10     -232     198 0.781      42    -403     9
## 10 tray            8        1 0.981    -226     202 0.582     -21    -372    10
## # … with 5,990 more rows</code></pre>
<p>Или по двум переменным сразу:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="tidy.html#cb58-1"></a>share <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(numtrial, id)</span></code></pre></div>
<pre><code>## # A tibble: 6,000 x 10
##    trialtype setsize numtrial time1 click1x click1y time2 click2x click2y    id
##    &lt;chr&gt;       &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;
##  1 tray            8        1 1.67     -227     202 1.28       14    -351     1
##  2 tray            8        1 2.25     -252     198 2.53       28    -362     2
##  3 tray            8        1 1.04     -212     211 0.969      27    -384     3
##  4 tray            8        1 1.32     -244     199 0.666     -15    -408     4
##  5 tray            8        1 0.905    -255     190 0.361     150    -369     5
##  6 tray            8        1 2.45        6    -357 2.27       83      36     6
##  7 tray            8        1 1.44     -224     175 0.797      31    -345     7
##  8 tray            8        1 1.49     -243     219 1.05        2    -378     8
##  9 tray            8        1 1.10     -232     198 0.781      42    -403     9
## 10 tray            8        1 0.981    -226     202 0.582     -21    -372    10
## # … with 5,990 more rows</code></pre>
<p>В данном случае получилось то же самое, так как мы присоединяли данные испытуемых последовательно с увеличивая <code>id</code>.</p>
</div>
<div id="distinct" class="section level3">
<h3><span class="header-section-number">7.8.3</span> <code>distinct()</code></h3>
<p>Можно вывести уникальные сочетания по двум переменным:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="tidy.html#cb60-1"></a>share <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">distinct</span>(trialtype, setsize)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 2
##   trialtype setsize
##   &lt;chr&gt;       &lt;dbl&gt;
## 1 tray            8
## 2 dots            8
## 3 tray           12
## 4 dots           12
## 5 tray           16
## 6 dots           16</code></pre>
<p>Тут все достаточно ожидаемо — (квази)эксперимент всё-таки.</p>
<blockquote>
<p>Так, погодите! А если это квазиэксперимент, то где же <em>квазиНП</em>? Она точно была! В описании эксперимента фигурировала используемая платформа смартфона!</p>
</blockquote>
<blockquote>
<p>Спокойно. Ща всё будет.</p>
</blockquote>
</div>
</div>
<div id="соединение-датафреймов-ii" class="section level2">
<h2><span class="header-section-number">7.9</span> Соединение датафреймов II</h2>
<p>Данные о том, смартфон на какой платформе использует испытуемый, были записаны в отдельный датасет. Он <a href="https://raw.githubusercontent.com/angelgardt/hseuxlab-wlm2021/master/book/wlm2021-book/data/share_platform.csv">вот тут</a>.</p>
<p>Грузим его:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="tidy.html#cb62-1"></a>platform &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&#39;https://raw.githubusercontent.com/angelgardt/hseuxlab-wlm2021/master/book/wlm2021-book/data/share_platform.csv&#39;</span>)</span></code></pre></div>
<pre><code>## 
## ── Column specification ────────────────────────────────────────────────────────
## cols(
##   id = col_double(),
##   platform = col_character()
## )</code></pre>
<p>Осталось понять, как нам его присобачить к имеющимся данным так, как нам надо. А нам надо так, чтобы появилась новая колонка, в каждой ячейке которой согласно <code>id</code> будет стоять соответствующая платформа.</p>
<div id="join" class="section level3">
<h3><span class="header-section-number">7.9.1</span> <code>..._join()</code></h3>
<p>Нас спасёт <code>..._join()</code>. Эта функция объединяет два датасета по определенной <em>ключевой</em> переменной.
Что делает <code>..._join()</code>? У него есть две ключевые колонки из двух датасетов. Он находит соответствия, и лепит все колонки одной таблицы к другой, сопоставляя соответствующие строки.</p>
<ul>
<li>Для <code>left_join()</code> главный тиббл — слева, то есть остаются <em>все строки левого тиббла</em>, а из правого выбираются только те, которые нужны.</li>
<li>Для <code>right_join()</code> главный тиббл — справа, то есть остаются <em>все строки правого тиббла</em>, а из левого выбираются те, которые нужны.</li>
<li>Для <code>full_join()</code> и <code>inner_join()</code> главные тибблы оба:
<ul>
<li><code>full_join()</code> оставляет все строки обоих тибблов, а те, которым не нашлось соответствия в другом тиббле, заполняет <code>NA</code>.</li>
<li><code>inner_join()</code> оставляет только те строки, которым нашлось соответствие, а всё остальные удаляет.</li>
</ul></li>
<li><code>anti_join()</code> оставляет только те строки, которым не нашлось соответствия.</li>
</ul>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="tidy.html#cb64-1"></a>t1 &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">id =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dt">x1 =</span> LETTERS[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>])</span>
<span id="cb64-2"><a href="tidy.html#cb64-2"></a>t2 &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">id =</span> <span class="kw">seq</span>(<span class="dv">2</span>, <span class="dv">10</span>, <span class="dv">2</span>), <span class="dt">x2 =</span> LETTERS[<span class="dv">11</span><span class="op">:</span><span class="dv">15</span>])</span></code></pre></div>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="tidy.html#cb65-1"></a><span class="kw">left_join</span>(t1, t2)</span></code></pre></div>
<pre><code>## Joining, by = &quot;id&quot;</code></pre>
<pre><code>## # A tibble: 5 x 3
##      id x1    x2   
##   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
## 1     1 A     &lt;NA&gt; 
## 2     2 B     K    
## 3     3 C     &lt;NA&gt; 
## 4     4 D     L    
## 5     5 E     &lt;NA&gt;</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="tidy.html#cb68-1"></a><span class="kw">right_join</span>(t1, t2)</span></code></pre></div>
<pre><code>## Joining, by = &quot;id&quot;</code></pre>
<pre><code>## # A tibble: 5 x 3
##      id x1    x2   
##   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
## 1     2 B     K    
## 2     4 D     L    
## 3     6 &lt;NA&gt;  M    
## 4     8 &lt;NA&gt;  N    
## 5    10 &lt;NA&gt;  O</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="tidy.html#cb71-1"></a><span class="kw">full_join</span>(t1, t2)</span></code></pre></div>
<pre><code>## Joining, by = &quot;id&quot;</code></pre>
<pre><code>## # A tibble: 8 x 3
##      id x1    x2   
##   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
## 1     1 A     &lt;NA&gt; 
## 2     2 B     K    
## 3     3 C     &lt;NA&gt; 
## 4     4 D     L    
## 5     5 E     &lt;NA&gt; 
## 6     6 &lt;NA&gt;  M    
## 7     8 &lt;NA&gt;  N    
## 8    10 &lt;NA&gt;  O</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="tidy.html#cb74-1"></a><span class="kw">inner_join</span>(t1, t2)</span></code></pre></div>
<pre><code>## Joining, by = &quot;id&quot;</code></pre>
<pre><code>## # A tibble: 2 x 3
##      id x1    x2   
##   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
## 1     2 B     K    
## 2     4 D     L</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="tidy.html#cb77-1"></a><span class="kw">anti_join</span>(t1, t2)</span></code></pre></div>
<pre><code>## Joining, by = &quot;id&quot;</code></pre>
<pre><code>## # A tibble: 3 x 2
##      id x1   
##   &lt;int&gt; &lt;chr&gt;
## 1     1 A    
## 2     3 C    
## 3     5 E</code></pre>
<p>Как нам это поможет? У нас есть колонка <code>id</code> в обоих датасетах — <code>share</code> и <code>platform</code>. По ней мы и сможем соединить наши тибблы. Нам надо сделать так, чтобы все наши экспериментальные данные были сохранны. Используем <code>left_join()</code>:</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="tidy.html#cb80-1"></a>share <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(platform)</span></code></pre></div>
<pre><code>## Joining, by = &quot;id&quot;</code></pre>
<pre><code>## # A tibble: 6,000 x 11
##    trialtype setsize numtrial time1 click1x click1y time2 click2x click2y    id
##    &lt;chr&gt;       &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;
##  1 tray            8        1  1.67    -227     202 1.28       14    -351     1
##  2 tray            8        2  1.13     -69     231 1.06      -44    -392     1
##  3 tray            8        3  2.60      60     195 0.963      17    -361     1
##  4 tray            8        4  2.61     199     213 0.863     -26    -356     1
##  5 tray            8        5  1.59    -241      43 0.931     -25    -397     1
##  6 tray            8        6  1.14     -51      59 0.896      10    -383     1
##  7 tray            8        7  2.14      99      62 0.879     -29    -372     1
##  8 tray            8        8  1.63     213      46 0.947     -27    -353     1
##  9 tray            8        9  2.56    -201    -123 1.65      -25    -385     1
## 10 tray            8       10  2.02     -70     -82 0.970     -19    -394     1
## # … with 5,990 more rows, and 1 more variable: platform &lt;chr&gt;</code></pre>
<p>Наблюдаем, что строки <code>platform</code> были продублированы столько раз, сколько нужно было, чтобы сохранились все строки тиббла с экспериментальными данными.</p>
<p>Не забываем перезаписать наш тиббл:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="tidy.html#cb83-1"></a>share <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(platform) -&gt;<span class="st"> </span>share</span></code></pre></div>
<pre><code>## Joining, by = &quot;id&quot;</code></pre>
<img class="taskimg" src="img/code.png">
<div class="task">
<p>В нашей папке с данными есть файл <code>targetpositions.xlsx</code>, который содержит координаты, по которым мы сможем отобрать правильные клики наших испытуемых. Изучите этот файл, загрузите его как <code>tibble</code> и соедините его с нашим основным тибблом <code>share</code>.</p>
<p>Подумайте, какие колонки тибблов вы будете использовать для объединения.</p>
<pre><code>## # A tibble: 6,150 x 23
##    trialtype setsize numtrial time1 click1x click1y time2 click2x click2y    id
##    &lt;chr&gt;       &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;
##  1 tray            8        1  1.67    -227     202 1.28       14    -351     1
##  2 tray            8        2  1.13     -69     231 1.06      -44    -392     1
##  3 tray            8        3  2.60      60     195 0.963      17    -361     1
##  4 tray            8        4  2.61     199     213 0.863     -26    -356     1
##  5 tray            8        5  1.59    -241      43 0.931     -25    -397     1
##  6 tray            8        6  1.14     -51      59 0.896      10    -383     1
##  7 tray            8        7  2.14      99      62 0.879     -29    -372     1
##  8 tray            8        8  1.63     213      46 0.947     -27    -353     1
##  9 tray            8        9  2.56    -201    -123 1.65      -25    -385     1
## 10 tray            8       10  2.02     -70     -82 0.970     -19    -394     1
## # … with 6,140 more rows, and 13 more variables: platform &lt;chr&gt;, posx1 &lt;dbl&gt;,
## #   posy1 &lt;dbl&gt;, posxmin1 &lt;dbl&gt;, posxmax1 &lt;dbl&gt;, posymin1 &lt;dbl&gt;,
## #   posymax1 &lt;dbl&gt;, posx2 &lt;dbl&gt;, posy2 &lt;dbl&gt;, posxmin2 &lt;dbl&gt;, posxmax2 &lt;dbl&gt;,
## #   posymin2 &lt;dbl&gt;, posymax2 &lt;dbl&gt;</code></pre>
</div>
</div>
</div>
<div id="группировка-и-аггрегация-данных" class="section level2">
<h2><span class="header-section-number">7.10</span> Группировка и аггрегация данных</h2>
<p>Часто возникает необходимость <strong>аггрегировать</strong> данные, то есть посчитать какие-то показатели, причем на по всему датасету, а по группам, имеющимся в нём. Займемся этим мероприятием.</p>
<div id="group_by-ungroup" class="section level3">
<h3><span class="header-section-number">7.10.1</span> <code>group_by()</code> &amp; <code>ungroup()</code></h3>
<p>Нам тиббл сам по себе не знает, что в нём есть какие-то группы. Поэтому ему надо рассказать, как дело обстоит. Сгруппируем наши данные по экспериметальным условиям:</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="tidy.html#cb86-1"></a>share <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(trialtype)</span></code></pre></div>
<pre><code>## # A tibble: 6,150 x 23
## # Groups:   trialtype [3]
##    trialtype setsize numtrial time1 click1x click1y time2 click2x click2y    id
##    &lt;chr&gt;       &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;
##  1 tray            8        1  1.67    -227     202 1.28       14    -351     1
##  2 tray            8        2  1.13     -69     231 1.06      -44    -392     1
##  3 tray            8        3  2.60      60     195 0.963      17    -361     1
##  4 tray            8        4  2.61     199     213 0.863     -26    -356     1
##  5 tray            8        5  1.59    -241      43 0.931     -25    -397     1
##  6 tray            8        6  1.14     -51      59 0.896      10    -383     1
##  7 tray            8        7  2.14      99      62 0.879     -29    -372     1
##  8 tray            8        8  1.63     213      46 0.947     -27    -353     1
##  9 tray            8        9  2.56    -201    -123 1.65      -25    -385     1
## 10 tray            8       10  2.02     -70     -82 0.970     -19    -394     1
## # … with 6,140 more rows, and 13 more variables: platform &lt;chr&gt;, posx1 &lt;dbl&gt;,
## #   posy1 &lt;dbl&gt;, posxmin1 &lt;dbl&gt;, posxmax1 &lt;dbl&gt;, posymin1 &lt;dbl&gt;,
## #   posymax1 &lt;dbl&gt;, posx2 &lt;dbl&gt;, posy2 &lt;dbl&gt;, posxmin2 &lt;dbl&gt;, posxmax2 &lt;dbl&gt;,
## #   posymin2 &lt;dbl&gt;, posymax2 &lt;dbl&gt;</code></pre>
<p>Теперь в выводе тиббла указаны переменные, по которым сгруппированы наши данные (<code>Groups</code>). В структуре это тоже будет отображено:</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="tidy.html#cb88-1"></a>share <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(trialtype) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">str</span>()</span></code></pre></div>
<pre><code>## tibble [6,150 × 23] (S3: grouped_df/tbl_df/tbl/data.frame)
##  $ trialtype: chr [1:6150] &quot;tray&quot; &quot;tray&quot; &quot;tray&quot; &quot;tray&quot; ...
##  $ setsize  : num [1:6150] 8 8 8 8 8 8 8 8 8 8 ...
##  $ numtrial : num [1:6150] 1 2 3 4 5 6 7 8 9 10 ...
##  $ time1    : num [1:6150] 1.67 1.13 2.6 2.61 1.59 ...
##  $ click1x  : num [1:6150] -227 -69 60 199 -241 -51 99 213 -201 -70 ...
##  $ click1y  : num [1:6150] 202 231 195 213 43 59 62 46 -123 -82 ...
##  $ time2    : num [1:6150] 1.28 1.061 0.963 0.863 0.931 ...
##  $ click2x  : num [1:6150] 14 -44 17 -26 -25 10 -29 -27 -25 -19 ...
##  $ click2y  : num [1:6150] -351 -392 -361 -356 -397 -383 -372 -353 -385 -394 ...
##  $ id       : num [1:6150] 1 1 1 1 1 1 1 1 1 1 ...
##  $ platform : chr [1:6150] &quot;ios&quot; &quot;ios&quot; &quot;ios&quot; &quot;ios&quot; ...
##  $ posx1    : num [1:6150] -238 -63 66 203 -243 -60 73 213 -229 -84 ...
##  $ posy1    : num [1:6150] 202 226 217 218 59 90 66 52 -93 -79 ...
##  $ posxmin1 : num [1:6150] -313 -138 -9 128 -318 -135 -2 138 -304 -159 ...
##  $ posxmax1 : num [1:6150] -163 12 141 278 -168 15 148 288 -154 -9 ...
##  $ posymin1 : num [1:6150] 127 151 142 143 -16 15 -9 -23 -168 -154 ...
##  $ posymax1 : num [1:6150] 277 301 292 293 134 165 141 127 -18 -4 ...
##  $ posx2    : num [1:6150] 450 450 450 450 450 450 450 450 450 450 ...
##  $ posy2    : num [1:6150] -350 -350 -350 -350 -350 -350 -350 -350 -350 -350 ...
##  $ posxmin2 : num [1:6150] 350 350 350 350 350 350 350 350 350 350 ...
##  $ posxmax2 : num [1:6150] 550 550 550 550 550 550 550 550 550 550 ...
##  $ posymin2 : num [1:6150] -425 -425 -425 -425 -425 -425 -425 -425 -425 -425 ...
##  $ posymax2 : num [1:6150] -275 -275 -275 -275 -275 -275 -275 -275 -275 -275 ...
##  - attr(*, &quot;groups&quot;)= tibble [3 × 2] (S3: tbl_df/tbl/data.frame)
##   ..$ trialtype: chr [1:3] &quot;dots&quot; &quot;tray&quot; NA
##   ..$ .rows    : list&lt;int&gt; [1:3] 
##   .. ..$ : int [1:3000] 51 52 53 54 55 56 57 58 59 60 ...
##   .. ..$ : int [1:3000] 1 2 3 4 5 6 7 8 9 10 ...
##   .. ..$ : int [1:150] 6001 6002 6003 6004 6005 6006 6007 6008 6009 6010 ...
##   .. ..@ ptype: int(0) 
##   ..- attr(*, &quot;.drop&quot;)= logi TRUE</code></pre>
<p>В первой строчке аутпута появилось указание <code>groupped</code>. Это как раз то, что мы хотели сделать. Можно перезаписать наш тиббл и посмотреть, как он будет выводиться в консоль:</p>
<p>Если нам нужно убрать группировку, то есть функция <code>ungroup()</code>:</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="tidy.html#cb90-1"></a>share <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ungroup</span>()</span></code></pre></div>
<pre><code>## # A tibble: 6,150 x 23
##    trialtype setsize numtrial time1 click1x click1y time2 click2x click2y    id
##    &lt;chr&gt;       &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;
##  1 tray            8        1  1.67    -227     202 1.28       14    -351     1
##  2 tray            8        2  1.13     -69     231 1.06      -44    -392     1
##  3 tray            8        3  2.60      60     195 0.963      17    -361     1
##  4 tray            8        4  2.61     199     213 0.863     -26    -356     1
##  5 tray            8        5  1.59    -241      43 0.931     -25    -397     1
##  6 tray            8        6  1.14     -51      59 0.896      10    -383     1
##  7 tray            8        7  2.14      99      62 0.879     -29    -372     1
##  8 tray            8        8  1.63     213      46 0.947     -27    -353     1
##  9 tray            8        9  2.56    -201    -123 1.65      -25    -385     1
## 10 tray            8       10  2.02     -70     -82 0.970     -19    -394     1
## # … with 6,140 more rows, and 13 more variables: platform &lt;chr&gt;, posx1 &lt;dbl&gt;,
## #   posy1 &lt;dbl&gt;, posxmin1 &lt;dbl&gt;, posxmax1 &lt;dbl&gt;, posymin1 &lt;dbl&gt;,
## #   posymax1 &lt;dbl&gt;, posx2 &lt;dbl&gt;, posy2 &lt;dbl&gt;, posxmin2 &lt;dbl&gt;, posxmax2 &lt;dbl&gt;,
## #   posymin2 &lt;dbl&gt;, posymax2 &lt;dbl&gt;</code></pre>
</div>
<div id="summarize" class="section level3">
<h3><span class="header-section-number">7.10.2</span> <code>summarize()</code></h3>
<p>Сама по себе функция <code>group_by()</code> особого смысла не имеет, но вот есть её использовать в связке в <code>summarize()</code>…</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="tidy.html#cb92-1"></a>share <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(trialtype) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb92-2"><a href="tidy.html#cb92-2"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(time1),</span>
<span id="cb92-3"><a href="tidy.html#cb92-3"></a>            <span class="dt">sd =</span> <span class="kw">sd</span>(time1))</span></code></pre></div>
<pre><code>## `summarise()` ungrouping output (override with `.groups` argument)</code></pre>
<pre><code>## # A tibble: 3 x 3
##   trialtype  mean     sd
##   &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt;
## 1 dots       1.60  0.886
## 2 tray       1.65  0.896
## 3 &lt;NA&gt;      NA    NA</code></pre>
<p>Что мы здесь сделали? Мы хотели посчитать среднее и стандартное отклонение времени реакции (первого клика), но не по всему датасету, а по экспериментальным условиям. Для этого мы сгруппироали тиббл по переменной, содержащей указания на экспериментальное условие, и затем аггрегировали наши данные — посчитали по ним некоторые статистики. Функция <code>§ummarise()</code> возвращает тиббл, в котором по строкам идут заданные нами группы, а по столбцам те статистики, которые мы указали в её аргументах. Для их подсчёта можно использовать любые функции — как специализированные их пакетов, так и встроенные в базовый R.</p>
<p>Допустим, мы хотим проверить, что эксперимент был сбалансирован по количеству проб в разных условиях. Тогда сделаем так:</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="tidy.html#cb95-1"></a>share <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(trialtype, setsize) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb95-2"><a href="tidy.html#cb95-2"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">n =</span> <span class="kw">n</span>())</span></code></pre></div>
<pre><code>## `summarise()` regrouping output by &#39;trialtype&#39; (override with `.groups` argument)</code></pre>
<pre><code>## # A tibble: 7 x 3
## # Groups:   trialtype [3]
##   trialtype setsize     n
##   &lt;chr&gt;       &lt;dbl&gt; &lt;int&gt;
## 1 dots            8  1000
## 2 dots           12  1000
## 3 dots           16  1000
## 4 tray            8  1000
## 5 tray           12  1000
## 6 tray           16  1000
## 7 &lt;NA&gt;           NA   150</code></pre>
<img class="taskimg" src="img/code.png">
<div class="task">
<p>При предобработке данных нам часто необходимо усреднить экспериментальные пробы по респондентам. Возьмите имеющиеся данные <code>share</code> и подготовьте их к дисперсионному анализу.</p>
<ol style="list-style-type: decimal">
<li><p>Создайте новую логическую переменную, которая будет содержать информацию о том, корректно ли выполнена данная проба. Корректной считается проба, в которой координаты клика респондента (<code>click1x</code>, <code>click1y</code>) попали в целевые диапазоны ([<code>posxmin1</code>, <code>posxmax1</code>] и [<code>posymin1</code>, <code>posymax1</code>]).</p></li>
<li><p>Отберите только корректные пробы.</p></li>
<li><p>Рассчитайте среднее и стандартное отклонение времени реакции (<code>time1</code>) по экспериментальным условиям (<code>trialtype</code>, <code>setsize</code>) для каждого испытуемого. Итоговый тиббл также должен содержать колонку <code>platform</code>.</p></li>
<li><p>Сохраните результат в новый объект.</p></li>
</ol>
<pre><code>## `summarise()` regrouping output by &#39;id&#39;, &#39;trialtype&#39;, &#39;setsize&#39; (override with `.groups` argument)</code></pre>
<pre><code>## # A tibble: 120 x 6
## # Groups:   id, trialtype, setsize [120]
##       id trialtype setsize platform  mean    sd
##    &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt;
##  1     1 dots            8 ios       1.59 0.467
##  2     1 dots           12 ios       1.88 0.647
##  3     1 dots           16 ios       2.18 1.14 
##  4     1 tray            8 ios       1.56 0.453
##  5     1 tray           12 ios       1.77 0.739
##  6     1 tray           16 ios       2.12 1.08 
##  7     2 dots            8 ios       1.54 0.566
##  8     2 dots           12 ios       1.59 0.613
##  9     2 dots           16 ios       1.99 1.00 
## 10     2 tray            8 ios       1.44 0.446
## # … with 110 more rows</code></pre>
</div>
</div>
</div>
<div id="широкий-и-длинный-формат" class="section level2">
<h2><span class="header-section-number">7.11</span> Широкий и длинный формат</h2>
<p>Мы получили новый тиббл который содержит аггрегированные данные. Теперь нам надо поговорить о <em>широком и длинном форматах данных</em>.</p>
<p>Как мы говорили ранее, <em>tidy data</em> задаёт нам следующий формат данных: по строкам идут наблюдения, по столбцам — отдельные переменные. Такой формат данных называется <em>широким</em>. Широкий он потому, что у нас может быть много отдельных переменных. <em>Длиннный</em> формат данных выглядит следующим образом: есть столбец <em>индентификаторов</em> (например, ID испытуемого), есть столбец <em>переменных</em>, и есть столбец <em>значений</em> этих переменных.</p>
<p>Это общая логика, и под каждую задачу у нас может быть свой длинный и свой широкий формат. Кроме того, данные могут быть разной «широкости» и разной «длинности», что тоже определяется конкретной задачей.</p>
<div id="pivot_longer-pivot_wider" class="section level3">
<h3><span class="header-section-number">7.11.1</span> <code>pivot_longer()</code> &amp; <code>pivot_wider()</code></h3>
<p>Наши данные сейчас — «средние». С одно стороны он — широкий, так как у нас есть две переменные <code>mean</code> и <code>id</code>, которые записаны в отдельных столбцах:</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="tidy.html#cb100-1"></a>share_aggregated</span></code></pre></div>
<pre><code>## # A tibble: 120 x 6
## # Groups:   id, trialtype, setsize [120]
##       id trialtype setsize platform  mean    sd
##    &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt;
##  1     1 dots            8 ios       1.59 0.467
##  2     1 dots           12 ios       1.88 0.647
##  3     1 dots           16 ios       2.18 1.14 
##  4     1 tray            8 ios       1.56 0.453
##  5     1 tray           12 ios       1.77 0.739
##  6     1 tray           16 ios       2.12 1.08 
##  7     2 dots            8 ios       1.54 0.566
##  8     2 dots           12 ios       1.59 0.613
##  9     2 dots           16 ios       1.99 1.00 
## 10     2 tray            8 ios       1.44 0.446
## # … with 110 more rows</code></pre>
<p>Мы можем перевести наши данный в длинный формат:</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="tidy.html#cb102-1"></a>share_aggregated <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">c</span>(<span class="st">&#39;mean&#39;</span>, <span class="st">&#39;sd&#39;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 240 x 6
## # Groups:   id, trialtype, setsize [120]
##       id trialtype setsize platform name  value
##    &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt; &lt;dbl&gt;
##  1     1 dots            8 ios      mean  1.59 
##  2     1 dots            8 ios      sd    0.467
##  3     1 dots           12 ios      mean  1.88 
##  4     1 dots           12 ios      sd    0.647
##  5     1 dots           16 ios      mean  2.18 
##  6     1 dots           16 ios      sd    1.14 
##  7     1 tray            8 ios      mean  1.56 
##  8     1 tray            8 ios      sd    0.453
##  9     1 tray           12 ios      mean  1.77 
## 10     1 tray           12 ios      sd    0.739
## # … with 230 more rows</code></pre>
<p>У нас появилась колонка <code>name</code>, которая задаёт названия наших переменных, и колонка <code>value</code>, которая задаёт их значения.</p>
<p>Однако мы можем перевести исходный датасет и в более широкий формат:</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="tidy.html#cb104-1"></a>share_aggregated <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>sd) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># переменная sd будет лишней</span></span>
<span id="cb104-2"><a href="tidy.html#cb104-2"></a><span class="st">  </span><span class="kw">pivot_wider</span>(<span class="dt">names_from =</span> <span class="st">&#39;setsize&#39;</span>, <span class="dt">values_from =</span> <span class="st">&#39;mean&#39;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 40 x 6
## # Groups:   id, trialtype [40]
##       id trialtype platform   `8`  `12`  `16`
##    &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1     1 dots      ios       1.59  1.88  2.18
##  2     1 tray      ios       1.56  1.77  2.12
##  3     2 dots      ios       1.54  1.59  1.99
##  4     2 tray      ios       1.44  1.74  2.68
##  5     3 dots      ios       1.53  1.82  1.99
##  6     3 tray      ios       1.46  2.05  2.48
##  7     4 dots      andr      1.35  1.73  1.97
##  8     4 tray      andr      1.32  1.61  1.65
##  9     5 dots      ios       1.22  1.34  1.44
## 10     5 tray      ios       1.22  1.51  1.73
## # … with 30 more rows</code></pre>
<p>Наблюдаем, что теперь время в различных сетсайзах расположено в отдельных колонках.</p>
<p>Из широкого формата удобнее доставать отдельные переменные, например, для сравнения t-тестов. Из длинного формата удобно доставать вектор значений и вектор групп, например, для дисперсионного анализа. Мы будем работать и с тем и с другим форматом, поэтому перемещаться между ними надо быстро и уверенно.</p>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>Помните разговор о <a href="https://angelgardt.github.io/hseuxlab-wlm2021/book/realdata.html#fn3">пространстве имен</a>?<a href="tidy.html#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>Чтобы полностью понять вторую строку, надо вспомнить, что оператор деления <code>/</code> — это тоже функция, которая принимает в себя два аргумента. В данном случае нам надо поделить единицу на косинус, значит косинус должен идти вторым.<a href="tidy.html#fnref2" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="realdata.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="visualization.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["wlm2021-book.pdf", "wlm2021-book.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>

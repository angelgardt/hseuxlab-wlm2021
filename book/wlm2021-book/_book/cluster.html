<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>25 Кластерный анализ | HSE UX LAB | Анализ данных + R: мир линейных моделей | Book</title>
  <meta name="description" content="Книга написана для слушателей курса по анализу данных от HSE UX LAB" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="25 Кластерный анализ | HSE UX LAB | Анализ данных + R: мир линейных моделей | Book" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Книга написана для слушателей курса по анализу данных от HSE UX LAB" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="25 Кластерный анализ | HSE UX LAB | Анализ данных + R: мир линейных моделей | Book" />
  
  <meta name="twitter:description" content="Книга написана для слушателей курса по анализу данных от HSE UX LAB" />
  

<meta name="author" content="А. Ангельгардт" />


<meta name="date" content="2021-01-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="glmm.html"/>
<link rel="next" href="pca.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="">HSE UX LAB | WLM 2021</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#благодарности"><i class="fa fa-check"></i>Благодарности</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#условные-обозначения"><i class="fa fa-check"></i>Условные обозначения</a></li>
</ul></li>
<li class="part"><span><b>I R programming</b></span></li>
<li class="chapter" data-level="1" data-path="Rintro.html"><a href="Rintro.html"><i class="fa fa-check"></i><b>1</b> Знакомство с R и RStudio</a><ul>
<li class="chapter" data-level="1.1" data-path="Rintro.html"><a href="Rintro.html#что-это-и-откуда"><i class="fa fa-check"></i><b>1.1</b> Что это и откуда?</a></li>
<li class="chapter" data-level="1.2" data-path="Rintro.html"><a href="Rintro.html#whyr"><i class="fa fa-check"></i><b>1.2</b> Почему R?</a><ul>
<li class="chapter" data-level="1.2.1" data-path="Rintro.html"><a href="Rintro.html#а-он-лучше-питона"><i class="fa fa-check"></i><b>1.2.1</b> А он лучше Питона?</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="Rintro.html"><a href="Rintro.html#установка-r-и-rstudio"><i class="fa fa-check"></i><b>1.3</b> Установка R и RStudio</a><ul>
<li class="chapter" data-level="1.3.1" data-path="Rintro.html"><a href="Rintro.html#а-зачем-обе-штуки-ставить"><i class="fa fa-check"></i><b>1.3.1</b> А зачем обе штуки ставить?</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="Rintro.html"><a href="Rintro.html#где-спросить-вопрос-или-искать-ответ"><i class="fa fa-check"></i><b>1.4</b> Где спросить вопрос или искать ответ?</a></li>
<li class="chapter" data-level="1.5" data-path="Rintro.html"><a href="Rintro.html#интерфейс-r"><i class="fa fa-check"></i><b>1.5</b> Интерфейс R</a></li>
<li class="chapter" data-level="1.6" data-path="Rintro.html"><a href="Rintro.html#интерфейс-rstudio"><i class="fa fa-check"></i><b>1.6</b> Интерфейс RStudio</a><ul>
<li class="chapter" data-level="1.6.1" data-path="Rintro.html"><a href="Rintro.html#console"><i class="fa fa-check"></i><b>1.6.1</b> Console</a></li>
<li class="chapter" data-level="1.6.2" data-path="Rintro.html"><a href="Rintro.html#code-editor"><i class="fa fa-check"></i><b>1.6.2</b> Code Editor</a></li>
<li class="chapter" data-level="1.6.3" data-path="Rintro.html"><a href="Rintro.html#environment-workspace-и-history"><i class="fa fa-check"></i><b>1.6.3</b> Environment (Workspace) и History</a></li>
<li class="chapter" data-level="1.6.4" data-path="Rintro.html"><a href="Rintro.html#plots-files-packages-help-viewer"><i class="fa fa-check"></i><b>1.6.4</b> Plots, Files, Packages, Help, Viewer</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="Rintro.html"><a href="Rintro.html#r-как-калькулятор"><i class="fa fa-check"></i><b>1.7</b> R как калькулятор</a><ul>
<li class="chapter" data-level="1.7.1" data-path="Rintro.html"><a href="Rintro.html#арифметические-операции"><i class="fa fa-check"></i><b>1.7.1</b> Арифметические операции</a></li>
<li class="chapter" data-level="1.7.2" data-path="Rintro.html"><a href="Rintro.html#funcs"><i class="fa fa-check"></i><b>1.7.2</b> Функции</a></li>
<li class="chapter" data-level="1.7.3" data-path="Rintro.html"><a href="Rintro.html#сравнение-и-логические-операции"><i class="fa fa-check"></i><b>1.7.3</b> Сравнение и логические операции</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="Rintro.html"><a href="Rintro.html#assignment-и-переменные"><i class="fa fa-check"></i><b>1.8</b> Assignment и переменные</a></li>
<li class="chapter" data-level="1.9" data-path="Rintro.html"><a href="Rintro.html#wd"><i class="fa fa-check"></i><b>1.9</b> Рабочая директория. Projects</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="datatypes.html"><a href="datatypes.html"><i class="fa fa-check"></i><b>2</b> Типы данных</a><ul>
<li class="chapter" data-level="2.1" data-path="datatypes.html"><a href="datatypes.html#numeric"><i class="fa fa-check"></i><b>2.1</b> <code>numeric</code></a></li>
<li class="chapter" data-level="2.2" data-path="datatypes.html"><a href="datatypes.html#logical"><i class="fa fa-check"></i><b>2.2</b> <code>logical</code></a></li>
<li class="chapter" data-level="2.3" data-path="datatypes.html"><a href="datatypes.html#character"><i class="fa fa-check"></i><b>2.3</b> <code>character</code></a></li>
<li class="chapter" data-level="2.4" data-path="datatypes.html"><a href="datatypes.html#factors"><i class="fa fa-check"></i><b>2.4</b> <code>factor</code></a></li>
<li class="chapter" data-level="2.5" data-path="datatypes.html"><a href="datatypes.html#coercion-part-one"><i class="fa fa-check"></i><b>2.5</b> Coercion [part one]</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="datastructures.html"><a href="datastructures.html"><i class="fa fa-check"></i><b>3</b> Структуры данных</a><ul>
<li class="chapter" data-level="3.1" data-path="datastructures.html"><a href="datastructures.html#векторы"><i class="fa fa-check"></i><b>3.1</b> Векторы</a><ul>
<li class="chapter" data-level="3.1.1" data-path="datastructures.html"><a href="datastructures.html#coercion-part-two"><i class="fa fa-check"></i><b>3.1.1</b> Coercion [part two]</a></li>
<li class="chapter" data-level="3.1.2" data-path="datastructures.html"><a href="datastructures.html#генерация-числовых-последовательностей"><i class="fa fa-check"></i><b>3.1.2</b> Генерация числовых последовательностей</a></li>
<li class="chapter" data-level="3.1.3" data-path="datastructures.html"><a href="datastructures.html#операции-с-векторами"><i class="fa fa-check"></i><b>3.1.3</b> Операции с векторами</a></li>
<li class="chapter" data-level="3.1.4" data-path="datastructures.html"><a href="datastructures.html#recycling"><i class="fa fa-check"></i><b>3.1.4</b> Recycling</a></li>
<li class="chapter" data-level="3.1.5" data-path="datastructures.html"><a href="datastructures.html#индексация-векторов"><i class="fa fa-check"></i><b>3.1.5</b> Индексация векторов</a></li>
<li class="chapter" data-level="3.1.6" data-path="datastructures.html"><a href="datastructures.html#na-nan-null"><i class="fa fa-check"></i><b>3.1.6</b> NA, NaN, NULL</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="datastructures.html"><a href="datastructures.html#матрицы"><i class="fa fa-check"></i><b>3.2</b> Матрицы</a><ul>
<li class="chapter" data-level="3.2.1" data-path="datastructures.html"><a href="datastructures.html#индексация-матриц"><i class="fa fa-check"></i><b>3.2.1</b> Индексация матриц</a></li>
<li class="chapter" data-level="3.2.2" data-path="datastructures.html"><a href="datastructures.html#операции-в-матрицами"><i class="fa fa-check"></i><b>3.2.2</b> Операции в матрицами</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="datastructures.html"><a href="datastructures.html#списки"><i class="fa fa-check"></i><b>3.3</b> Списки</a><ul>
<li class="chapter" data-level="3.3.1" data-path="datastructures.html"><a href="datastructures.html#индексация-списков"><i class="fa fa-check"></i><b>3.3.1</b> Индексация списков</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="datastructures.html"><a href="datastructures.html#датафреймы"><i class="fa fa-check"></i><b>3.4</b> Датафреймы</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>4</b> Функции</a><ul>
<li class="chapter" data-level="4.1" data-path="functions.html"><a href="functions.html#открытый-исходный-код"><i class="fa fa-check"></i><b>4.1</b> Открытый исходный код</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="strings.html"><a href="strings.html"><i class="fa fa-check"></i><b>5</b> Строки</a><ul>
<li class="chapter" data-level="5.1" data-path="strings.html"><a href="strings.html#установка-дополнительных-пакетов"><i class="fa fa-check"></i><b>5.1</b> Установка дополнительных пакетов</a></li>
<li class="chapter" data-level="5.2" data-path="strings.html"><a href="strings.html#создание-строк"><i class="fa fa-check"></i><b>5.2</b> Создание строк</a></li>
<li class="chapter" data-level="5.3" data-path="strings.html"><a href="strings.html#конкатенация-строк"><i class="fa fa-check"></i><b>5.3</b> Конкатенация строк</a></li>
<li class="chapter" data-level="5.4" data-path="strings.html"><a href="strings.html#разделение-строк"><i class="fa fa-check"></i><b>5.4</b> Разделение строк</a></li>
<li class="chapter" data-level="5.5" data-path="strings.html"><a href="strings.html#сортировка-строк"><i class="fa fa-check"></i><b>5.5</b> Сортировка строк</a></li>
<li class="chapter" data-level="5.6" data-path="strings.html"><a href="strings.html#изменение-регистра"><i class="fa fa-check"></i><b>5.6</b> Изменение регистра</a></li>
<li class="chapter" data-level="5.7" data-path="strings.html"><a href="strings.html#поиск-подстроки"><i class="fa fa-check"></i><b>5.7</b> Поиск подстроки</a></li>
<li class="chapter" data-level="5.8" data-path="strings.html"><a href="strings.html#изменение-строк"><i class="fa fa-check"></i><b>5.8</b> Изменение строк</a><ul>
<li class="chapter" data-level="5.8.1" data-path="strings.html"><a href="strings.html#выделение-подстроки"><i class="fa fa-check"></i><b>5.8.1</b> Выделение подстроки</a></li>
<li class="chapter" data-level="5.8.2" data-path="strings.html"><a href="strings.html#замена-подстроки"><i class="fa fa-check"></i><b>5.8.2</b> Замена подстроки</a></li>
<li class="chapter" data-level="5.8.3" data-path="strings.html"><a href="strings.html#удаление-подстроки"><i class="fa fa-check"></i><b>5.8.3</b> Удаление подстроки</a></li>
<li class="chapter" data-level="5.8.4" data-path="strings.html"><a href="strings.html#транслитерация-строк"><i class="fa fa-check"></i><b>5.8.4</b> Транслитерация строк</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="strings.html"><a href="strings.html#регулярные-выражения"><i class="fa fa-check"></i><b>5.9</b> Регулярные выражения</a><ul>
<li class="chapter" data-level="5.9.1" data-path="strings.html"><a href="strings.html#метасимволы"><i class="fa fa-check"></i><b>5.9.1</b> Метасимволы</a></li>
<li class="chapter" data-level="5.9.2" data-path="strings.html"><a href="strings.html#классы-знаков"><i class="fa fa-check"></i><b>5.9.2</b> Классы знаков</a></li>
<li class="chapter" data-level="5.9.3" data-path="strings.html"><a href="strings.html#quant"><i class="fa fa-check"></i><b>5.9.3</b> Квантификация</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="realdata.html"><a href="realdata.html"><i class="fa fa-check"></i><b>6</b> Работа с реальными данными</a><ul>
<li class="chapter" data-level="6.1" data-path="realdata.html"><a href="realdata.html#рабочая-директория"><i class="fa fa-check"></i><b>6.1</b> Рабочая директория</a></li>
<li class="chapter" data-level="6.2" data-path="realdata.html"><a href="realdata.html#импорт-данных"><i class="fa fa-check"></i><b>6.2</b> Импорт данных</a><ul>
<li class="chapter" data-level="6.2.1" data-path="realdata.html"><a href="realdata.html#форматы-данных"><i class="fa fa-check"></i><b>6.2.1</b> Форматы данных</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="realdata.html"><a href="realdata.html#исследование-данных"><i class="fa fa-check"></i><b>6.3</b> Исследование данных</a></li>
<li class="chapter" data-level="6.4" data-path="realdata.html"><a href="realdata.html#файл-.rdata"><i class="fa fa-check"></i><b>6.4</b> Файл <code>.RData</code></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="tidy.html"><a href="tidy.html"><i class="fa fa-check"></i><b>7</b> Предобработка данных. Концепция tidy data</a><ul>
<li class="chapter" data-level="7.1" data-path="tidy.html"><a href="tidy.html#tidyverse"><i class="fa fa-check"></i><b>7.1</b> <code>tidyverse</code></a></li>
<li class="chapter" data-level="7.2" data-path="tidy.html"><a href="tidy.html#импорт-данных-1"><i class="fa fa-check"></i><b>7.2</b> Импорт данных</a></li>
<li class="chapter" data-level="7.3" data-path="tidy.html"><a href="tidy.html#tibble"><i class="fa fa-check"></i><b>7.3</b> <code>tibble</code></a></li>
<li class="chapter" data-level="7.4" data-path="tidy.html"><a href="tidy.html#грузим-много-данных"><i class="fa fa-check"></i><b>7.4</b> Грузим много данных</a></li>
<li class="chapter" data-level="7.5" data-path="tidy.html"><a href="tidy.html#сабсет-данных"><i class="fa fa-check"></i><b>7.5</b> Сабсет данных</a><ul>
<li class="chapter" data-level="7.5.1" data-path="tidy.html"><a href="tidy.html#pipe"><i class="fa fa-check"></i><b>7.5.1</b> <code>%&gt;%</code></a></li>
<li class="chapter" data-level="7.5.2" data-path="tidy.html"><a href="tidy.html#select"><i class="fa fa-check"></i><b>7.5.2</b> <code>select()</code></a></li>
<li class="chapter" data-level="7.5.3" data-path="tidy.html"><a href="tidy.html#rename"><i class="fa fa-check"></i><b>7.5.3</b> <code>rename()</code></a></li>
<li class="chapter" data-level="7.5.4" data-path="tidy.html"><a href="tidy.html#slice"><i class="fa fa-check"></i><b>7.5.4</b> <code>slice()</code></a></li>
<li class="chapter" data-level="7.5.5" data-path="tidy.html"><a href="tidy.html#filter"><i class="fa fa-check"></i><b>7.5.5</b> <code>filter()</code></a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="tidy.html"><a href="tidy.html#mutate"><i class="fa fa-check"></i><b>7.6</b> <code>mutate()</code></a></li>
<li class="chapter" data-level="7.7" data-path="tidy.html"><a href="tidy.html#догрузим-остальные-данные"><i class="fa fa-check"></i><b>7.7</b> Догрузим остальные данные</a><ul>
<li class="chapter" data-level="7.7.1" data-path="tidy.html"><a href="tidy.html#соединение-датафреймов-i"><i class="fa fa-check"></i><b>7.7.1</b> Соединение датафреймов I</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="tidy.html"><a href="tidy.html#сортировка"><i class="fa fa-check"></i><b>7.8</b> Сортировка</a><ul>
<li class="chapter" data-level="7.8.1" data-path="tidy.html"><a href="tidy.html#sort"><i class="fa fa-check"></i><b>7.8.1</b> <code>sort()</code></a></li>
<li class="chapter" data-level="7.8.2" data-path="tidy.html"><a href="tidy.html#arrange"><i class="fa fa-check"></i><b>7.8.2</b> <code>arrange()</code></a></li>
<li class="chapter" data-level="7.8.3" data-path="tidy.html"><a href="tidy.html#distinct"><i class="fa fa-check"></i><b>7.8.3</b> <code>distinct()</code></a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="tidy.html"><a href="tidy.html#соединение-датафреймов-ii"><i class="fa fa-check"></i><b>7.9</b> Соединение датафреймов II</a><ul>
<li class="chapter" data-level="7.9.1" data-path="tidy.html"><a href="tidy.html#join"><i class="fa fa-check"></i><b>7.9.1</b> <code>..._join()</code></a></li>
</ul></li>
<li class="chapter" data-level="7.10" data-path="tidy.html"><a href="tidy.html#группировка-и-аггрегация-данных"><i class="fa fa-check"></i><b>7.10</b> Группировка и аггрегация данных</a><ul>
<li class="chapter" data-level="7.10.1" data-path="tidy.html"><a href="tidy.html#group_by-ungroup"><i class="fa fa-check"></i><b>7.10.1</b> <code>group_by()</code> &amp; <code>ungroup()</code></a></li>
<li class="chapter" data-level="7.10.2" data-path="tidy.html"><a href="tidy.html#summarize"><i class="fa fa-check"></i><b>7.10.2</b> <code>summarize()</code></a></li>
</ul></li>
<li class="chapter" data-level="7.11" data-path="tidy.html"><a href="tidy.html#широкий-и-длинный-формат"><i class="fa fa-check"></i><b>7.11</b> Широкий и длинный формат</a><ul>
<li class="chapter" data-level="7.11.1" data-path="tidy.html"><a href="tidy.html#pivot_longer-pivot_wider"><i class="fa fa-check"></i><b>7.11.1</b> <code>pivot_longer()</code> &amp; <code>pivot_wider()</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="visualization.html"><a href="visualization.html"><i class="fa fa-check"></i><b>8</b> Визуализация данных</a><ul>
<li class="chapter" data-level="8.1" data-path="visualization.html"><a href="visualization.html#философия-ggplot2-a-layered-grammar-of-graphics"><i class="fa fa-check"></i><b>8.1</b> Философия ggplot2 (A Layered Grammar of Graphics)</a><ul>
<li class="chapter" data-level="8.1.1" data-path="visualization.html"><a href="visualization.html#собственно-к-философии-построения-графиков"><i class="fa fa-check"></i><b>8.1.1</b> Собственно к философии построения графиков</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="visualization.html"><a href="visualization.html#данные"><i class="fa fa-check"></i><b>8.2</b> Данные</a></li>
<li class="chapter" data-level="8.3" data-path="visualization.html"><a href="visualization.html#строим-базовый-график"><i class="fa fa-check"></i><b>8.3</b> Строим базовый график</a><ul>
<li class="chapter" data-level="8.3.1" data-path="visualization.html"><a href="visualization.html#базовый-слой"><i class="fa fa-check"></i><b>8.3.1</b> Базовый слой</a></li>
<li class="chapter" data-level="8.3.2" data-path="visualization.html"><a href="visualization.html#разметка-осей-и-переменные"><i class="fa fa-check"></i><b>8.3.2</b> Разметка осей и переменные</a></li>
<li class="chapter" data-level="8.3.3" data-path="visualization.html"><a href="visualization.html#геомы"><i class="fa fa-check"></i><b>8.3.3</b> Геомы</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="visualization.html"><a href="visualization.html#группировка-по-переменной"><i class="fa fa-check"></i><b>8.4</b> Группировка по переменной</a></li>
<li class="chapter" data-level="8.5" data-path="visualization.html"><a href="visualization.html#графики-со-встроенной-статистической-обработкой"><i class="fa fa-check"></i><b>8.5</b> Графики со встроенной статистической обработкой</a><ul>
<li class="chapter" data-level="8.5.1" data-path="visualization.html"><a href="visualization.html#статы-stat_"><i class="fa fa-check"></i><b>8.5.1</b> Статы (stat_)</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="visualization.html"><a href="visualization.html#ищем-более-сложные-закономерности"><i class="fa fa-check"></i><b>8.6</b> Ищем более сложные закономерности</a></li>
<li class="chapter" data-level="8.7" data-path="visualization.html"><a href="visualization.html#настраиваем-график"><i class="fa fa-check"></i><b>8.7</b> Настраиваем график</a><ul>
<li class="chapter" data-level="8.7.1" data-path="visualization.html"><a href="visualization.html#темы"><i class="fa fa-check"></i><b>8.7.1</b> Темы</a></li>
<li class="chapter" data-level="8.7.2" data-path="visualization.html"><a href="visualization.html#кастомизация-шкал-scale_"><i class="fa fa-check"></i><b>8.7.2</b> Кастомизация шкал (scale_)</a></li>
<li class="chapter" data-level="8.7.3" data-path="visualization.html"><a href="visualization.html#последние-штрихи"><i class="fa fa-check"></i><b>8.7.3</b> Последние штрихи</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="visualization.html"><a href="visualization.html#больше-переменных"><i class="fa fa-check"></i><b>8.8</b> Больше переменных</a><ul>
<li class="chapter" data-level="8.8.1" data-path="visualization.html"><a href="visualization.html#фасетизация"><i class="fa fa-check"></i><b>8.8.1</b> Фасетизация</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="visualization.html"><a href="visualization.html#сохранение-графиков"><i class="fa fa-check"></i><b>8.9</b> Сохранение графиков</a></li>
<li class="chapter" data-level="8.10" data-path="visualization.html"><a href="visualization.html#другие-геомы"><i class="fa fa-check"></i><b>8.10</b> Другие геомы</a></li>
</ul></li>
<li class="part"><span><b>II Теория вероятностей и математическая статистика</b></span></li>
<li class="chapter" data-level="9" data-path="maths.html"><a href="maths.html"><i class="fa fa-check"></i><b>9</b> Математический ликбез</a><ul>
<li class="chapter" data-level="9.1" data-path="maths.html"><a href="maths.html#alg_logic"><i class="fa fa-check"></i><b>9.1</b> Элементы алгебры логики</a><ul>
<li class="chapter" data-level="9.1.1" data-path="maths.html"><a href="maths.html#высказывания"><i class="fa fa-check"></i><b>9.1.1</b> Высказывания</a></li>
<li class="chapter" data-level="9.1.2" data-path="maths.html"><a href="maths.html#logic_operations"><i class="fa fa-check"></i><b>9.1.2</b> Логические операции</a></li>
<li class="chapter" data-level="9.1.3" data-path="maths.html"><a href="maths.html#сложные-высказвания"><i class="fa fa-check"></i><b>9.1.3</b> Сложные высказвания</a></li>
<li class="chapter" data-level="9.1.4" data-path="maths.html"><a href="maths.html#условные-высказывания"><i class="fa fa-check"></i><b>9.1.4</b> Условные высказывания</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="maths.html"><a href="maths.html#set_theory"><i class="fa fa-check"></i><b>9.2</b> Элементы теории множеств</a><ul>
<li class="chapter" data-level="9.2.1" data-path="maths.html"><a href="maths.html#set"><i class="fa fa-check"></i><b>9.2.1</b> Множество</a></li>
<li class="chapter" data-level="9.2.2" data-path="maths.html"><a href="maths.html#sets_operations"><i class="fa fa-check"></i><b>9.2.2</b> Операции над множествами</a></li>
<li class="chapter" data-level="9.2.3" data-path="maths.html"><a href="maths.html#отображения"><i class="fa fa-check"></i><b>9.2.3</b> Отображения</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="maths.html"><a href="maths.html#combinatorics"><i class="fa fa-check"></i><b>9.3</b> Немного комбинаторики</a><ul>
<li class="chapter" data-level="9.3.1" data-path="maths.html"><a href="maths.html#permutations"><i class="fa fa-check"></i><b>9.3.1</b> Перестановки</a></li>
<li class="chapter" data-level="9.3.2" data-path="maths.html"><a href="maths.html#accomodations"><i class="fa fa-check"></i><b>9.3.2</b> Размещения</a></li>
<li class="chapter" data-level="9.3.3" data-path="maths.html"><a href="maths.html#combinations"><i class="fa fa-check"></i><b>9.3.3</b> Сочетания</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="maths.html"><a href="maths.html#calculus"><i class="fa fa-check"></i><b>9.4</b> Элементы математического анализа</a><ul>
<li class="chapter" data-level="9.4.1" data-path="maths.html"><a href="maths.html#последовательность"><i class="fa fa-check"></i><b>9.4.1</b> Последовательность</a></li>
<li class="chapter" data-level="9.4.2" data-path="maths.html"><a href="maths.html#предел-последовательности"><i class="fa fa-check"></i><b>9.4.2</b> Предел последовательности</a></li>
<li class="chapter" data-level="9.4.3" data-path="maths.html"><a href="maths.html#функции"><i class="fa fa-check"></i><b>9.4.3</b> Функции</a></li>
<li class="chapter" data-level="9.4.4" data-path="maths.html"><a href="maths.html#дифференцируемость-функции.-производная"><i class="fa fa-check"></i><b>9.4.4</b> Дифференцируемость функции. Производная</a></li>
<li class="chapter" data-level="9.4.5" data-path="maths.html"><a href="maths.html#функции-нескольких-переменных"><i class="fa fa-check"></i><b>9.4.5</b> Функции нескольких переменных</a></li>
<li class="chapter" data-level="9.4.6" data-path="maths.html"><a href="maths.html#partial"><i class="fa fa-check"></i><b>9.4.6</b> Частные производные</a></li>
<li class="chapter" data-level="9.4.7" data-path="maths.html"><a href="maths.html#интеграл"><i class="fa fa-check"></i><b>9.4.7</b> Интеграл</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="maths.html"><a href="maths.html#matrix"><i class="fa fa-check"></i><b>9.5</b> Элементы линейной алгебры</a><ul>
<li class="chapter" data-level="9.5.1" data-path="maths.html"><a href="maths.html#что-такое-матрица"><i class="fa fa-check"></i><b>9.5.1</b> Что такое матрица?</a></li>
<li class="chapter" data-level="9.5.2" data-path="maths.html"><a href="maths.html#откуда-берутся-матрицы"><i class="fa fa-check"></i><b>9.5.2</b> Откуда берутся матрицы?</a></li>
<li class="chapter" data-level="9.5.3" data-path="maths.html"><a href="maths.html#действия-с-матрицами"><i class="fa fa-check"></i><b>9.5.3</b> Действия с матрицами</a></li>
<li class="chapter" data-level="9.5.4" data-path="maths.html"><a href="maths.html#скалярное-произведение-векторов"><i class="fa fa-check"></i><b>9.5.4</b> Скалярное произведение векторов</a></li>
<li class="chapter" data-level="9.5.5" data-path="maths.html"><a href="maths.html#векторное-произведение-векторов"><i class="fa fa-check"></i><b>9.5.5</b> Векторное произведение векторов</a></li>
<li class="chapter" data-level="9.5.6" data-path="maths.html"><a href="maths.html#произведение-матриц-матричное-умножение"><i class="fa fa-check"></i><b>9.5.6</b> Произведение матриц (матричное умножение)</a></li>
<li class="chapter" data-level="9.5.7" data-path="maths.html"><a href="maths.html#транспонирование-матрицы"><i class="fa fa-check"></i><b>9.5.7</b> Транспонирование матрицы</a></li>
<li class="chapter" data-level="9.5.8" data-path="maths.html"><a href="maths.html#inv"><i class="fa fa-check"></i><b>9.5.8</b> Детерминант и обратная матрица</a></li>
<li class="chapter" data-level="9.5.9" data-path="maths.html"><a href="maths.html#след-матрицы"><i class="fa fa-check"></i><b>9.5.9</b> След матрицы</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="stats-intro.html"><a href="stats-intro.html"><i class="fa fa-check"></i><b>10</b> Введение в статистику</a><ul>
<li class="chapter" data-level="10.1" data-path="stats-intro.html"><a href="stats-intro.html#исходные-понятия-статистики"><i class="fa fa-check"></i><b>10.1</b> Исходные понятия статистики</a></li>
<li class="chapter" data-level="10.2" data-path="stats-intro.html"><a href="stats-intro.html#виды-статистических-данных"><i class="fa fa-check"></i><b>10.2</b> Виды статистических данных</a></li>
<li class="chapter" data-level="10.3" data-path="stats-intro.html"><a href="stats-intro.html#шкалы"><i class="fa fa-check"></i><b>10.3</b> Шкалы</a></li>
<li class="chapter" data-level="10.4" data-path="stats-intro.html"><a href="stats-intro.html#задачи-статистики"><i class="fa fa-check"></i><b>10.4</b> Задачи статистики</a><ul>
<li class="chapter" data-level="10.4.1" data-path="stats-intro.html"><a href="stats-intro.html#этапы-статистического-моделирования"><i class="fa fa-check"></i><b>10.4.1</b> Этапы статистического моделирования</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="randexp.html"><a href="randexp.html"><i class="fa fa-check"></i><b>11</b> Случайный эксперимент</a><ul>
<li class="chapter" data-level="11.1" data-path="randexp.html"><a href="randexp.html#ход-исследования"><i class="fa fa-check"></i><b>11.1</b> Ход исследования</a></li>
<li class="chapter" data-level="11.2" data-path="randexp.html"><a href="randexp.html#событие.-пространство-элементарных-событий."><i class="fa fa-check"></i><b>11.2</b> Событие. Пространство элементарных событий.</a><ul>
<li class="chapter" data-level="11.2.1" data-path="randexp.html"><a href="randexp.html#игральный-кубик"><i class="fa fa-check"></i><b>11.2.1</b> Игральный кубик</a></li>
<li class="chapter" data-level="11.2.2" data-path="randexp.html"><a href="randexp.html#events_operations"><i class="fa fa-check"></i><b>11.2.2</b> Действия над событиями</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="randexp.html"><a href="randexp.html#классическое-определение-вероятности"><i class="fa fa-check"></i><b>11.3</b> Классическое определение вероятности</a></li>
<li class="chapter" data-level="11.4" data-path="randexp.html"><a href="randexp.html#статистическое-определение-вероятности"><i class="fa fa-check"></i><b>11.4</b> Статистическое определение вероятности</a></li>
<li class="chapter" data-level="11.5" data-path="randexp.html"><a href="randexp.html#кроме-кубика"><i class="fa fa-check"></i><b>11.5</b> Кроме кубика</a></li>
<li class="chapter" data-level="11.6" data-path="randexp.html"><a href="randexp.html#вероятности-сложных-событий"><i class="fa fa-check"></i><b>11.6</b> Вероятности сложных событий</a><ul>
<li class="chapter" data-level="11.6.1" data-path="randexp.html"><a href="randexp.html#условная-вероятность"><i class="fa fa-check"></i><b>11.6.1</b> Условная вероятность</a></li>
<li class="chapter" data-level="11.6.2" data-path="randexp.html"><a href="randexp.html#теорема-байеса"><i class="fa fa-check"></i><b>11.6.2</b> Теорема Байеса</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="prob.html"><a href="prob.html"><i class="fa fa-check"></i><b>12</b> Вероятность и случайные величины</a><ul>
<li class="chapter" data-level="12.1" data-path="prob.html"><a href="prob.html#дискретные-случайные-величины"><i class="fa fa-check"></i><b>12.1</b> Дискретные случайные величины</a></li>
<li class="chapter" data-level="12.2" data-path="prob.html"><a href="prob.html#непрерывные-случайные-величины"><i class="fa fa-check"></i><b>12.2</b> Непрерывные случайные величины</a></li>
<li class="chapter" data-level="12.3" data-path="prob.html"><a href="prob.html#moments_distributions"><i class="fa fa-check"></i><b>12.3</b> Характеристики распределения случайных величин</a></li>
<li class="chapter" data-level="12.4" data-path="prob.html"><a href="prob.html#normal_distribution"><i class="fa fa-check"></i><b>12.4</b> Нормальное распределение</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="statestim.html"><a href="statestim.html"><i class="fa fa-check"></i><b>13</b> Оценивание параметров в практике статистического анализа</a><ul>
<li class="chapter" data-level="13.1" data-path="statestim.html"><a href="statestim.html#точечные-оценки"><i class="fa fa-check"></i><b>13.1</b> Точечные оценки</a><ul>
<li class="chapter" data-level="13.1.1" data-path="statestim.html"><a href="statestim.html#метод-моментов"><i class="fa fa-check"></i><b>13.1.1</b> Метод моментов</a></li>
<li class="chapter" data-level="13.1.2" data-path="statestim.html"><a href="statestim.html#свойства-точечных-оценок"><i class="fa fa-check"></i><b>13.1.2</b> Свойства точечных оценок</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="statestim.html"><a href="statestim.html#интервальные-оценки"><i class="fa fa-check"></i><b>13.2</b> Интервальные оценки</a><ul>
<li class="chapter" data-level="13.2.1" data-path="statestim.html"><a href="statestim.html#confinterval"><i class="fa fa-check"></i><b>13.2.1</b> Доверительный интервал</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="hypotheses.html"><a href="hypotheses.html"><i class="fa fa-check"></i><b>14</b> Тестирование статистических гипотез</a><ul>
<li class="chapter" data-level="14.1" data-path="hypotheses.html"><a href="hypotheses.html#базовые-понятия"><i class="fa fa-check"></i><b>14.1</b> Базовые понятия</a></li>
<li class="chapter" data-level="14.2" data-path="hypotheses.html"><a href="hypotheses.html#асимметрия-статистического-вывода"><i class="fa fa-check"></i><b>14.2</b> Асимметрия статистического вывода</a></li>
<li class="chapter" data-level="14.3" data-path="hypotheses.html"><a href="hypotheses.html#возможные-результаты-проверки-гипотез"><i class="fa fa-check"></i><b>14.3</b> Возможные результаты проверки гипотез</a></li>
<li class="chapter" data-level="14.4" data-path="hypotheses.html"><a href="hypotheses.html#алгоритм-тестирования-статистических-гипотез"><i class="fa fa-check"></i><b>14.4</b> Алгоритм тестирования статистических гипотез</a></li>
<li class="chapter" data-level="14.5" data-path="hypotheses.html"><a href="hypotheses.html#multiple_comp_problem"><i class="fa fa-check"></i><b>14.5</b> Проблема множественных сравнений</a></li>
</ul></li>
<li class="part"><span><b>III Анализ данных</b></span></li>
<li class="chapter" data-level="15" data-path="descriptives.html"><a href="descriptives.html"><i class="fa fa-check"></i><b>15</b> Описательные статистики</a><ul>
<li class="chapter" data-level="15.1" data-path="descriptives.html"><a href="descriptives.html#меры-центральной-тенденции"><i class="fa fa-check"></i><b>15.1</b> Меры центральной тенденции</a><ul>
<li class="chapter" data-level="15.1.1" data-path="descriptives.html"><a href="descriptives.html#мода"><i class="fa fa-check"></i><b>15.1.1</b> Мода</a></li>
<li class="chapter" data-level="15.1.2" data-path="descriptives.html"><a href="descriptives.html#медиана"><i class="fa fa-check"></i><b>15.1.2</b> Медиана</a></li>
<li class="chapter" data-level="15.1.3" data-path="descriptives.html"><a href="descriptives.html#среднее"><i class="fa fa-check"></i><b>15.1.3</b> Среднее</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="descriptives.html"><a href="descriptives.html#меры-разброса"><i class="fa fa-check"></i><b>15.2</b> Меры разброса</a><ul>
<li class="chapter" data-level="15.2.1" data-path="descriptives.html"><a href="descriptives.html#минимум-и-максимум"><i class="fa fa-check"></i><b>15.2.1</b> Минимум и максимум</a></li>
<li class="chapter" data-level="15.2.2" data-path="descriptives.html"><a href="descriptives.html#размах"><i class="fa fa-check"></i><b>15.2.2</b> Размах</a></li>
<li class="chapter" data-level="15.2.3" data-path="descriptives.html"><a href="descriptives.html#дисперсия"><i class="fa fa-check"></i><b>15.2.3</b> Дисперсия</a></li>
<li class="chapter" data-level="15.2.4" data-path="descriptives.html"><a href="descriptives.html#стандартное-отклонение"><i class="fa fa-check"></i><b>15.2.4</b> Стандартное отклонение</a></li>
<li class="chapter" data-level="15.2.5" data-path="descriptives.html"><a href="descriptives.html#стандартная-ошибка-среднего"><i class="fa fa-check"></i><b>15.2.5</b> Стандартная ошибка среднего</a></li>
<li class="chapter" data-level="15.2.6" data-path="descriptives.html"><a href="descriptives.html#квантили"><i class="fa fa-check"></i><b>15.2.6</b> Квантили</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="descriptives.html"><a href="descriptives.html#асимметрия"><i class="fa fa-check"></i><b>15.3</b> Асимметрия</a></li>
<li class="chapter" data-level="15.4" data-path="descriptives.html"><a href="descriptives.html#эксцесс"><i class="fa fa-check"></i><b>15.4</b> Эксцесс</a></li>
<li class="chapter" data-level="15.5" data-path="descriptives.html"><a href="descriptives.html#описательные-статистики-в-r"><i class="fa fa-check"></i><b>15.5</b> Описательные статистики в R</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="correlation.html"><a href="correlation.html"><i class="fa fa-check"></i><b>16</b> Корреляционный анализ</a><ul>
<li class="chapter" data-level="16.1" data-path="correlation.html"><a href="correlation.html#ковариация"><i class="fa fa-check"></i><b>16.1</b> Ковариация</a></li>
<li class="chapter" data-level="16.2" data-path="correlation.html"><a href="correlation.html#корреляция"><i class="fa fa-check"></i><b>16.2</b> Корреляция</a><ul>
<li class="chapter" data-level="16.2.1" data-path="correlation.html"><a href="correlation.html#тестирование-статистической-значимости-коэффициента-корреляции"><i class="fa fa-check"></i><b>16.2.1</b> Тестирование статистической значимости коэффициента корреляции</a></li>
<li class="chapter" data-level="16.2.2" data-path="correlation.html"><a href="correlation.html#доверительный-интервал-для-коэффициента-корреляции"><i class="fa fa-check"></i><b>16.2.2</b> Доверительный интервал для коэффициента корреляции</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="correlation.html"><a href="correlation.html#ковариация-и-корреляция-в-r"><i class="fa fa-check"></i><b>16.3</b> Ковариация и корреляция в R</a><ul>
<li class="chapter" data-level="16.3.1" data-path="correlation.html"><a href="correlation.html#коэффициенты-корреляции-для-разных-шкал"><i class="fa fa-check"></i><b>16.3.1</b> Коэффициенты корреляции для разных шкал</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="correlation.html"><a href="correlation.html#частный-и-множественный-коэффициент-корреляции"><i class="fa fa-check"></i><b>16.4</b> Частный и множественный коэффициент корреляции</a></li>
<li class="chapter" data-level="16.5" data-path="correlation.html"><a href="correlation.html#другие-корреляции"><i class="fa fa-check"></i><b>16.5</b> Другие корреляции</a><ul>
<li class="chapter" data-level="16.5.1" data-path="correlation.html"><a href="correlation.html#phi-коэффициент"><i class="fa fa-check"></i><b>16.5.1</b> <span class="math inline">\(\phi\)</span>-коэффициент</a></li>
<li class="chapter" data-level="16.5.2" data-path="correlation.html"><a href="correlation.html#бисериальный-коэффициент-корреляции"><i class="fa fa-check"></i><b>16.5.2</b> Бисериальный коэффициент корреляции</a></li>
<li class="chapter" data-level="16.5.3" data-path="correlation.html"><a href="correlation.html#рангово-бисериальный-коэффициент-корреляции"><i class="fa fa-check"></i><b>16.5.3</b> Рангово-бисериальный коэффициент корреляции</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="simple-linear.html"><a href="simple-linear.html"><i class="fa fa-check"></i><b>17</b> Общие линейные модели. Простая линейная регрессия</a><ul>
<li class="chapter" data-level="17.1" data-path="simple-linear.html"><a href="simple-linear.html#формализация-модели"><i class="fa fa-check"></i><b>17.1</b> Формализация модели</a></li>
<li class="chapter" data-level="17.2" data-path="simple-linear.html"><a href="simple-linear.html#идентификация-модели"><i class="fa fa-check"></i><b>17.2</b> Идентификация модели</a><ul>
<li class="chapter" data-level="17.2.1" data-path="simple-linear.html"><a href="simple-linear.html#метод-наименьших-квадратов"><i class="fa fa-check"></i><b>17.2.1</b> Метод наименьших квадратов</a></li>
<li class="chapter" data-level="17.2.2" data-path="simple-linear.html"><a href="simple-linear.html#матричное-вычисление-коэффициентов"><i class="fa fa-check"></i><b>17.2.2</b> Матричное вычисление коэффициентов</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="simple-linear.html"><a href="simple-linear.html#тестирование-качества-модели"><i class="fa fa-check"></i><b>17.3</b> Тестирование качества модели</a><ul>
<li class="chapter" data-level="17.3.1" data-path="simple-linear.html"><a href="simple-linear.html#коэффициент-детерминации"><i class="fa fa-check"></i><b>17.3.1</b> Коэффициент детерминации</a></li>
<li class="chapter" data-level="17.3.2" data-path="simple-linear.html"><a href="simple-linear.html#статистическая-значимость-модели"><i class="fa fa-check"></i><b>17.3.2</b> Статистическая значимость модели</a></li>
<li class="chapter" data-level="17.3.3" data-path="simple-linear.html"><a href="simple-linear.html#статистическая-значимость-отдельных-предикторов"><i class="fa fa-check"></i><b>17.3.3</b> Статистическая значимость отдельных предикторов</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="simple-linear.html"><a href="simple-linear.html#простая-линейная-регрессия-в-r"><i class="fa fa-check"></i><b>17.4</b> Простая линейная регрессия в R</a></li>
<li class="chapter" data-level="17.5" data-path="simple-linear.html"><a href="simple-linear.html#диагностика-модели"><i class="fa fa-check"></i><b>17.5</b> Диагностика модели</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="multiple-linear.html"><a href="multiple-linear.html"><i class="fa fa-check"></i><b>18</b> Множественная линейная регрессия</a><ul>
<li class="chapter" data-level="18.1" data-path="multiple-linear.html"><a href="multiple-linear.html#множественная-линейная-регрессия-с-количественными-предикторами"><i class="fa fa-check"></i><b>18.1</b> Множественная линейная регрессия с количественными предикторами</a><ul>
<li class="chapter" data-level="18.1.1" data-path="multiple-linear.html"><a href="multiple-linear.html#математическая-модель"><i class="fa fa-check"></i><b>18.1.1</b> Математическая модель</a></li>
<li class="chapter" data-level="18.1.2" data-path="multiple-linear.html"><a href="multiple-linear.html#подбор-модели"><i class="fa fa-check"></i><b>18.1.2</b> Подбор модели</a></li>
<li class="chapter" data-level="18.1.3" data-path="multiple-linear.html"><a href="multiple-linear.html#оценка-качества-модели"><i class="fa fa-check"></i><b>18.1.3</b> Оценка качества модели</a></li>
<li class="chapter" data-level="18.1.4" data-path="multiple-linear.html"><a href="multiple-linear.html#диагностика-модели-1"><i class="fa fa-check"></i><b>18.1.4</b> Диагностика модели</a></li>
<li class="chapter" data-level="18.1.5" data-path="multiple-linear.html"><a href="multiple-linear.html#staff_reg"><i class="fa fa-check"></i><b>18.1.5</b> Доработка модели</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="multiple-linear.html"><a href="multiple-linear.html#множественная-линейная-регрессия-с-количественными-и-категориальными-предикторами"><i class="fa fa-check"></i><b>18.2</b> Множественная линейная регрессия с количественными и категориальными предикторами</a><ul>
<li class="chapter" data-level="18.2.1" data-path="multiple-linear.html"><a href="multiple-linear.html#математическая-модель-1"><i class="fa fa-check"></i><b>18.2.1</b> Математическая модель</a></li>
<li class="chapter" data-level="18.2.2" data-path="multiple-linear.html"><a href="multiple-linear.html#подбор-модели-1"><i class="fa fa-check"></i><b>18.2.2</b> Подбор модели</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="multiple-linear.html"><a href="multiple-linear.html#модели-со-взаимодействием-предикторов"><i class="fa fa-check"></i><b>18.3</b> Модели со взаимодействием предикторов</a><ul>
<li class="chapter" data-level="18.3.1" data-path="multiple-linear.html"><a href="multiple-linear.html#математическая-модель-2"><i class="fa fa-check"></i><b>18.3.1</b> Математическая модель</a></li>
<li class="chapter" data-level="18.3.2" data-path="multiple-linear.html"><a href="multiple-linear.html#подбор-модели-2"><i class="fa fa-check"></i><b>18.3.2</b> Подбор модели</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="multiple-linear.html"><a href="multiple-linear.html#сравнение-моделей"><i class="fa fa-check"></i><b>18.4</b> Сравнение моделей</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="anova.html"><a href="anova.html"><i class="fa fa-check"></i><b>19</b> Дисперсионный анализ</a><ul>
<li class="chapter" data-level="19.1" data-path="anova.html"><a href="anova.html#параметризация-индикаторов-и-параметризация-эффектов"><i class="fa fa-check"></i><b>19.1</b> Параметризация индикаторов и параметризация эффектов</a></li>
<li class="chapter" data-level="19.2" data-path="anova.html"><a href="anova.html#однофакторный-дисперсионный-анализ"><i class="fa fa-check"></i><b>19.2</b> Однофакторный дисперсионный анализ</a><ul>
<li class="chapter" data-level="19.2.1" data-path="anova.html"><a href="anova.html#зачем-вообще-дисперсионный-анализ"><i class="fa fa-check"></i><b>19.2.1</b> Зачем вообще дисперсионный анализ?</a></li>
<li class="chapter" data-level="19.2.2" data-path="anova.html"><a href="anova.html#структура-изменчивости"><i class="fa fa-check"></i><b>19.2.2</b> Структура изменчивости</a></li>
<li class="chapter" data-level="19.2.3" data-path="anova.html"><a href="anova.html#тестирование-значимости-фактора"><i class="fa fa-check"></i><b>19.2.3</b> Тестирование значимости фактора</a></li>
<li class="chapter" data-level="19.2.4" data-path="anova.html"><a href="anova.html#дисперсионный-анализ-в-r"><i class="fa fa-check"></i><b>19.2.4</b> Дисперсионный анализ в R</a></li>
<li class="chapter" data-level="19.2.5" data-path="anova.html"><a href="anova.html#post-hoc-тесты"><i class="fa fa-check"></i><b>19.2.5</b> Post hoc тесты</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="anova.html"><a href="anova.html#многофакторный-дисперсионный-анализ"><i class="fa fa-check"></i><b>19.3</b> Многофакторный дисперсионный анализ</a><ul>
<li class="chapter" data-level="19.3.1" data-path="anova.html"><a href="anova.html#типы-сумм-квадратов"><i class="fa fa-check"></i><b>19.3.1</b> Типы сумм квадратов</a></li>
<li class="chapter" data-level="19.3.2" data-path="anova.html"><a href="anova.html#post-hoc-тесты-1"><i class="fa fa-check"></i><b>19.3.2</b> Post hoc тесты</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="anova.html"><a href="anova.html#дисперсионный-анализ-с-повторными-измерениями"><i class="fa fa-check"></i><b>19.4</b> Дисперсионный анализ с повторными измерениями</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="ancova.html"><a href="ancova.html"><i class="fa fa-check"></i><b>20</b> Ковариационный анализ</a><ul>
<li class="chapter" data-level="20.1" data-path="ancova.html"><a href="ancova.html#модель-ковариационного-анализа"><i class="fa fa-check"></i><b>20.1</b> Модель ковариационного анализа</a></li>
<li class="chapter" data-level="20.2" data-path="ancova.html"><a href="ancova.html#влияние-ковариаты"><i class="fa fa-check"></i><b>20.2</b> Влияние ковариаты</a></li>
<li class="chapter" data-level="20.3" data-path="ancova.html"><a href="ancova.html#более-сложные-модели"><i class="fa fa-check"></i><b>20.3</b> Более сложные модели</a></li>
<li class="chapter" data-level="20.4" data-path="ancova.html"><a href="ancova.html#тестирование-значимости-предикторов-и-диагностика-модели"><i class="fa fa-check"></i><b>20.4</b> Тестирование значимости предикторов и диагностика модели</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="logistic.html"><a href="logistic.html"><i class="fa fa-check"></i><b>21</b> Обобщенные линейные модели. Логистическая регрессия</a><ul>
<li class="chapter" data-level="21.1" data-path="logistic.html"><a href="logistic.html#ограничения-общих-линейных-моделей"><i class="fa fa-check"></i><b>21.1</b> Ограничения общих линейных моделей</a></li>
<li class="chapter" data-level="21.2" data-path="logistic.html"><a href="logistic.html#биномиальное-распределение"><i class="fa fa-check"></i><b>21.2</b> Биномиальное распределение</a></li>
<li class="chapter" data-level="21.3" data-path="logistic.html"><a href="logistic.html#бинарные-переменные"><i class="fa fa-check"></i><b>21.3</b> Бинарные переменные</a></li>
<li class="chapter" data-level="21.4" data-path="logistic.html"><a href="logistic.html#hr-данные"><i class="fa fa-check"></i><b>21.4</b> HR-данные</a></li>
<li class="chapter" data-level="21.5" data-path="logistic.html"><a href="logistic.html#задача-построения-линейной-модели"><i class="fa fa-check"></i><b>21.5</b> Задача построения линейной модели</a></li>
<li class="chapter" data-level="21.6" data-path="logistic.html"><a href="logistic.html#переход-от-дискретной-величины-к-непрерывной"><i class="fa fa-check"></i><b>21.6</b> Переход от дискретной величины к непрерывной</a><ul>
<li class="chapter" data-level="21.6.1" data-path="logistic.html"><a href="logistic.html#логистическая-кривая"><i class="fa fa-check"></i><b>21.6.1</b> Логистическая кривая</a></li>
<li class="chapter" data-level="21.6.2" data-path="logistic.html"><a href="logistic.html#шансы-и-логиты"><i class="fa fa-check"></i><b>21.6.2</b> Шансы и логиты</a></li>
</ul></li>
<li class="chapter" data-level="21.7" data-path="logistic.html"><a href="logistic.html#формулирование-модели-в-математическом-виде"><i class="fa fa-check"></i><b>21.7</b> Формулирование модели в математическом виде</a></li>
<li class="chapter" data-level="21.8" data-path="logistic.html"><a href="logistic.html#подбор-линейной-модели"><i class="fa fa-check"></i><b>21.8</b> Подбор линейной модели</a><ul>
<li class="chapter" data-level="21.8.1" data-path="logistic.html"><a href="logistic.html#метод-максимального-правдоподобия"><i class="fa fa-check"></i><b>21.8.1</b> Метод максимального правдоподобия</a></li>
</ul></li>
<li class="chapter" data-level="21.9" data-path="logistic.html"><a href="logistic.html#анализ-модели"><i class="fa fa-check"></i><b>21.9</b> Анализ модели</a></li>
<li class="chapter" data-level="21.10" data-path="logistic.html"><a href="logistic.html#анализ-девиансы-и-упрощение-модели"><i class="fa fa-check"></i><b>21.10</b> Анализ девиансы и упрощение модели</a></li>
<li class="chapter" data-level="21.11" data-path="logistic.html"><a href="logistic.html#интерпретация-коэффициентов-модели"><i class="fa fa-check"></i><b>21.11</b> Интерпретация коэффициентов модели</a><ul>
<li class="chapter" data-level="21.11.1" data-path="logistic.html"><a href="logistic.html#немного-алгебры-для-понимания-сути-коэффициентов"><i class="fa fa-check"></i><b>21.11.1</b> Немного алгебры для понимания сути коэффициентов</a></li>
</ul></li>
<li class="chapter" data-level="21.12" data-path="logistic.html"><a href="logistic.html#предсказательная-сила-модели"><i class="fa fa-check"></i><b>21.12</b> Предсказательная сила модели</a><ul>
<li class="chapter" data-level="21.12.1" data-path="logistic.html"><a href="logistic.html#перевод-непрерывных-предсказаний-в-дискретные"><i class="fa fa-check"></i><b>21.12.1</b> Перевод непрерывных предсказаний в дискретные</a></li>
<li class="chapter" data-level="21.12.2" data-path="logistic.html"><a href="logistic.html#confusion-matrix"><i class="fa fa-check"></i><b>21.12.2</b> Confusion matrix</a></li>
<li class="chapter" data-level="21.12.3" data-path="logistic.html"><a href="logistic.html#accuracy"><i class="fa fa-check"></i><b>21.12.3</b> Accuracy</a></li>
<li class="chapter" data-level="21.12.4" data-path="logistic.html"><a href="logistic.html#precision-and-recall"><i class="fa fa-check"></i><b>21.12.4</b> Precision and Recall</a></li>
<li class="chapter" data-level="21.12.5" data-path="logistic.html"><a href="logistic.html#f1-мера"><i class="fa fa-check"></i><b>21.12.5</b> F1-мера</a></li>
<li class="chapter" data-level="21.12.6" data-path="logistic.html"><a href="logistic.html#roc-auc"><i class="fa fa-check"></i><b>21.12.6</b> ROC-AUC</a></li>
</ul></li>
<li class="chapter" data-level="21.13" data-path="logistic.html"><a href="logistic.html#предсказания-на-новых-данных"><i class="fa fa-check"></i><b>21.13</b> Предсказания на новых данных</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="poisson.html"><a href="poisson.html"><i class="fa fa-check"></i><b>22</b> Пуассоновская регрессия</a><ul>
<li class="chapter" data-level="22.1" data-path="poisson.html"><a href="poisson.html#распределение-пуассона"><i class="fa fa-check"></i><b>22.1</b> Распределение Пуассона</a></li>
<li class="chapter" data-level="22.2" data-path="poisson.html"><a href="poisson.html#почему-обычные-регрессионные-модели-плохо-работают-на-счётных-данных"><i class="fa fa-check"></i><b>22.2</b> Почему обычные регрессионные модели плохо работают на счётных данных</a></li>
<li class="chapter" data-level="22.3" data-path="poisson.html"><a href="poisson.html#данные-1"><i class="fa fa-check"></i><b>22.3</b> Данные</a></li>
<li class="chapter" data-level="22.4" data-path="poisson.html"><a href="poisson.html#glm-с-пуассоновским-распределением-целевой-переменной"><i class="fa fa-check"></i><b>22.4</b> GLM с пуассоновским распределением целевой переменной</a><ul>
<li class="chapter" data-level="22.4.1" data-path="poisson.html"><a href="poisson.html#подбор-модели-в-r"><i class="fa fa-check"></i><b>22.4.1</b> Подбор модели в R</a></li>
</ul></li>
<li class="chapter" data-level="22.5" data-path="poisson.html"><a href="poisson.html#интерпретация-коэффициентов-модели-1"><i class="fa fa-check"></i><b>22.5</b> Интерпретация коэффициентов модели</a></li>
<li class="chapter" data-level="22.6" data-path="poisson.html"><a href="poisson.html#анализ-девиансы"><i class="fa fa-check"></i><b>22.6</b> Анализ девиансы</a></li>
<li class="chapter" data-level="22.7" data-path="poisson.html"><a href="poisson.html#проверка-на-сверхдисперсию-overdispersion"><i class="fa fa-check"></i><b>22.7</b> Проверка на сверхдисперсию (overdispersion)</a></li>
<li class="chapter" data-level="22.8" data-path="poisson.html"><a href="poisson.html#квазипуассоновские-модели"><i class="fa fa-check"></i><b>22.8</b> Квазипуассоновские модели</a><ul>
<li class="chapter" data-level="22.8.1" data-path="poisson.html"><a href="poisson.html#квазипуассоновские-модели-в-r"><i class="fa fa-check"></i><b>22.8.1</b> Квазипуассоновские модели в R</a></li>
</ul></li>
<li class="chapter" data-level="22.9" data-path="poisson.html"><a href="poisson.html#особенности-работы-с-квазипуассоновскими-моделями"><i class="fa fa-check"></i><b>22.9</b> Особенности работы с квазипуассоновскими моделями</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="regularization.html"><a href="regularization.html"><i class="fa fa-check"></i><b>23</b> Регуляризация регрессии</a><ul>
<li class="chapter" data-level="23.1" data-path="regularization.html"><a href="regularization.html#варианты-штрафа"><i class="fa fa-check"></i><b>23.1</b> Варианты штрафа</a><ul>
<li class="chapter" data-level="23.1.1" data-path="regularization.html"><a href="regularization.html#пример-работы-штрафного-коэффициента"><i class="fa fa-check"></i><b>23.1.1</b> Пример работы штрафного коэффициента</a></li>
</ul></li>
<li class="chapter" data-level="23.2" data-path="regularization.html"><a href="regularization.html#регуляризованная-регрессия-в-r"><i class="fa fa-check"></i><b>23.2</b> Регуляризованная регрессия в R</a><ul>
<li class="chapter" data-level="23.2.1" data-path="regularization.html"><a href="regularization.html#данные-2"><i class="fa fa-check"></i><b>23.2.1</b> Данные</a></li>
<li class="chapter" data-level="23.2.2" data-path="regularization.html"><a href="regularization.html#особенности-синтаксиса-пакета-glmnet"><i class="fa fa-check"></i><b>23.2.2</b> Особенности синтаксиса пакета <code>glmnet</code></a></li>
<li class="chapter" data-level="23.2.3" data-path="regularization.html"><a href="regularization.html#ridge-регрессия-в-r"><i class="fa fa-check"></i><b>23.2.3</b> Ridge-регрессия в R</a></li>
<li class="chapter" data-level="23.2.4" data-path="regularization.html"><a href="regularization.html#lasso-регрессия-в-r"><i class="fa fa-check"></i><b>23.2.4</b> LASSO-регрессия в R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="24" data-path="glmm.html"><a href="glmm.html"><i class="fa fa-check"></i><b>24</b> Смешанные линейные модели</a><ul>
<li class="chapter" data-level="24.1" data-path="glmm.html"><a href="glmm.html#ограничения-изученных-ранее-линейных-моделей"><i class="fa fa-check"></i><b>24.1</b> Ограничения изученных ранее линейных моделей</a></li>
<li class="chapter" data-level="24.2" data-path="glmm.html"><a href="glmm.html#случайные-vs-фиксированные-факторы"><i class="fa fa-check"></i><b>24.2</b> Случайные vs фиксированные факторы</a></li>
<li class="chapter" data-level="24.3" data-path="glmm.html"><a href="glmm.html#почему-обычные-методы-плохо-работают"><i class="fa fa-check"></i><b>24.3</b> Почему обычные методы плохо работают?</a><ul>
<li class="chapter" data-level="24.3.1" data-path="glmm.html"><a href="glmm.html#плохое-решение-игнорирование-группирующего-фактора"><i class="fa fa-check"></i><b>24.3.1</b> Плохое решение: игнорирование группирующего фактора</a></li>
<li class="chapter" data-level="24.3.2" data-path="glmm.html"><a href="glmm.html#плохое-решение-включение-группирующего-фактора-как-фиксированного"><i class="fa fa-check"></i><b>24.3.2</b> Плохое решение: включение группирующего фактора как фиксированного</a></li>
</ul></li>
<li class="chapter" data-level="24.4" data-path="glmm.html"><a href="glmm.html#виды-glmm-и-их-математическая-формулировка"><i class="fa fa-check"></i><b>24.4</b> Виды GLMM и их математическая формулировка</a><ul>
<li class="chapter" data-level="24.4.1" data-path="glmm.html"><a href="glmm.html#математическая-формулировка-модели-со-случайным-интерсептом"><i class="fa fa-check"></i><b>24.4.1</b> Математическая формулировка модели со случайным интерсептом</a></li>
<li class="chapter" data-level="24.4.2" data-path="glmm.html"><a href="glmm.html#математическая-формулировка-модели-со-случайными-интерсептом-и-углом-наклона"><i class="fa fa-check"></i><b>24.4.2</b> Математическая формулировка модели со случайными интерсептом и углом наклона</a></li>
</ul></li>
<li class="chapter" data-level="24.5" data-path="glmm.html"><a href="glmm.html#подбор-моделей-со-смешанными-эффектами"><i class="fa fa-check"></i><b>24.5</b> Подбор моделей со смешанными эффектами</a></li>
<li class="chapter" data-level="24.6" data-path="glmm.html"><a href="glmm.html#методы-подбора-параметров-в-смешанных-моделях"><i class="fa fa-check"></i><b>24.6</b> Методы подбора параметров в смешанных моделях</a><ul>
<li class="chapter" data-level="24.6.1" data-path="glmm.html"><a href="glmm.html#reml-или-ml"><i class="fa fa-check"></i><b>24.6.1</b> REML или ML?</a></li>
</ul></li>
<li class="chapter" data-level="24.7" data-path="glmm.html"><a href="glmm.html#диагностика-модели-2"><i class="fa fa-check"></i><b>24.7</b> Диагностика модели</a><ul>
<li class="chapter" data-level="24.7.1" data-path="glmm.html"><a href="glmm.html#индуцированные-корреляции"><i class="fa fa-check"></i><b>24.7.1</b> Индуцированные корреляции</a></li>
<li class="chapter" data-level="24.7.2" data-path="glmm.html"><a href="glmm.html#анализ-остатков-модели"><i class="fa fa-check"></i><b>24.7.2</b> Анализ остатков модели</a></li>
</ul></li>
<li class="chapter" data-level="24.8" data-path="glmm.html"><a href="glmm.html#предсказания-с-помощью-моделей.-сравнение-точности-предсказаний-смешанных-и-обычных-моделей"><i class="fa fa-check"></i><b>24.8</b> Предсказания с помощью моделей. Сравнение точности предсказаний смешанных и обычных моделей</a></li>
<li class="chapter" data-level="24.9" data-path="glmm.html"><a href="glmm.html#тестирование-гипотез"><i class="fa fa-check"></i><b>24.9</b> Тестирование гипотез</a><ul>
<li class="chapter" data-level="24.9.1" data-path="glmm.html"><a href="glmm.html#t-тест-вальда"><i class="fa fa-check"></i><b>24.9.1</b> t-тест Вальда</a></li>
<li class="chapter" data-level="24.9.2" data-path="glmm.html"><a href="glmm.html#тест-отношения-правдоподобий-likelihood-ratio-test-lrt"><i class="fa fa-check"></i><b>24.9.2</b> Тест отношения правдоподобий (likelihood ratio test, LRT)</a></li>
<li class="chapter" data-level="24.9.3" data-path="glmm.html"><a href="glmm.html#lrt-для-случайных-эффектов"><i class="fa fa-check"></i><b>24.9.3</b> LRT для случайных эффектов</a></li>
<li class="chapter" data-level="24.9.4" data-path="glmm.html"><a href="glmm.html#lrt-для-фиксированных-эффектов"><i class="fa fa-check"></i><b>24.9.4</b> LRT для фиксированных эффектов</a></li>
</ul></li>
<li class="chapter" data-level="24.10" data-path="glmm.html"><a href="glmm.html#сравнение-моделей-с-помощью-aic"><i class="fa fa-check"></i><b>24.10</b> Сравнение моделей с помощью AIC</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="cluster.html"><a href="cluster.html"><i class="fa fa-check"></i><b>25</b> Кластерный анализ</a><ul>
<li class="chapter" data-level="25.1" data-path="cluster.html"><a href="cluster.html#кластерный-анализ"><i class="fa fa-check"></i><b>25.1</b> Кластерный анализ</a></li>
<li class="chapter" data-level="25.2" data-path="cluster.html"><a href="cluster.html#геометрическая-интерпретация-задачи-кластеризации"><i class="fa fa-check"></i><b>25.2</b> Геометрическая интерпретация задачи кластеризации</a><ul>
<li class="chapter" data-level="25.2.1" data-path="cluster.html"><a href="cluster.html#проблема-кластеризации"><i class="fa fa-check"></i><b>25.2.1</b> Проблема кластеризации</a></li>
<li class="chapter" data-level="25.2.2" data-path="cluster.html"><a href="cluster.html#расстояние-между-объектами"><i class="fa fa-check"></i><b>25.2.2</b> Расстояние между объектами</a></li>
<li class="chapter" data-level="25.2.3" data-path="cluster.html"><a href="cluster.html#проблема-операционализации-расстояния"><i class="fa fa-check"></i><b>25.2.3</b> Проблема операционализации расстояния</a></li>
<li class="chapter" data-level="25.2.4" data-path="cluster.html"><a href="cluster.html#субъективность-кластерного-анализа"><i class="fa fa-check"></i><b>25.2.4</b> Субъективность кластерного анализа</a></li>
</ul></li>
<li class="chapter" data-level="25.3" data-path="cluster.html"><a href="cluster.html#расстояние-между-кластерами"><i class="fa fa-check"></i><b>25.3</b> Расстояние между кластерами</a><ul>
<li class="chapter" data-level="25.3.1" data-path="cluster.html"><a href="cluster.html#среднее-невзвешенное-расстояние"><i class="fa fa-check"></i><b>25.3.1</b> Среднее невзвешенное расстояние</a></li>
<li class="chapter" data-level="25.3.2" data-path="cluster.html"><a href="cluster.html#центроидный-метод"><i class="fa fa-check"></i><b>25.3.2</b> Центроидный метод</a></li>
<li class="chapter" data-level="25.3.3" data-path="cluster.html"><a href="cluster.html#метод-дальнего-соседа"><i class="fa fa-check"></i><b>25.3.3</b> Метод дальнего соседа</a></li>
<li class="chapter" data-level="25.3.4" data-path="cluster.html"><a href="cluster.html#метод-ближайшего-соседа"><i class="fa fa-check"></i><b>25.3.4</b> Метод ближайшего соседа</a></li>
<li class="chapter" data-level="25.3.5" data-path="cluster.html"><a href="cluster.html#расстояние-sørensendice"><i class="fa fa-check"></i><b>25.3.5</b> Расстояние Sørensen—Dice</a></li>
</ul></li>
<li class="chapter" data-level="25.4" data-path="cluster.html"><a href="cluster.html#иерархическая-кластеризация"><i class="fa fa-check"></i><b>25.4</b> Иерархическая кластеризация</a><ul>
<li class="chapter" data-level="25.4.1" data-path="cluster.html"><a href="cluster.html#алгоритм-иерархического-кластерного-анализа"><i class="fa fa-check"></i><b>25.4.1</b> Алгоритм иерархического кластерного анализа</a></li>
<li class="chapter" data-level="25.4.2" data-path="cluster.html"><a href="cluster.html#дендрограмма"><i class="fa fa-check"></i><b>25.4.2</b> Дендрограмма</a></li>
<li class="chapter" data-level="25.4.3" data-path="cluster.html"><a href="cluster.html#каменистая-осыпь"><i class="fa fa-check"></i><b>25.4.3</b> Каменистая осыпь</a></li>
<li class="chapter" data-level="25.4.4" data-path="cluster.html"><a href="cluster.html#когда-кластеризации-нет"><i class="fa fa-check"></i><b>25.4.4</b> Когда кластеризации нет?</a></li>
<li class="chapter" data-level="25.4.5" data-path="cluster.html"><a href="cluster.html#иерархическая-кластеризация-в-r"><i class="fa fa-check"></i><b>25.4.5</b> Иерархическая кластеризация в R</a></li>
<li class="chapter" data-level="25.4.6" data-path="cluster.html"><a href="cluster.html#чем-плох-иерархический-кластерный-анализ"><i class="fa fa-check"></i><b>25.4.6</b> Чем плох иерархический кластерный анализ?</a></li>
</ul></li>
<li class="chapter" data-level="25.5" data-path="cluster.html"><a href="cluster.html#k-means-метод-k-средних"><i class="fa fa-check"></i><b>25.5</b> k-means (метод k-средних)</a><ul>
<li class="chapter" data-level="25.5.1" data-path="cluster.html"><a href="cluster.html#алгоритм-метода-k-средних"><i class="fa fa-check"></i><b>25.5.1</b> Алгоритм метода k-средних</a></li>
<li class="chapter" data-level="25.5.2" data-path="cluster.html"><a href="cluster.html#ограничения-k-means"><i class="fa fa-check"></i><b>25.5.2</b> Ограничения k-means</a></li>
<li class="chapter" data-level="25.5.3" data-path="cluster.html"><a href="cluster.html#начальное-положение-кластеров"><i class="fa fa-check"></i><b>25.5.3</b> Начальное положение кластеров</a></li>
<li class="chapter" data-level="25.5.4" data-path="cluster.html"><a href="cluster.html#k-means-в-r"><i class="fa fa-check"></i><b>25.5.4</b> k-means в R</a></li>
</ul></li>
<li class="chapter" data-level="25.6" data-path="cluster.html"><a href="cluster.html#метрики-качества-кластеризации"><i class="fa fa-check"></i><b>25.6</b> Метрики качества кластеризации</a><ul>
<li class="chapter" data-level="25.6.1" data-path="cluster.html"><a href="cluster.html#внешние-метрики"><i class="fa fa-check"></i><b>25.6.1</b> Внешние метрики</a></li>
<li class="chapter" data-level="25.6.2" data-path="cluster.html"><a href="cluster.html#внутренние-метрики"><i class="fa fa-check"></i><b>25.6.2</b> Внутренние метрики</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="26" data-path="pca.html"><a href="pca.html"><i class="fa fa-check"></i><b>26</b> Анализ главных компонент</a></li>
<li class="chapter" data-level="27" data-path="efa.html"><a href="efa.html"><i class="fa fa-check"></i><b>27</b> Эксплораторный факторный анализ</a></li>
<li class="chapter" data-level="28" data-path="cfa.html"><a href="cfa.html"><i class="fa fa-check"></i><b>28</b> Конфирматорный факторный анализ</a></li>
<li class="chapter" data-level="29" data-path="further.html"><a href="further.html"><i class="fa fa-check"></i><b>29</b> Что дальше?</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>Литература</a><ul>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#касаемо-математики"><i class="fa fa-check"></i>Касаемо математики</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#относительно-статистики"><i class="fa fa-check"></i>Относительно статистики</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#about-r"><i class="fa fa-check"></i>About R</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html#во-славу-андана"><i class="fa fa-check"></i>Во славу андана</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">HSE UX LAB | Анализ данных + R: мир линейных моделей | Book</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="cluster" class="section level1">
<h1><span class="header-section-number">25</span> Кластерный анализ</h1>
<p>К этому моменту мы с вами уже научились решать много разных аналитических задач, которые глобально можно объединить в две группы:</p>
<ul>
<li><em>задачи регрессии</em> — когда нам необходимо выяснить влияние определенных факторов на количественную переменную, а также предсказать её значение (простая и множественная линейная регрессия, регуляризованная регрессия, пуассоновкая регрессия, дисперсионный анализ).</li>
<li><em>задачи классификации</em> — когда нам необходимо определить, к какому классу относиться объект на основе признаков, которыми он обладает (биномиальная регрессия).</li>
</ul>
<p>Но нам часто бывает нужно определить, какие наблюдения наиболее похожи друг на друга, то есть разбить их на группы, при условии что нам неизвестно, какие это будут группы. Эта задача носит название <em>кластеризации</em>. Ей мы и посвятим эту главу.</p>
<div id="кластерный-анализ" class="section level2">
<h2><span class="header-section-number">25.1</span> Кластерный анализ</h2>
<p><em>Задача кластерного анализа</em> — разбиение набора объектов на группы, при этом попутно определяется число этих групп. Группы, на которые разбивается выборка, называются <em>кластеры</em>.</p>
</div>
<div id="геометрическая-интерпретация-задачи-кластеризации" class="section level2">
<h2><span class="header-section-number">25.2</span> Геометрическая интерпретация задачи кластеризации</h2>
<p>Напомним себе, что</p>
<ol style="list-style-type: decimal">
<li>компьютер умеет работать только с <em>числами</em></li>
<li>упорядоченое множество объектов одного типа есть <em>вектор</em></li>
<li>каждый вектор мы [когда-то давно] договаривались начинать из начала координат, а значит, может описать его только <em>координатами конца</em></li>
</ol>
<p>Теперь посмотрим на данные. Как мы знаем, столбцы — это переменные, или характеристики объектов. Строки — это сами объекты. Любой объект мы можем описать числовым вектором, где числа задают значение характеристик объектов. Если это количественные характеристики, то тут всё понятно — это воистину числа. А если характеристики качественные? Никаких проблем — мы их перекодируем в числа! Если это бинарные переменные (например, пол или ступень обучения «бакалавр»/«магистр»), то одну категорию обозначим <code>0</code>, другую — <code>1</code>. Если категорий больше, то у нас просто будет больше чисел-индикаторов. Итого, <em>каждое наблюдение описывается числовым вектором</em>, а следовательно, и <em>некоторой точкой в пространстве</em>.</p>
<p>Каково это пространство? Оси — это переменные, то есть характеристики объектов. Измерений в этом <em>признаковом пространстве</em> столько, сколько переменных в нашем датасете.</p>
<p>Наша задача — объединить похожие наблюдения в группы. А какие наблюдения являются похожими? Логично допустить, что те, которые обдалают схожими характеристиками. Если характеристики объектов схожи, то в признаковом пространстве они будут располагаться <em>близко</em> друг к другу.</p>
<p>Итого, summary геометрической задачи:</p>
<ul>
<li>каждый из <span class="math inline">\(n\)</span> рассматриваемых объектов — это точка в некотором <span class="math inline">\(p\)</span>-мерной признаковом пространстве;</li>
<li>похожие объекты будут располагаться «близко» друг с другу;</li>
<li>различающиеся объекты будут располагаться «далеко» друг от друга;</li>
<li>скопления точек — это искомые кластеры.</li>
</ul>
<div id="проблема-кластеризации" class="section level3">
<h3><span class="header-section-number">25.2.1</span> Проблема кластеризации</h3>
<p>Посмотрим на простейший вариант — двухмерное признаковое пространство. Пусть у нас есть некоторые два признака, которые будут задавать два соответствующих измерения, и некоторое количество точек, которые располагаются примерно так:</p>
<center>
<img src="img/clusters_1.jpeg">
</center>
<p>Сколько здесь кластеров? Кто-то скажет, что их три:</p>
<center>
<img src="img/clusters_2.jpeg">
</center>
<p>Кто-то скажет, что их четыре:</p>
<center>
<img src="img/clusters_3.jpeg">
</center>
<p>Кто-то скажет, что их всё же три, но выглядят они по-другому:</p>
<center>
<img src="img/clusters_4.jpeg">
</center>
<p>Что мы здесь наблюдаем? Проблему. <strong>Разные методы кластеризации могут давать разные результаты.</strong> Какой из них верный? Неясно… так как истинная группировка данных нам неизвестна. Но мы будем пытаться как-то выживать в ситуаций такой неопределённости.</p>
</div>
<div id="расстояние-между-объектами" class="section level3">
<h3><span class="header-section-number">25.2.2</span> Расстояние между объектами</h3>
<p>Обратим внимание на следующий важный момент. Мы оперируем терминами «близко» и «далеко» — но как мы определаем расстояние между объектами? Рассмотрим самые популярные и важные для нас варианты.</p>
<div id="евклидово-расстояние" class="section level4">
<h4><span class="header-section-number">25.2.2.1</span> Евклидово расстояние</h4>
<p>С одним из них мы знакомы ещё со школы — это <strong>евклидово расстояние между точками</strong>. По смыслу это длина отрезка, соединяющего две точки. Оно определяется как корень из суммы квадратов покоординатных разностей. Пусть у нас есть две точки — <span class="math inline">\((x_1, x_2, \dots, x_p)\)</span> и <span class="math inline">\((y_1, y_2, \dots, y_p)\)</span>. Евклидово расстояние будет определяться по формуле:</p>
<p><span class="math display">\[
d_{\text{Eucl}, XY} = \sqrt{\sum_{j=1}^p (x_j - y_j)^2}
\]</span></p>
<p>Иногда также используется <strong>квадрат евклидова расстояния</strong><a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>.</p>
</div>
<div id="манхэттеновское-расстояние" class="section level4">
<h4><span class="header-section-number">25.2.2.2</span> Манхэттеновское расстояние</h4>
<p>Оно же <strong>блок-расстояние</strong> или <strong>расстояние таксиста</strong>. Представим славный российский город Санкт-Петербург, где, как известно, улицы организованы вот так:</p>
<center>
<img src="img/manh_1.jpeg">
</center>
<p>Какое расстояние проедет таксист из точки <span class="math inline">\(A\)</span> в точки <span class="math inline">\(B\)</span>?</p>
<center>
<img src="img/manh_2.jpeg">
</center>
<p>Правильно, вот такое<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>:</p>
<center>
<img src="img/manh_3.jpeg">
</center>
<p>Схожая логика может быть использована и при расчёте расстояния между точками<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>:</p>
<center>
<img src="img/manh_4.jpeg">
</center>
<p>Математически это будет определено так:</p>
<p><span class="math display">\[
d_{\text{Manh}, XY} = \sum_{j=1}^p |x_j - y_j|
\]</span></p>
</div>
<div id="евклид-vs-манхэттен" class="section level4">
<h4><span class="header-section-number">25.2.2.3</span> Евклид vs Манхэттен</h4>
<p>Когда какое расстояние выбирать? Здесь два важных момента.</p>
<p>Первый — <em>математический</em>. Как и в случае с дисперсией, мы возводим покоординатные разности в квадрат. Если переменные измерены в различных единицах, то вклад одной из них в суммарное расстояние может быть значительно выше, чем других. По этой причине необходимо принять решение: <strong>является ли большая разница значений по одной из переменных достаточным основанием для отнесения наблюдений к различным кластерам?</strong> Если да, то можно использовать такое расстояние, если нет, то либо необходима стандартизация переменных, либо использование расстояния Манхэттен.</p>
<p>Второй — <em>измерительный</em>. Если переменные, по которым вы кластеризуете наблюдения, непрерывные, то можно использовать евклидово расстояние. Если переменные дискретные, то более логичным вариантом будет манхэттеновское расстояние.</p>
</div>
<div id="другие-виды-расстояний" class="section level4">
<h4><span class="header-section-number">25.2.2.4</span> Другие виды расстояний</h4>
<p>Отметим, что есть и другие виды расстояний, когда мы работает не с числовыми объектами. Например, мы можем пытаться кластеризовать слова — задача непростая, но её можно пытаться решить. Например, с помощью расстояний Хэмминга или Левенштейна. Для более специфичных объектов могут понадобиться и более изощрённые метрики расстояний. Да и вообще «никакое время, потраченное на раздумья, какое расстояние выбрать, не будет потрачено зря»<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a>.</p>
</div>
</div>
<div id="проблема-операционализации-расстояния" class="section level3">
<h3><span class="header-section-number">25.2.3</span> Проблема операционализации расстояния</h3>
<p>Но вообще нам надо здесь поговорить ещё вот о чём: как вообще мы определяем, что есть расстояние между объектами? То есть как мы его операционализируем?</p>
<p>Например, мы хотим кластеризовать наших испытуемых на «эффективных решателей задачи» и «неэффективных решателей задачи». По каким параметрам мы это будем делать? Как вариант — время решения и число ошибок в ходе решения. А как мы будем замерять эти переменные? Первую, видимо, в непрерывной шкале, вторую — в дискретной. Далее будем решать вопрос о выборе конкретной метрики расстояния.</p>
<p>Хорошо, а как нам кластеризовать менеджеров на «хороших», «плохих» и «средненьких продажников»? Можем использовать разные подходы: оценку 360, показатели KPI и т. д.</p>
<p>А как нам определять расстояние между сайтами? По каким показателям? Здесь вариантов ещё больше и всё зависит от конкретной аналитической задачи.</p>
<p>Это всё о чем? О том, что операционализировать расстояние не так-то просто и для разных задач расстояние между одними и теми же объектами может быть операционализировано по-разному.</p>
</div>
<div id="субъективность-кластерного-анализа" class="section level3">
<h3><span class="header-section-number">25.2.4</span> Субъективность кластерного анализа</h3>
<p>Мы плавно подъехали к ещё одной проблеме-особенности. Какова роль аналитика в кластерном анализе? Достаточно велика:</p>
<ul>
<li>отбор переменных для анализа
<ul>
<li>какие переменные включать в анализ? все? или необходимо проводить отбор?</li>
<li>возможно наличие переменных, которые будут хорошо работать с точки зрения поиска схожих объектов, но это не то сходство, которое мы ищем</li>
<li>одни переменные могут быть косвенно заменены другими (уровень дохода — профессия, образование, стаж работы)</li>
<li>«ковариаты» могут быть важны при формировании кластеров (число учащихся и учителей в школах)</li>
<li>правильный выбор переменных крайне важен</li>
<li>критерием при отборе переменных выступает ясность интерпретации полученного результата и «интуиция исследователя»</li>
</ul></li>
<li>метод стандартизации
<ul>
<li>качество кластеризации может зависит от выбранного метода стандартизации</li>
</ul></li>
<li>выбор метрики для расстояния между объектами</li>
<li>выбор метрики для расстояния между кластерами
<ul>
<li>если кластеры выражены, то метрика не важна</li>
<li>если появляются кластеры сложной формы (например, ленточные), то всё становится сложнее</li>
</ul></li>
<li>[иногда] определение числа кластеров</li>
<li>интерпретация результатов
<ul>
<li>результаты кластерного анализа нуждаются в интерпретации (если он не решает чисто техническую задачу сокращения размерности данных)</li>
<li>лучший результат кластеризации — это тот, который вы смогли понять и проинтерпретировать</li>
</ul></li>
</ul>
</div>
</div>
<div id="расстояние-между-кластерами" class="section level2">
<h2><span class="header-section-number">25.3</span> Расстояние между кластерами</h2>
<p>Хорошо, мы поговорили о том, как считать расстояние между объектами, но нам надо понять, насколько (не)похожи получившиеся группы объектов. Для этого придется считать расстояние между кластерами. Варинатов, как обычно, масса.</p>
<div id="среднее-невзвешенное-расстояние" class="section level3">
<h3><span class="header-section-number">25.3.1</span> Среднее невзвешенное расстояние</h3>
<p><strong>Среднее невзвешенное рассрояние (Average linkage clustering)</strong> определяется так:</p>
<ul>
<li>находим расстояния между всеми парами объектов двух кластеров</li>
<li>усредняем их</li>
</ul>
<center>
<img src="img/cluster_average.jpeg">
</center>
</div>
<div id="центроидный-метод" class="section level3">
<h3><span class="header-section-number">25.3.2</span> Центроидный метод</h3>
<p>Ранее был самым популярным из-за вычислительной простоты. Определяется расстояние между <em>центрами тяжести</em> двух кластеров:</p>
<center>
<img src="img/cluster_centroid.jpeg">
</center>
<p>В настоящее время используется крайне мало.</p>
</div>
<div id="метод-дальнего-соседа" class="section level3">
<h3><span class="header-section-number">25.3.3</span> Метод дальнего соседа</h3>
<p>Расстояние между кластерами определяется как расстояние между наиболее удалёнными объектами кластеров:</p>
<center>
<img src="img/cluster_furthest.jpeg">
</center>
</div>
<div id="метод-ближайшего-соседа" class="section level3">
<h3><span class="header-section-number">25.3.4</span> Метод ближайшего соседа</h3>
<p>Расстояние между кластерами определяется как расстояние между наиболее близкими объектами кластеров:</p>
<center>
<img src="img/cluster_nearest.jpeg">
</center>
<p>Хорошо работает с ленточными кластерами.</p>
</div>
<div id="расстояние-sørensendice" class="section level3">
<h3><span class="header-section-number">25.3.5</span> Расстояние Sørensen—Dice</h3>
<p>Довольно экзотичная метрика, но может быть полезна, например, при определии расстояний между сайтами:</p>
<p><span class="math display">\[
Q = \frac{2|A \cap B|}{|A| + |B|}
\]</span></p>
<p>Могут использоваться его модификации, например:</p>
<p><span class="math display">\[
Q = \frac{|A \cap B|}{|A| + |B| - |A \cap B|}
\]</span></p>
</div>
</div>
<div id="иерархическая-кластеризация" class="section level2">
<h2><span class="header-section-number">25.4</span> Иерархическая кластеризация</h2>
<div id="алгоритм-иерархического-кластерного-анализа" class="section level3">
<h3><span class="header-section-number">25.4.1</span> Алгоритм иерархического кластерного анализа</h3>
<ol style="list-style-type: decimal">
<li>Каждый объект объявляется кластером — из <span class="math inline">\(n\)</span> наблюдений получается <span class="math inline">\(n\)</span> кластеров.</li>
<li>Выбираются два ближайших кластера — они объединяются.</li>
<li>Выбираются два ближайших кластера — они объединяются [2].</li>
<li>Выбираются два ближайших кластера — они объединяются [3].</li>
<li>Так происходит до тех пор, пока не остается два кластера.</li>
<li>Оставшиеся два кластера являются ближайшими друг с другу — поэтому объединяются в один.</li>
</ol>
<p>Звучит, как какой-то сюр — начали с <span class="math inline">\(n\)</span> кластеров по одному объекту, закончили один кластером, содержащим все объекты… Да, в таком исполнении, действительно, странная процедура. Однако если мы на каком-то этапе её прервём, то получим желаемый результат.</p>
<p>На каком этапе стоит остановиться? Когда расстояния между объединяемыми кластерами становится большим, так как большое расстояние говорит о том, что мы объединяем непохожие объекты.</p>
</div>
<div id="дендрограмма" class="section level3">
<h3><span class="header-section-number">25.4.2</span> Дендрограмма</h3>
<p>В иерархическом кластерном анализе есть удобный инструмент для определения момента, когда стоит остановиться в объединении кластеров. Он называется <em>дендрограмма</em>. По своей сути, это визуализация алгоритма иерархического кластерного анализа.</p>
<p>Принцип построения дендрограммы следующий:</p>
<ol style="list-style-type: decimal">
<li>На прямой располагаются все наблюдения как отдельные кластеры.</li>
<li>Каждому кластеру соответствует вертикальная линия.</li>
<li>Каждому объединению кластеров соответствует горизонтальная линия.</li>
<li>Высота, на которой кластеры соединяются, отражает расстояние между кластерами.</li>
</ol>
<p>Разберемся с этим на примере.</p>
<center>
<img src="img/hc_1.jpeg">
</center>
<p>У нас есть пять наблюдений. Первоначально мы объявляем все их кластерами — получаем пять кластеров. Договоримся, что расстояние между наблюдениями у нас манхэттеновское, а расстояние между кластерами — среднее невзвешенное, ибо так проще считать. <em>[Итерация 1]</em> Далее ищем два ближайших — это кластеры 1 и 2. Объединяем их. Оображаем это на дендрограмме — соединяем линии 1 и 2 между собой на высоте 1, так как расстояние между объединяемым кластерами равно единице. Теперь у нас четыре кластера. <em>[Итерация 2]</em> Снова ищем два ближайших кластера — это 4 и 5. Объединяем их на высоте 2, так как расстояние между ними равно двум. Остаётся три кластера. <em>[Итерация 3]</em> Снова ищем два ближайщих кластера — на этот раз это 3 и 4-5. Объединяем их на высоте 3, так как расстояние между ними равно трём. <em>[Итерация 4]</em> Остаётся только два кластера — соединяем их на каком-то большом расстоянии.</p>
<center>
<img src="img/hc_2.jpeg">
</center>
<p>При анализе дендрограммя мы ищем <em>скачок расстояний</em>. Он обозначает момент, когда мы перешли к объединению непохожих (далёких друг от друга кластеров). Собственно, это и есть тот момент, когда необхожимо было прервать алгоритм и оставить те кластеры, которые образовались на текущий момент.</p>
</div>
<div id="каменистая-осыпь" class="section level3">
<h3><span class="header-section-number">25.4.3</span> Каменистая осыпь</h3>
<p>Ещё один способ определить число кластеров — это график «каменистая осыпь».</p>
<center>
<img src="img/hc_3.jpeg">
</center>
<p>В данном случае по оси <span class="math inline">\(x\)</span> располагаются шаги объединения, по оси <span class="math inline">\(y\)</span> — расстояние между кластерами в момент объединения. Как именно нам помогает такой график?</p>
<p>Мы видим, что сначала расстояние между объединяемыми кластерами растёт медленно, а затем происходит <em>излом</em> линнии, и после него расстояние начинает расти быстро. Это является указанием, что на шаге, где происходит излом линии, необходимо прервать процедуру объединения.</p>
</div>
<div id="когда-кластеризации-нет" class="section level3">
<h3><span class="header-section-number">25.4.4</span> Когда кластеризации нет?</h3>
<p>Как вы понимаете, паттерны дендрограммы и каменистой осыпи могут быть крайне разнообразны в зависимости от того, что есть в данных. Однако главный момент, который нам говорит о том, что кластеризаци нет — это отсутствие скачка расстояний на дендрограмме и/или отсутствие излома линии на графике «каменистая осыпь».</p>
</div>
<div id="иерархическая-кластеризация-в-r" class="section level3">
<h3><span class="header-section-number">25.4.5</span> Иерархическая кластеризация в R</h3>
<div id="данные-3" class="section level4">
<h4><span class="header-section-number">25.4.5.1</span> Данные</h4>
<p>Попробуем кластеризовать <a href="https://github.com/angelgardt/hseuxlab-wlm2021/blob/master/book/wlm2021-book/data/cpi.xlsx?raw=true">менеджеров-продажников</a> на основе их характеристик. В данных есть несколько шкал (количественных) — <code>Fx</code>, <code>Cs</code>, <code>Sy</code>, <code>Sp</code>, <code>In</code>, <code>Em</code>, <code>Re</code>, <code>Sc</code>, <code>Ie</code>, <code>Do</code>. По ним и будем пытаться поделить объекты на группы.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="cluster.html#cb1-1"></a><span class="kw">library</span>(tidyverse)</span></code></pre></div>
<pre><code>## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.0 ──</code></pre>
<pre><code>## ✓ ggplot2 3.3.2     ✓ purrr   0.3.4
## ✓ tibble  3.0.4     ✓ dplyr   1.0.2
## ✓ tidyr   1.1.2     ✓ stringr 1.4.0
## ✓ readr   1.4.0     ✓ forcats 0.5.0</code></pre>
<pre><code>## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="cluster.html#cb5-1"></a><span class="kw">theme_set</span>(<span class="kw">theme_bw</span>())</span>
<span id="cb5-2"><a href="cluster.html#cb5-2"></a>cpi &lt;-<span class="st"> </span>readxl<span class="op">::</span><span class="kw">read_xlsx</span>(<span class="st">&#39;/Users/antonangelgardt/hseuxlab-wlm2021/data/cpi.xlsx&#39;</span>)</span>
<span id="cb5-3"><a href="cluster.html#cb5-3"></a><span class="kw">str</span>(cpi)</span></code></pre></div>
<pre><code>## tibble [281 × 12] (S3: tbl_df/tbl/data.frame)
##  $ Fx      : num [1:281] 12 14 17 18 20 21 23 26 26 26 ...
##  $ Cs      : num [1:281] 75 21 37 81 85 28 14 4 45 48 ...
##  $ Sy      : num [1:281] 52 38 39 12 51 55 57 56 69 44 ...
##  $ Sp      : num [1:281] 21 24 22 25 29 23 33 16 25 30 ...
##  $ In      : num [1:281] 32 66 56 45 74 104 55 36 38 41 ...
##  $ Em      : num [1:281] 55 59 54 55 36 44 20 21 15 27 ...
##  $ Re      : num [1:281] 18 54 44 61 53 61 50 52 57 31 ...
##  $ Sc      : num [1:281] 57 29 71 44 56 36 34 55 25 41 ...
##  $ Ie      : num [1:281] 66 75 41 18 57 71 79 67 43 23 ...
##  $ Do      : num [1:281] 54 41 32 51 35 41 23 8 46 38 ...
##  $ group   : num [1:281] 0 0 0 0 0 0 0 0 0 0 ...
##  $ prodazhi: num [1:281] 245330 197980 228990 294930 245670 ...</code></pre>
<hr />
<p>Иерархическая кластеризация проводится в R одной командой <code>hclust()</code>. Она хочет в себя несколько аргументов:</p>
<ul>
<li>матрицу расстояний — она получается с помощью функции <code>dist()</code>, в которую необходимо передать датасет, содержащий переменные, по которым кластеризуются наблюдения
<ul>
<li>в функции <code>dist()</code> через аргумент <code>method</code> можно указать метрику расстояния между наблюдениями (<code>euclidean</code> — по умолчанию, <code>manhattan</code> и др.)</li>
</ul></li>
<li><code>method</code>, в который необходимо указать, как считается расстояние между крастерами (<code>single</code>, <code>complete</code>, <code>average</code> и др.)</li>
</ul>
<p>Результат работы функции необходимо записать в объект. Попробуем несколько разных методов:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="cluster.html#cb7-1"></a>d &lt;-<span class="st"> </span><span class="kw">dist</span>(cpi <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>group, <span class="op">-</span>prodazhi), <span class="dt">method =</span> <span class="st">&#39;manhattan&#39;</span>)</span>
<span id="cb7-2"><a href="cluster.html#cb7-2"></a>hc.complete &lt;-<span class="st"> </span><span class="kw">hclust</span>(d, <span class="dt">method =</span> <span class="st">&#39;complete&#39;</span>)</span>
<span id="cb7-3"><a href="cluster.html#cb7-3"></a>hc.average &lt;-<span class="st"> </span><span class="kw">hclust</span>(d, <span class="dt">method =</span> <span class="st">&#39;average&#39;</span>)</span>
<span id="cb7-4"><a href="cluster.html#cb7-4"></a>hc.single &lt;-<span class="st"> </span><span class="kw">hclust</span>(d, <span class="dt">method =</span> <span class="st">&#39;single&#39;</span>)</span></code></pre></div>
<p>Визуализируем результаты с помощью дендрограммы:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="cluster.html#cb8-1"></a><span class="kw">plot</span>(hc.complete)</span></code></pre></div>
<p><img src="wlm2021-book_files/figure-html/hc_complete-1.png" width="672" /></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="cluster.html#cb9-1"></a><span class="kw">plot</span>(hc.average)</span></code></pre></div>
<p><img src="wlm2021-book_files/figure-html/hc_average-1.png" width="672" /></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="cluster.html#cb10-1"></a><span class="kw">plot</span>(hc.single)</span></code></pre></div>
<p><img src="wlm2021-book_files/figure-html/hc_single-1.png" width="672" /></p>
<p>Как можно наблюдать, разные методы дают значительно различающиеся результаты. Возьмем для работы результат, полученный методом <code>complete</code>.</p>
<p>Мы говорили выше, что алгоритм иерархического кластерного анализа необходимо остановить на каком-то этапе, чтобы получить осмысленный результат. Изучив дендрограмму, можно понять, что явного скачка в расстояниях не происходит, однако наибольшие расстояния встречаются где-то на уровне шести кластеров — на этом варианте и остановимся.</p>
<p>Чтобы получить лейблы кластеров, необходимо «обрезать дерево» с помощью функции <code>cutree()</code>:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="cluster.html#cb11-1"></a><span class="kw">cutree</span>(hc.complete, <span class="dv">6</span>)</span></code></pre></div>
<pre><code>##   [1] 1 2 2 2 2 2 3 3 4 1 4 3 3 4 4 3 3 4 3 3 4 5 3 3 3 3 4 6 3 1 1 1 4 6 6 6 6
##  [38] 2 6 6 2 6 6 6 4 6 6 6 6 1 1 1 4 4 6 2 2 1 1 1 1 4 1 4 1 2 1 2 6 2 4 1 2 4
##  [75] 3 2 3 4 4 1 4 3 5 4 6 4 1 3 4 1 2 4 6 1 2 3 5 1 2 1 2 2 2 3 1 3 5 2 4 2 1
## [112] 5 4 3 5 5 2 4 4 1 4 3 4 5 5 4 2 4 4 3 5 5 4 1 4 1 1 1 4 3 1 2 4 1 4 4 4 1
## [149] 5 1 2 1 4 3 4 4 4 1 1 4 2 1 5 3 4 4 4 3 4 1 5 5 2 5 5 4 5 3 4 2 4 5 5 3 5
## [186] 1 1 4 5 4 4 3 3 3 3 5 4 3 5 1 1 5 3 4 5 5 3 5 5 5 3 5 5 5 3 3 5 5 5 6 3 2
## [223] 5 5 3 5 5 5 3 5 5 5 3 5 1 1 1 1 1 3 1 1 4 1 1 1 1 4 5 5 1 1 1 1 5 4 1 5 4
## [260] 5 5 5 1 5 5 5 2 5 5 5 2 2 5 2 2 5 5 5 2 1 5</code></pre>
<p>Можно также нарисовать график каменистой осыпи. Для этого придется воспользоваться кастомной функцией, которая пользуется одно из метрик качества кластеризации — <a href="cluster.html#cluster_cohesion">компактность кластеров</a>:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="cluster.html#cb13-1"></a>cstats.table &lt;-<span class="st"> </span><span class="cf">function</span>(dist, tree, k) {</span>
<span id="cb13-2"><a href="cluster.html#cb13-2"></a>  <span class="kw">library</span>(fpc)</span>
<span id="cb13-3"><a href="cluster.html#cb13-3"></a>  clust.assess &lt;-</span>
<span id="cb13-4"><a href="cluster.html#cb13-4"></a><span class="st">    </span><span class="kw">c</span>(</span>
<span id="cb13-5"><a href="cluster.html#cb13-5"></a>      <span class="st">&quot;cluster.number&quot;</span>,</span>
<span id="cb13-6"><a href="cluster.html#cb13-6"></a>      <span class="st">&quot;n&quot;</span>,</span>
<span id="cb13-7"><a href="cluster.html#cb13-7"></a>      <span class="st">&quot;within.cluster.ss&quot;</span>,</span>
<span id="cb13-8"><a href="cluster.html#cb13-8"></a>      <span class="st">&quot;average.within&quot;</span>,</span>
<span id="cb13-9"><a href="cluster.html#cb13-9"></a>      <span class="st">&quot;average.between&quot;</span>,</span>
<span id="cb13-10"><a href="cluster.html#cb13-10"></a>      <span class="st">&quot;wb.ratio&quot;</span>,</span>
<span id="cb13-11"><a href="cluster.html#cb13-11"></a>      <span class="st">&quot;dunn2&quot;</span>,</span>
<span id="cb13-12"><a href="cluster.html#cb13-12"></a>      <span class="st">&quot;avg.silwidth&quot;</span></span>
<span id="cb13-13"><a href="cluster.html#cb13-13"></a>    )</span>
<span id="cb13-14"><a href="cluster.html#cb13-14"></a>  clust.size &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;cluster.size&quot;</span>)</span>
<span id="cb13-15"><a href="cluster.html#cb13-15"></a>  stats.names &lt;-<span class="st"> </span><span class="kw">c</span>()</span>
<span id="cb13-16"><a href="cluster.html#cb13-16"></a>  row.clust &lt;-<span class="st"> </span><span class="kw">c</span>()</span>
<span id="cb13-17"><a href="cluster.html#cb13-17"></a>  output.stats &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">ncol =</span> k, <span class="dt">nrow =</span> <span class="kw">length</span>(clust.assess))</span>
<span id="cb13-18"><a href="cluster.html#cb13-18"></a>  cluster.sizes &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">ncol =</span> k, <span class="dt">nrow =</span> k)</span>
<span id="cb13-19"><a href="cluster.html#cb13-19"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span>k)) {</span>
<span id="cb13-20"><a href="cluster.html#cb13-20"></a>    row.clust[i] &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;Cluster-&quot;</span>, i, <span class="st">&quot; size&quot;</span>)</span>
<span id="cb13-21"><a href="cluster.html#cb13-21"></a>  }</span>
<span id="cb13-22"><a href="cluster.html#cb13-22"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">c</span>(<span class="dv">2</span><span class="op">:</span>k)) {</span>
<span id="cb13-23"><a href="cluster.html#cb13-23"></a>    stats.names[i] &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;Test&quot;</span>, i <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb13-24"><a href="cluster.html#cb13-24"></a>    </span>
<span id="cb13-25"><a href="cluster.html#cb13-25"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="kw">seq_along</span>(clust.assess)) {</span>
<span id="cb13-26"><a href="cluster.html#cb13-26"></a>      output.stats[j, i] &lt;-</span>
<span id="cb13-27"><a href="cluster.html#cb13-27"></a><span class="st">        </span><span class="kw">unlist</span>(<span class="kw">cluster.stats</span>(<span class="dt">d =</span> dist, <span class="dt">clustering =</span> <span class="kw">cutree</span>(tree, <span class="dt">k =</span> i))[clust.assess])[j]</span>
<span id="cb13-28"><a href="cluster.html#cb13-28"></a>      </span>
<span id="cb13-29"><a href="cluster.html#cb13-29"></a>    }</span>
<span id="cb13-30"><a href="cluster.html#cb13-30"></a>    </span>
<span id="cb13-31"><a href="cluster.html#cb13-31"></a>    <span class="cf">for</span> (d <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k) {</span>
<span id="cb13-32"><a href="cluster.html#cb13-32"></a>      cluster.sizes[d, i] &lt;-</span>
<span id="cb13-33"><a href="cluster.html#cb13-33"></a><span class="st">        </span><span class="kw">unlist</span>(<span class="kw">cluster.stats</span>(<span class="dt">d =</span> dist, <span class="dt">clustering =</span> <span class="kw">cutree</span>(tree, <span class="dt">k =</span> i))[clust.size])[d]</span>
<span id="cb13-34"><a href="cluster.html#cb13-34"></a>      <span class="kw">dim</span>(cluster.sizes[d, i]) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">length</span>(cluster.sizes[i]), <span class="dv">1</span>)</span>
<span id="cb13-35"><a href="cluster.html#cb13-35"></a>      cluster.sizes[d, i]</span>
<span id="cb13-36"><a href="cluster.html#cb13-36"></a>      </span>
<span id="cb13-37"><a href="cluster.html#cb13-37"></a>    }</span>
<span id="cb13-38"><a href="cluster.html#cb13-38"></a>  }</span>
<span id="cb13-39"><a href="cluster.html#cb13-39"></a>  output.stats.df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(output.stats)</span>
<span id="cb13-40"><a href="cluster.html#cb13-40"></a>  cluster.sizes &lt;-<span class="st"> </span><span class="kw">data.frame</span>(cluster.sizes)</span>
<span id="cb13-41"><a href="cluster.html#cb13-41"></a>  cluster.sizes[<span class="kw">is.na</span>(cluster.sizes)] &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb13-42"><a href="cluster.html#cb13-42"></a>  rows.all &lt;-<span class="st"> </span><span class="kw">c</span>(clust.assess, row.clust)</span>
<span id="cb13-43"><a href="cluster.html#cb13-43"></a>  <span class="co"># rownames(output.stats.df) &lt;- clust.assess</span></span>
<span id="cb13-44"><a href="cluster.html#cb13-44"></a>  output &lt;-<span class="st"> </span><span class="kw">rbind</span>(output.stats.df, cluster.sizes)[, <span class="dv">-1</span>]</span>
<span id="cb13-45"><a href="cluster.html#cb13-45"></a>  <span class="kw">colnames</span>(output) &lt;-<span class="st"> </span>stats.names[<span class="dv">2</span><span class="op">:</span>k]</span>
<span id="cb13-46"><a href="cluster.html#cb13-46"></a>  <span class="kw">rownames</span>(output) &lt;-<span class="st"> </span>rows.all</span>
<span id="cb13-47"><a href="cluster.html#cb13-47"></a>  is.num &lt;-<span class="st"> </span><span class="kw">sapply</span>(output, is.numeric)</span>
<span id="cb13-48"><a href="cluster.html#cb13-48"></a>  output[is.num] &lt;-<span class="st"> </span><span class="kw">lapply</span>(output[is.num], round, <span class="dv">2</span>)</span>
<span id="cb13-49"><a href="cluster.html#cb13-49"></a>  output</span>
<span id="cb13-50"><a href="cluster.html#cb13-50"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="cluster.html#cb14-1"></a><span class="co"># вычисляем данные для графика</span></span>
<span id="cb14-2"><a href="cluster.html#cb14-2"></a>clust.stats &lt;-</span>
<span id="cb14-3"><a href="cluster.html#cb14-3"></a><span class="st">  </span><span class="kw">cstats.table</span>(d, hc.complete, <span class="dv">15</span>)</span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="cluster.html#cb15-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="kw">data.frame</span>(<span class="kw">t</span>(clust.stats)),</span>
<span id="cb15-2"><a href="cluster.html#cb15-2"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> cluster.number, <span class="dt">y =</span> within.cluster.ss)) <span class="op">+</span></span>
<span id="cb15-3"><a href="cluster.html#cb15-3"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb15-4"><a href="cluster.html#cb15-4"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb15-5"><a href="cluster.html#cb15-5"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Divisive clustering&quot;</span>) <span class="op">+</span></span>
<span id="cb15-6"><a href="cluster.html#cb15-6"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Num. of clusters&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Within clusters sum of squares (WSS)&quot;</span>) <span class="op">+</span></span>
<span id="cb15-7"><a href="cluster.html#cb15-7"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>))</span></code></pre></div>
<p><img src="wlm2021-book_files/figure-html/elbow_hc_complete-1.png" width="672" /></p>
<p>А вот по этому графику кластеров как будто 8… Хотя явного излома всё ещё не наблюдается…</p>
</div>
<div id="путь-к-интерпретации-результатов-кластеризации" class="section level4">
<h4><span class="header-section-number">25.4.5.2</span> Путь к интерпретации результатов кластеризации</h4>
<p>Едва ли вам кто-то расскажет, как однозначно и правильно интерпретировать результаты кластерного анализа — здесь у нас некоторый существенный простор для творчества. Один из вариантов — опереться на данные, которые у нас уже умеются. Например, можно посмотреть взаимосвязи кластеров с переменными датасета. Вот несколько возможных графиков:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="cluster.html#cb16-1"></a>cpi <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb16-2"><a href="cluster.html#cb16-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(Sp, Em, <span class="dt">color =</span> <span class="kw">as_factor</span>(<span class="kw">cutree</span>(hc.complete, <span class="dv">6</span>)))) <span class="op">+</span></span>
<span id="cb16-3"><a href="cluster.html#cb16-3"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb16-4"><a href="cluster.html#cb16-4"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&#39;bottom&#39;</span>)</span></code></pre></div>
<p><img src="wlm2021-book_files/figure-html/hc1-1.png" width="672" /></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="cluster.html#cb17-1"></a>cpi <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb17-2"><a href="cluster.html#cb17-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(Fx, Re, <span class="dt">color =</span> <span class="kw">as_factor</span>(<span class="kw">cutree</span>(hc.complete, <span class="dv">6</span>)))) <span class="op">+</span></span>
<span id="cb17-3"><a href="cluster.html#cb17-3"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb17-4"><a href="cluster.html#cb17-4"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&#39;bottom&#39;</span>)</span></code></pre></div>
<p><img src="wlm2021-book_files/figure-html/hc2-1.png" width="672" /></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="cluster.html#cb18-1"></a>cpi <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-2"><a href="cluster.html#cb18-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(Sy, Cs, <span class="dt">color =</span> <span class="kw">as_factor</span>(<span class="kw">cutree</span>(hc.complete, <span class="dv">6</span>)))) <span class="op">+</span></span>
<span id="cb18-3"><a href="cluster.html#cb18-3"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb18-4"><a href="cluster.html#cb18-4"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&#39;bottom&#39;</span>)</span></code></pre></div>
<p><img src="wlm2021-book_files/figure-html/hc3-1.png" width="672" /></p>
<p>На первых двух кластерах закономерностей на обнаруживается — наблюдения всех кластеров распределены по плоскости более-менее случайно, а вот на третьем графике уже видна некоторая сегрегация, поэтому как первый шаг в интерпретации результатов можно взять содержание этих переменных. Далее можно идти по связям между переменными или, возможно, добавить неучтенную в кластеризации информацию, например по суммам продаж (<code>prodazhi</code>) и группе (<code>group</code>):</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="cluster.html#cb19-1"></a>cpi <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb19-2"><a href="cluster.html#cb19-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(prodazhi, <span class="kw">as_factor</span>(<span class="kw">cutree</span>(hc.complete, <span class="dv">6</span>)),</span>
<span id="cb19-3"><a href="cluster.html#cb19-3"></a>             <span class="dt">color =</span> <span class="kw">as_factor</span>(group))) <span class="op">+</span></span>
<span id="cb19-4"><a href="cluster.html#cb19-4"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb19-5"><a href="cluster.html#cb19-5"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&#39;bottom&#39;</span>)</span></code></pre></div>
<p><img src="wlm2021-book_files/figure-html/hc4-1.png" width="672" /></p>
</div>
</div>
<div id="чем-плох-иерархический-кластерный-анализ" class="section level3">
<h3><span class="header-section-number">25.4.6</span> Чем плох иерархический кластерный анализ?</h3>
<p>У иерархического кластерного анализа практически нет недостатков, за исключением одного очень важного технического — он требует, чтобы в оперативной памяти хранилась матрица попарных расстояний. Если у нас порядка ста объектов, то проблем никаких, а вот если объектов 100 000, уже возникают трудности. Невозможность работать с очень большими датасетами — основная проблема этого вида кластерного анализа.</p>
</div>
</div>
<div id="k-means-метод-k-средних" class="section level2">
<h2><span class="header-section-number">25.5</span> k-means (метод k-средних)</h2>
<div id="алгоритм-метода-k-средних" class="section level3">
<h3><span class="header-section-number">25.5.1</span> Алгоритм метода k-средних</h3>
<p>Процедура кластерного анализа этим методом значительно отличается.</p>
<ol style="list-style-type: decimal">
<li>Заранее определяется число кластеров <span class="math inline">\(k\)</span>. Хотя вообще-то это невозможно, однако уже найдены способы, чтобы обойти это ограничение.</li>
<li>Для анализа выбирается <span class="math inline">\(k\)</span> точек — центры кластеров.</li>
<li>Объект приписывается к тому кластеру, чей центр ближайший.</li>
<li>Центр кластера — <em>центр тяжести</em> объектов кластера.</li>
</ol>
<ul>
<li>центр тяжести множества точек с координатами <span class="math inline">\((x_{i1}, x_{i2}, \dots, x_{ip})\)</span> — это точка с координатами <span class="math inline">\((\bar x_{1}, \bar x_{2}, \dots, \bar x_{p})\)</span>.</li>
</ul>
<ol start="5" style="list-style-type: decimal">
<li>Повторяем поочерёдно пункты 3 и 4 до тех пор, пока центры кластеров не перестанут двигаться.</li>
</ol>
</div>
<div id="ограничения-k-means" class="section level3">
<h3><span class="header-section-number">25.5.2</span> Ограничения k-means</h3>
<ul>
<li>Необходимо заранее определить число кластеров</li>
<li>Используется только евклидово растояние
<ul>
<li>хотя этот недостаток исправляется в других модификациях метода</li>
</ul></li>
<li>Результат зависит от начальных центров кластеров</li>
</ul>
</div>
<div id="начальное-положение-кластеров" class="section level3">
<h3><span class="header-section-number">25.5.3</span> Начальное положение кластеров</h3>
<p>Если «бросать» центроиды совсем случайно, то это может привести к тому, что некоторые из них буду, например, слишком далеко от скопления точек — в результате работы алгоритма образуются пустые кластеры. Это нехорошо, поэтому есть два наиболее популярных подхода.</p>
<p><em>1. Forgy</em>
- Случайным образом выбираются <span class="math inline">\(k\)</span> наблюдений. Они объявляются начальными центрами кластеров.</p>
<p><em>2. Случайное разбиение (Random Partition)</em>
- Каждое наблюдение случайным образом приписывается к одному из кластеров. Находятся центры тяжести кластеров. Они объявляются начальными центрами кластеров.</p>
</div>
<div id="k-means-в-r" class="section level3">
<h3><span class="header-section-number">25.5.4</span> k-means в R</h3>
<p>Кластеризация методом k-means выполяется функцией — внезапно — <code>kmeans()</code>, которая просит в себя несколько аргументов:</p>
<ul>
<li>матрицу значений переменных, по которым проводится кластеризация;</li>
<li><code>centers</code> — число кластеров;</li>
<li><code>iter.max</code> — максимально число итераций; может быть увеличено, чтобы алгоритм сошёлся;</li>
<li><code>nstart</code> — количество кластерных анализов, которое проводится с целью минимизации влияния начального положения центров кластеров.</li>
</ul>
<p>Попробуем провести кластеризацию этим методом. Сколько взять кластеров? Пусть будет для начала самый простой вариант — два кластера.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="cluster.html#cb20-1"></a>km2 &lt;-<span class="st"> </span><span class="kw">kmeans</span>(cpi[<span class="op">-</span>(<span class="dv">11</span><span class="op">:</span><span class="dv">12</span>)], <span class="dt">centers =</span> <span class="dv">2</span>)</span></code></pre></div>
<p>Посмотрим, что получилось:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="cluster.html#cb21-1"></a><span class="kw">str</span>(km2)</span></code></pre></div>
<pre><code>## List of 9
##  $ cluster     : int [1:281] 2 1 2 2 2 2 1 1 2 2 ...
##  $ centers     : num [1:2, 1:10] 51.4 45.8 23.2 52 52.4 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : chr [1:2] &quot;1&quot; &quot;2&quot;
##   .. ..$ : chr [1:10] &quot;Fx&quot; &quot;Cs&quot; &quot;Sy&quot; &quot;Sp&quot; ...
##  $ totss       : num 899264
##  $ withinss    : num [1:2] 384762 386122
##  $ tot.withinss: num 770883
##  $ betweenss   : num 128380
##  $ size        : int [1:2] 146 135
##  $ iter        : int 1
##  $ ifault      : int 0
##  - attr(*, &quot;class&quot;)= chr &quot;kmeans&quot;</code></pre>
<p>Получившийся объект содержит много информации:
* <code>clusters</code> — лейблы кластеров
* <code>centers</code> — координаты центров кластеров (средние значения переменных по кластеру)
* <code>withinss</code> — сумма квадратов расстояний от объектов кластера до центра кластера
* <code>tot.withinss</code> — сумма элементов <code>withinss</code>
* <code>totss</code> — сумма квадратов расстояний от объектов кластера до центра кластера для случая одного кластера
* <code>betweenss</code> = <code>totss</code> − <code>tot.withinss</code>
* <code>size</code> — размеры кластеров (количество объектов)</p>
<p>Окей, мы разобрались, как работает функция, значит можем построить график «каменистая осыпь», чтобы определить «правильное» число кластеров.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="cluster.html#cb23-1"></a>wss &lt;-<span class="st"> </span><span class="cf">function</span>(x, k) {</span>
<span id="cb23-2"><a href="cluster.html#cb23-2"></a>  wss &lt;-<span class="st"> </span><span class="kw">numeric</span>(k)</span>
<span id="cb23-3"><a href="cluster.html#cb23-3"></a>  <span class="kw">names</span>(wss) &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span>k</span>
<span id="cb23-4"><a href="cluster.html#cb23-4"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>k) {</span>
<span id="cb23-5"><a href="cluster.html#cb23-5"></a>    wss[i] &lt;-<span class="st"> </span><span class="kw">kmeans</span>(x, i)<span class="op">$</span>tot.withinss</span>
<span id="cb23-6"><a href="cluster.html#cb23-6"></a>  }</span>
<span id="cb23-7"><a href="cluster.html#cb23-7"></a>  <span class="kw">return</span>(wss[<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb23-8"><a href="cluster.html#cb23-8"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="cluster.html#cb24-1"></a>km_wss &lt;-<span class="st"> </span><span class="kw">wss</span>(cpi[<span class="op">-</span>(<span class="dv">11</span><span class="op">:</span><span class="dv">12</span>)], <span class="dv">15</span>)</span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="cluster.html#cb25-1"></a><span class="kw">ggplot</span>(<span class="ot">NULL</span>, <span class="kw">aes</span>(<span class="dv">2</span><span class="op">:</span><span class="dv">15</span>, km_wss)) <span class="op">+</span></span>
<span id="cb25-2"><a href="cluster.html#cb25-2"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb25-3"><a href="cluster.html#cb25-3"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb25-4"><a href="cluster.html#cb25-4"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&#39;Number of Clusters&#39;</span>,</span>
<span id="cb25-5"><a href="cluster.html#cb25-5"></a>       <span class="dt">y =</span> <span class="st">&#39;Within group sum of squares&#39;</span>)</span></code></pre></div>
<p><img src="wlm2021-book_files/figure-html/km_elbow-1.png" width="672" /></p>
<p>График в этот раз помог не сильно — явного падения нет. Вывод, который здесь напрашивается — кластеризации нет.</p>
</div>
</div>
<div id="метрики-качества-кластеризации" class="section level2">
<h2><span class="header-section-number">25.6</span> Метрики качества кластеризации</h2>
<p>Вообще оценка качества кластеризации — задача крайне сложная и в строгом математическом смысле <a href="https://neerc.ifmo.ru/wiki/index.php?title=Кластеризация#.D0.A2.D0.B5.D0.BE.D1.80.D0.B5.D0.BC.D0.B0_.D0.BD.D0.B5.D0.B2.D0.BE.D0.B7.D0.BC.D0.BE.D0.B6.D0.BD.D0.BE.D1.81.D1.82.D0.B8_.D0.9A.D0.BB.D0.B5.D0.B9.D0.BD.D0.B1.D0.B5.D1.80.D0.B3.D0.B0">невыполнимая</a>. Однако <a href="https://neerc.ifmo.ru/wiki/index.php?title=Оценка_качества_в_задаче_кластеризации">всякие разные метрики</a>, которые позволяют приблизиться к такой оценки всё же были придуманы. Они делятся на <em>внешние</em> и <em>внутренние</em>. Мы рассмотрим наиболее простые.</p>
<div id="внешние-метрики" class="section level3">
<h3><span class="header-section-number">25.6.1</span> Внешние метрики</h3>
<p>Внешние метрики используют дополнитльную информацию о кластеризуемом множестве объектов. Например, распределение объектов по кластерам. То есть, чтобы посчитать метрику, мы должны знать, как данные распределяются на кластеры перед тем, как будем проводить кластерный анализ.</p>
<p>Но зачем нам проводить кластерный анализ, если нам уже известны кластеры? Ведь это тогда не кластеры, а классы! И мы можем строить классификатор. Так-то оно, конечно, так — и нам, аналитикам, эти метрики не очень интересны. Для разработчиков алгоритмов же они могут быть очень полезны.</p>
<p>Мы не будем на них останавливаться. Если хочется почитать и вникнуть, то <a href="https://neerc.ifmo.ru/wiki/index.php?title=Оценка_качества_в_задаче_кластеризации#.D0.92.D0.BD.D0.B5.D1.88.D0.BD.D0.B8.D0.B5_.D0.BC.D0.B5.D1.80.D1.8B_.D0.BE.D1.86.D0.B5.D0.BD.D0.BA.D0.B8_.D0.BA.D0.B0.D1.87.D0.B5.D1.81.D1.82.D0.B2.D0.B0">вот</a>.</p>
</div>
<div id="внутренние-метрики" class="section level3">
<h3><span class="header-section-number">25.6.2</span> Внутренние метрики</h3>
<p>Эти метрики не используют внешний информации о датасете, а опираются только на результаты кластеризации.</p>
<div id="cluster_cohesion" class="section level4">
<h4><span class="header-section-number">25.6.2.1</span> Компактность кластеров (cluster cohesion)</h4>
<p>Помним, что мы хотим собрать похожие наблюдения вместе, а похожие — это те, которые располагаются близко друг к другу. Соответственно, разделение на кластеры тем лучше, чем ближе объекты кластера находятся к его центру. Поэтому необхожимо минимизировать внутрикластерное расстояние:</p>
<p><span class="math display">\[
WSS = \sum_{j=1}^k \sum_{i=1}^{|C_j|} (x_{ij} - \bar x_j)^2,
\]</span>
где <span class="math inline">\(k\)</span> — число кластеров, <span class="math inline">\(|C_j|\)</span> — количество объектов в данном кластере.</p>
<p>Это самая популярная метрика качества кластеризации.</p>
</div>
<div id="отделимость-кластеров-cluster-separation" class="section level4">
<h4><span class="header-section-number">25.6.2.2</span> Отделимость кластеров (cluster separation)</h4>
<p>Помним, что мы хотим собрать в разные кластеры непохожие друг на друга наблюдения — это те, которые располагаются далеко друг от друга. Соответственно, чем дальше находятся друг от друга центры кластеров, тем лучше. Поэтому необхожимо максимизировать межкластерное расстояние:</p>
<p><span class="math display">\[
BSS = n \cdot \sum_{j=1}^k (\bar x_j - \bar x)^2,
\]</span>
где <span class="math inline">\(k\)</span> — число кластеров.</p>
<p>О других внутренних метриках кластеризации можно посмотреть <a href="https://neerc.ifmo.ru/wiki/index.php?title=Оценка_качества_в_задаче_кластеризации#.D0.92.D0.BD.D1.83.D1.82.D1.80.D0.B5.D0.BD.D0.BD.D0.B8.D0.B5_.D0.BC.D0.B5.D1.80.D1.8B_.D0.BE.D1.86.D0.B5.D0.BD.D0.BA.D0.B8_.D0.BA.D0.B0.D1.87.D0.B5.D1.81.D1.82.D0.B2.D0.B0">тут</a>.</p>

</div>
</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>Хотя математически эта метрика не является расстоянием, так как может нарушаться неравенство треугольника. Однако для задач кластерного анализа это не имеет большого значения.<a href="cluster.html#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>Заметьте, что в <em>количестве кварталов</em> все расстояния равны.<a href="cluster.html#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>Заметьте, что длина всех траекторий также будет одинакова.<a href="cluster.html#fnref3" class="footnote-back">↩︎</a></p></li>
<li id="fn4"><p>Вадим Аббакумов, лекция в Computer Science Center<a href="cluster.html#fnref4" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="glmm.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="pca.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["wlm2021-book.pdf", "wlm2021-book.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>

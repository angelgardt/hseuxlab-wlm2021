<<<<<<< .merge_file_ZNUD66
# Функции

## Открытый исходный код
=======
# Функции {#functions}

Безусловно, в R дикое множество различных функций. Но иногда нам и их не хватает. И возникает потребность написать свои. Сделать это, на самом деле, вовсе не так сложно, как может показаться. Разберёмся по порядку.

Для начала нам нужно осознать, что функция --- это объект (такой же объект, как и вектор, матрица или список). И этот объект создается с помощью некоторой функции и имеет имя, которое возникает в результате присваивания. Пока вроде всё знакомо, не так ли?

Функция, которая делает функции называется `function()` (внезапно!). Таким образом выглядит её конструкция:

```{r, eval=FALSE}
my_func <- function() {
  
}
```

`my_func` --- название нашей новой функции, `function()` --- собственно функция, которая требует на вход аргументы нашей будушей функции, а в фигурных скобках мы будем описывать, как наша функция работает.

Теперь нам нужно вспомнить, что функция должна что-то принимать на вход и что-то возвращать в результате работы. На самом деле можно начать с ещё более простого варианта --- когда функция даже ничего не принимает на вход, а просто что-то возвращает после выполнения:

```{r}
my_hello <- function() {
  return("Hello, world!")
}
my_hello()
```

Функция `return()` определяет, что будет возвращать наша функция как итог работы. В данном случае она возвращает нам строку `"Hello, world!"`. Мы можем немного изменить нашу функцию, чтобы она приветствовала не только мир, но и того, кто к ней обратился:

```{r}
my_hello <- function(name) {
  phrase <- paste0("Hello, ", name, "!")
  return(phrase)
}
my_hello("Антон")
```

Теперь функция приветствует меня и не только --- надо всего лишь указать имя того, кому надо сказать «привет».

А что будет, если не указать ничего?

```{r, error=TRUE}
my_hello()
```

Функция нам сообщает, что аргумент `name` является обязательным. Что ж, если мы не хотим такой ошибки, то можем задать *значение по умолчанию*:

```{r}
my_hello <- function(name = "world") {
  phrase <- paste0("Hello, ", name, "!")
  return(phrase)
}
my_hello("Антон")
my_hello()
```

Теперь функция приветствует того, кто указан в её аргументе, а если не указано никого --- приветствует весь мир! Pacific function.

Мы создавали промежуточную переменную `phrase`, в которую записывали результат работы функции `paste0()`, которая занимается соединением строк. Но у нас достаточно простая функция, поэтому нет необходимости занимать лишние строки. Можно упростить её следующим образом:

```{r}
my_hello <- function(name = "world") {
  return(paste0("Hello, ", name, "!"))
}
my_hello()
```

Но можно пойти и ещё дальше!

```{r}
my_hello <- function(name = "world") {
  paste0("Hello, ", name, "!")
}
my_hello()
```

Даже `return()` не обязателен! Функция просто возвращает результат последней выплоненной команды. Красота!


Общий принцип создания и работы функции понятен. Попробуем сделать что-то более интересное. Например, применим какие-то логические конструкции.

Напишем простую функцию, которая будет определять, чётное число или нечётное. Чётность определяется остатком от деления на два: если остаток равен нулю, то число чётное, иначе --- нечётное.

> Конечно, в R как и в любом другом языке программирования есть if else statement и for and while loops. Но зачем они нам, если есть `ifelse()` и векторизация?

Чтобы написать такую функцию, нам надо понять, как работает функция `ifelse()`. Работает она достаточно просто: она требует на вход три аргумента --- условие, которое необходимо проверить, значение, которое необходимо вернуть, если условие выполнено, и значение, которое необходимо вернуть, если условие не выполнено. Например,

```{r}
ifelse(2 > 8, "верно", "неверно")
ifelse(10 != 2, "верно", "неверно")
```

Как мы можем использовать эту функцию для написания кастомной? Вот так:ъ

```{r}
odd_even <- function(x) {
  ifelse(x %% 2 == 0, 'even', 'odd')
}
odd_even(2)
odd_even(3)
```

Но можно написать ещё короче! Всего в одну строку!

```{r}
odd_even <- function(x) ifelse(x %% 2 == 0, 'even', 'odd')
odd_even(5)
odd_even(8)
```

<img class="taskimg" src="img/code.png">
<div class="task">
Посчитайте пингвинов! Напишите функцию, которая выводит корректную форму слова «пингвин» в ответ на ввод некоторого числа.

```{r, echo=FALSE}
penguin <- function(n) {
  paste0(
    n,
    ' пингвин',
    ifelse(
      n %% 10 == 0 |
        4 < n %% 10 & n %% 10 < 10 | 10 < n %% 100 & n %% 100 < 15,
      'ов',
      ifelse(1 < n %% 10 & n %% 10 < 5, 'а', '')
    )
  )
}
```
```{r}
penguin(1)
penguin(3)
penguin(10)
```
</div>



## Открытый исходный код

В R можно не только написать свои функции, но и посмотреть, как написаны другие, то есть увидеть исходный код. Для этого надо написать название функции и выполнить её как команду (без скобок):

```{r}
sd # стандартное отклонение --- корень из дисперсии
```

```{r}
lm # функция для построения линейной регрессионной модели
```
>>>>>>> .merge_file_I2StZO
